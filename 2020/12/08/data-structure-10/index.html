<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"8.0.0-rc.5","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false};
  </script>

  <meta name="description" content="本篇介绍了二叉排序树，平衡二叉树，2-3 树(最简单的 B 树)和 B 树。">
<meta property="og:type" content="article">
<meta property="og:title" content="数据结构和算法(壹零)：二叉排序树·平衡二叉树·B树">
<meta property="og:url" content="http://yoursite.com/2020/12/08/data-structure-10/index.html">
<meta property="og:site_name" content="Cross Code">
<meta property="og:description" content="本篇介绍了二叉排序树，平衡二叉树，2-3 树(最简单的 B 树)和 B 树。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2501.jpg">
<meta property="og:image" content="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2502.jpg">
<meta property="og:image" content="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2503.jpg">
<meta property="og:image" content="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2504.jpg">
<meta property="og:image" content="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2505.jpg">
<meta property="og:image" content="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2506.jpg">
<meta property="og:image" content="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2507.jpg">
<meta property="article:published_time" content="2020-12-08T05:42:05.000Z">
<meta property="article:modified_time" content="2021-05-30T15:20:33.596Z">
<meta property="article:author" content="Minwei Chen">
<meta property="article:tag" content="数据结构">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2501.jpg">

<link rel="canonical" href="http://yoursite.com/2020/12/08/data-structure-10/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>数据结构和算法(壹零)：二叉排序树·平衡二叉树·B树 | Cross Code</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

  <script type="text/javascript" src="/js/my_js/clicklove.js"></script>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Cross Code</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">There is only one heroism in the world: to see the world as it is and to love it</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80-%E4%BA%8C%E5%8F%89%E6%8E%92%E5%BA%8F%E6%A0%91"><span class="nav-text">一. 二叉排序树</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-%E7%AE%80%E4%BB%8B"><span class="nav-text">(A) 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E6%93%8D%E4%BD%9C"><span class="nav-text">(B) 操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E6%8F%92%E5%85%A5"><span class="nav-text">(a) 插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E5%88%A0%E9%99%A4"><span class="nav-text">(b) 删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-%E6%9F%A5%E8%AF%A2"><span class="nav-text">(c) 查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#d-%E9%81%8D%E5%8E%86"><span class="nav-text">(d) 遍历</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#C-%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">(C) 代码实现</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C-%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91"><span class="nav-text">二. 平衡二叉树</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-%E7%AE%80%E4%BB%8B-1"><span class="nav-text">(A) 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E6%97%8B%E8%BD%AC%E6%93%8D%E4%BD%9C"><span class="nav-text">(B) 旋转操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E6%A6%82%E8%BF%B0"><span class="nav-text">(a) 概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E4%BB%A3%E7%A0%81"><span class="nav-text">(b) 代码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%B7%A6%E5%8D%95%E6%97%8B%E8%BD%AC"><span class="nav-text">(1) 左单旋转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%8F%B3%E5%8D%95%E6%97%8B%E8%BD%AC"><span class="nav-text">(2) 右单旋转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%8F%B3%E5%B7%A6%E5%8F%8C%E6%97%8B%E8%BD%AC"><span class="nav-text">(3) 右左双旋转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E5%B7%A6%E5%8F%B3%E5%8F%8C%E6%97%8B%E8%BD%AC"><span class="nav-text">(4) 左右双旋转</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#C-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="nav-text">(C) 增删改查</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E6%B1%82%E5%B9%B3%E8%A1%A1%E5%9B%A0%E5%AD%90"><span class="nav-text">(a) 求平衡因子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E6%8F%92%E5%85%A5"><span class="nav-text">(b) 插入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%88%86%E6%9E%90"><span class="nav-text">(1) 分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%8F%92%E5%85%A5%E8%BF%90%E7%AE%97%E7%BB%B4%E6%8A%A4%E5%B9%B3%E8%A1%A1%E4%BB%A3%E7%A0%81"><span class="nav-text">(2) 插入运算维护平衡代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%8F%92%E5%85%A5%E8%BF%90%E7%AE%97%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">(3) 插入运算的实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-%E5%88%A0%E9%99%A4"><span class="nav-text">(c) 删除</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C%E7%BB%B4%E6%8A%A4%E5%B9%B3%E8%A1%A1%E4%BB%A3%E7%A0%81"><span class="nav-text">(1) 删除操作维护平衡代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">(2) 删除操作的实现</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#d-%E5%85%B6%E4%BB%96%E6%93%8D%E4%BD%9C%E7%9A%84%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">(d) 其他操作的代码实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#D-%E5%B9%B3%E8%A1%A1%E4%BA%8C%E5%8F%89%E6%A0%91%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-text">(D) 平衡二叉树代码示例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89-2-3-%E6%A0%91"><span class="nav-text">三. 2-3 树</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-%E7%AE%80%E4%BB%8B-2"><span class="nav-text">(A) 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E4%BB%A3%E7%A0%81%E6%80%9D%E8%B7%AF"><span class="nav-text">(B) 代码思路</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B-B-%E6%A0%91"><span class="nav-text">四. B 树</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-%E5%AE%9A%E4%B9%89"><span class="nav-text">(A) 定义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E4%BB%A3%E7%A0%81"><span class="nav-text">(B) 代码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="nav-text">(a) 头文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-B-%E6%A0%91%E5%85%B7%E4%BD%93%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0"><span class="nav-text">(b) B 树具体接口实现</span></a></li></ol></li></ol></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Minwei Chen"
      src="/images/tuoqi.jpg">
  <p class="site-author-name" itemprop="name">Minwei Chen</p>
  <div class="site-description" itemprop="description">Cross the surface, get to the reality. Welcome to Cross Code!</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">41</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/AltriaChen" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AltriaChen" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:mwchennju@foxmail.com" title="E-Mail → mailto:mwchennju@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/08/data-structure-10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/tuoqi.jpg">
      <meta itemprop="name" content="Minwei Chen">
      <meta itemprop="description" content="Cross the surface, get to the reality. Welcome to Cross Code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cross Code">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          数据结构和算法(壹零)：二叉排序树·平衡二叉树·B树
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-12-08 13:42:05" itemprop="dateCreated datePublished" datetime="2020-12-08T13:42:05+08:00">2020-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-30 23:20:33" itemprop="dateModified" datetime="2021-05-30T23:20:33+08:00">2021-05-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>本篇介绍了二叉排序树，平衡二叉树，2-3 树(最简单的 B 树)和 B 树。</p>
<a id="more"></a>

<h1 id="一-二叉排序树"><a href="#一-二叉排序树" class="headerlink" title="一. 二叉排序树"></a>一. 二叉排序树</h1><h2 id="A-简介"><a href="#A-简介" class="headerlink" title="(A) 简介"></a>(A) 简介</h2><p>二叉排序树 (Binary Sort Tree，BST)，又称为二叉查找树。它或者是一棵空树，或者是具有下列性质的二叉树：<br>– 若它的左子树不为空，则左子树上所有结点的值均小于它的根结构的值；<br>– 若它的右子树不为空，则右子树上所有结点的值均大于它的根结构的值；<br>– 它的左、右子树也分别为二叉排序树(递归)。</p>
<h2 id="B-操作"><a href="#B-操作" class="headerlink" title="(B) 操作"></a>(B) 操作</h2><h3 id="a-插入"><a href="#a-插入" class="headerlink" title="(a) 插入"></a>(a) 插入</h3><ol>
<li>首先判断当前要插入的值是否已经存在于二叉排序树中。如果已经存在，则直接返回；如果不存在，则转步骤 2；</li>
<li>当前要插入的值不存在，则按如下规则插入：小于根结点插入左子树，大于根结点插入右子树。注意，插入的新结点一定是叶子结点。</li>
</ol>
<h3 id="b-删除"><a href="#b-删除" class="headerlink" title="(b) 删除"></a>(b) 删除</h3><ol>
<li>首先判断要删除的结点是否存在。如果已经不存在，则直接返回；如果存在，则获取给定值结点的位置，根据不同的情况进行删除与调整，转步骤 2；</li>
<li>如果待删结点只有左子树(或只有右子树)，则直接将待删结点的左子树(或右子树)放在待删结点的位置，并释放待删结点的内存。否则转步骤 3；</li>
<li>如果待删结点既有左子树又有右子树，则在待删结点的左子树中找到值最大的那个结点，将其放在待删结点的位置，释放待删结点的内存。</li>
</ol>
<h3 id="c-查询"><a href="#c-查询" class="headerlink" title="(c) 查询"></a>(c) 查询</h3><p>查询的过程为，首先将关键字和根结点的关键字比较，如果相等则返回结点的位置(指针)；否则，如果小于根结点的关键字，则去左子树中继续查找；如果大于根结点的关键字，则去右子树中查找；如果找到叶子结点也没找到，则返回 NULL。</p>
<h3 id="d-遍历"><a href="#d-遍历" class="headerlink" title="(d) 遍历"></a>(d) 遍历</h3><p>由二叉排序树的定义可知，其排布顺序与二叉树的中序遍历顺序一致，故可采取中序遍历的方式。</p>
<h2 id="C-代码实现"><a href="#C-代码实现" class="headerlink" title="(C) 代码实现"></a>(C) 代码实现</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="comment">//二叉排序树 </span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">BSTNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">    BSTNode *lchild;  <span class="comment">//左孩子</span></span><br><span class="line">    BSTNode *rchild;  <span class="comment">//右孩子</span></span><br><span class="line">&#125;BSTNode, *BSTree;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Search</span><span class="params">(BSTree bst, <span class="keyword">int</span> key, BSTree f, BSTree *p)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InOderTraverse</span><span class="params">(BSTree bst)</span>   <span class="comment">//中序递归遍历二叉树 </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> != bst)</span><br><span class="line">    &#123;</span><br><span class="line">        InOderTraverse(bst-&gt;lchild);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, bst-&gt;data);</span><br><span class="line">        InOderTraverse(bst-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">static</span> BSTNode* <span class="title">BuyNode</span><span class="params">(<span class="keyword">int</span> data)</span>   <span class="comment">//生成一个结点并进行初始化 </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BSTNode *pTmp = (BSTNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(BSTNode));</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == pTmp)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    pTmp-&gt;data = data;</span><br><span class="line">    pTmp-&gt;lchild = <span class="literal">NULL</span>;</span><br><span class="line">    pTmp-&gt;rchild = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> pTmp;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Insert</span><span class="params">(BSTree *bst, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == *bst)  <span class="comment">//空树</span></span><br><span class="line">    &#123;</span><br><span class="line">        *bst = BuyNode(key);   <span class="comment">//插入根结点 </span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    BSTNode *p;</span><br><span class="line">    <span class="comment">//先在二叉排序树中查找要插入的值是否已经存在 </span></span><br><span class="line">    <span class="keyword">if</span> (!Search(*bst, key, <span class="literal">NULL</span>, &amp;p))  <span class="comment">//如果查找失败,则插入;此时p指向遍历的最后一个结点 </span></span><br><span class="line">    &#123;</span><br><span class="line">        BSTNode *pNew = BuyNode(key);</span><br><span class="line">        <span class="keyword">if</span> (key &lt; p-&gt;data)  <span class="comment">//将s作为p的左孩子 </span></span><br><span class="line">        &#123;</span><br><span class="line">            p-&gt;lchild = pNew;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (key &gt; p-&gt;data)  <span class="comment">//将s作为p的右孩子 </span></span><br><span class="line">        &#123;</span><br><span class="line">            p-&gt;rchild = pNew;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;  <span class="comment">//插入成功 </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\nThe node(%d) already exists.\n&quot;</span>, key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">删除分三种情况:</span></span><br><span class="line"><span class="comment">(1)被删除的结点无孩子,说明该结点是叶子结点,直接删 </span></span><br><span class="line"><span class="comment">(2)被删除的结点只有左孩子或者右孩子,直接删,并将其左孩子或者右孩子放在被删结点的位置 </span></span><br><span class="line"><span class="comment">(3)被删除的结点既有左孩子又有右孩子 </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function">BSTNode* <span class="title">FindParent</span><span class="params">(BSTree bst, BSTNode *child)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == bst)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> (bst-&gt;lchild == child || bst-&gt;rchild == child)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> bst;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="literal">NULL</span> != bst-&gt;lchild)</span><br><span class="line">    &#123;</span><br><span class="line">        FindParent(bst-&gt;lchild, child);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="literal">NULL</span> != bst-&gt;rchild)</span><br><span class="line">    &#123;</span><br><span class="line">        FindParent(bst-&gt;rchild, child);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Delete</span><span class="params">(BSTree *bst, <span class="keyword">int</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">NULL</span> == *bst)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);  <span class="comment">//空树直接报错 </span></span><br><span class="line">    &#125;</span><br><span class="line">    BSTNode *p;</span><br><span class="line">    BSTNode *f = <span class="literal">NULL</span>;</span><br><span class="line">    BSTNode *q, *s;</span><br><span class="line">    <span class="keyword">if</span> (Search(*bst, key, <span class="literal">NULL</span>, &amp;p)) <span class="comment">//确实存在值为key的结点,则p指向该结点 </span></span><br><span class="line">    &#123;</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">NULL</span> == p-&gt;lchild &amp;&amp; <span class="literal">NULL</span> != p-&gt;rchild)  <span class="comment">//无左孩子,有右孩子 </span></span><br><span class="line">        &#123;</span><br><span class="line">            q = p-&gt;rchild;</span><br><span class="line">            p-&gt;data = q-&gt;data;<span class="comment">//因为两个结点之间本质的不同在于数据域的不同,而与放在哪个地址没有关系 </span></span><br><span class="line">            p-&gt;rchild = q-&gt;rchild;</span><br><span class="line">            p-&gt;lchild = q-&gt;lchild;</span><br><span class="line">            <span class="built_in">free</span>(q);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="literal">NULL</span> == p-&gt;rchild &amp;&amp; <span class="literal">NULL</span> != p-&gt;lchild)  <span class="comment">//无右孩子,有左孩子 </span></span><br><span class="line">        &#123;</span><br><span class="line">            q = p-&gt;lchild;</span><br><span class="line">            p-&gt;data = q-&gt;data;</span><br><span class="line">            p-&gt;rchild = q-&gt;rchild;</span><br><span class="line">            p-&gt;lchild = q-&gt;lchild;</span><br><span class="line">            <span class="built_in">free</span>(q);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="literal">NULL</span> != p-&gt;rchild &amp;&amp; <span class="literal">NULL</span> != p-&gt;lchild) <span class="comment">//既有左孩子,又有右孩子 </span></span><br><span class="line">        &#123;</span><br><span class="line">            q = p;</span><br><span class="line">            s = p-&gt;lchild;   <span class="comment">//找左孩子的最右孩子 </span></span><br><span class="line">            <span class="keyword">while</span> (s-&gt;rchild)</span><br><span class="line">            &#123;</span><br><span class="line">                q = s;</span><br><span class="line">                s = s-&gt;rchild;</span><br><span class="line">            &#125;</span><br><span class="line">            p-&gt;data = s-&gt;data;</span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> (q != p)</span><br><span class="line">            &#123;</span><br><span class="line">                q-&gt;rchild = p-&gt;lchild;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                q-&gt;lchild = s-&gt;lchild;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">free</span>(s);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (*bst == p)   <span class="comment">//只有一个根结点 </span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">free</span>(*bst);</span><br><span class="line">                *bst = <span class="literal">NULL</span>;</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            BSTNode* parent = FindParent(*bst, p);</span><br><span class="line">            <span class="keyword">if</span> (parent-&gt;lchild == p)</span><br><span class="line">            &#123;</span><br><span class="line">                parent-&gt;lchild = <span class="literal">NULL</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                parent-&gt;rchild = <span class="literal">NULL</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">free</span>(p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Search</span><span class="params">(BSTree bst, <span class="keyword">int</span> key, BSTree f, BSTree *p)</span>  <span class="comment">//查找成功时,p指向值为key的结点。如果查找失败,则p指向遍历的最后一个结点 </span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!bst)</span><br><span class="line">    &#123;</span><br><span class="line">        *p = f;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (bst-&gt;data == key)  <span class="comment">//查找成功,直接返回 </span></span><br><span class="line">    &#123;</span><br><span class="line">        *p = bst;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (bst-&gt;data &lt; key)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Search(bst-&gt;rchild, key, bst, p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Search(bst-&gt;lchild, key, bst, p);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BSTNode *root = <span class="literal">NULL</span>;</span><br><span class="line">    Insert(&amp;root, <span class="number">45</span>);</span><br><span class="line">    Insert(&amp;root, <span class="number">24</span>);</span><br><span class="line">    Insert(&amp;root, <span class="number">53</span>);</span><br><span class="line">    Insert(&amp;root, <span class="number">12</span>);</span><br><span class="line">    Insert(&amp;root, <span class="number">90</span>);</span><br><span class="line">    InOderTraverse(root);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n%d &quot;</span>, Insert(&amp;root, <span class="number">45</span>));   <span class="comment">//输出0表示插入失败,输出1表示插入成功 </span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, Insert(&amp;root, <span class="number">4</span>));</span><br><span class="line">    InOderTraverse(root);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    Delete(&amp;root, <span class="number">53</span>);      <span class="comment">//删除结点53 </span></span><br><span class="line">    Delete(&amp;root, <span class="number">12</span>);      <span class="comment">//删除结点12 </span></span><br><span class="line">    Delete(&amp;root, <span class="number">90</span>);      <span class="comment">//删除结点90 </span></span><br><span class="line">    InOderTraverse(root);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果为</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">12</span> <span class="number">24</span> <span class="number">45</span> <span class="number">53</span> <span class="number">90</span></span><br><span class="line">The node(45) already exists.</span><br><span class="line"></span><br><span class="line"><span class="number">0</span> <span class="number">1</span></span><br><span class="line"><span class="number">4</span> <span class="number">12</span> <span class="number">24</span> <span class="number">45</span> <span class="number">53</span> <span class="number">90</span></span><br><span class="line"><span class="number">4</span> <span class="number">24</span> <span class="number">45</span></span><br></pre></td></tr></table></figure>

<h1 id="二-平衡二叉树"><a href="#二-平衡二叉树" class="headerlink" title="二. 平衡二叉树"></a>二. 平衡二叉树</h1><h2 id="A-简介-1"><a href="#A-简介-1" class="headerlink" title="(A) 简介"></a>(A) 简介</h2><ul>
<li><p>平衡二叉树的递归定义为，要么 Ta 是一棵空树，要么 Ta 的左子树和右子树都是平衡二叉树，且左子树和右子树的深度之差的绝对值不超过 1。</p>
</li>
<li><p>我们将二叉树上的结点上的左子树的深度的值减去右子树的深度的值称为平衡因子 BF (Balance Factor)，平衡二叉树就是一棵二叉树上所有的平衡因子的绝对值小于等于 1 的树。</p>
</li>
<li><p>平衡二叉树的结构：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//平衡二叉树相对于二叉排序树的数据结构增加了平衡因子和父亲结点</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">T</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> data;<span class="comment">//结点数据</span></span><br><span class="line">    <span class="keyword">int</span> bal; <span class="comment">//平衡因子</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">T</span> *<span class="title">lchild</span>,*<span class="title">rchild</span>,*<span class="title">parent</span>;</span><span class="comment">//左孩子、右孩子、父亲结点</span></span><br><span class="line">&#125;*BiTree,LNode;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="B-旋转操作"><a href="#B-旋转操作" class="headerlink" title="(B) 旋转操作"></a>(B) 旋转操作</h2><h3 id="a-概述"><a href="#a-概述" class="headerlink" title="(a) 概述"></a>(a) 概述</h3><p>当某一结点的平衡因子的绝对值大于一时，则不满足平衡二叉树的定义，需要对其进行旋转操作，使其保持平衡。<br>我们设不平衡点为 Parent，Parent 的父亲结点为 X，Parent 的左孩子为 SubL，右孩子为 SubR，SubL 的右孩子为 SubLR，SubR 的左孩子为 SubRL，旋转操作共有四种(对 Parent 进行旋转操作)：</p>
<ol>
<li>左单旋转：SubLR 成为 Parent 的左孩子，Parent 成为 SubL 的右孩子，SubL 成为 X 的左孩子或右孩子。</li>
<li>右单旋转：SubRL 成为 Parent 的右孩子，Parent 成为 SubR 的左孩子，SubR 成为 X 的左孩子或右孩子。</li>
<li>右左双旋转：对 SubL 进行一次右单旋转，再对 Parent 进行左单旋转。</li>
<li>左右双旋转：对 SubR 进行一次左单旋转，再对 Parent 进行右单旋转。</li>
</ol>
<p>具体旋转变化如下图所示：</p>
<p><img src="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2501.jpg"></p>
<p><img src="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2502.jpg"></p>
<p><img src="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2503.jpg"></p>
<p><img src="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2504.jpg"></p>
<h3 id="b-代码"><a href="#b-代码" class="headerlink" title="(b) 代码"></a>(b) 代码</h3><h4 id="1-左单旋转"><a href="#1-左单旋转" class="headerlink" title="(1) 左单旋转"></a>(1) 左单旋转</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//传参parent是最小不平衡子树的根结点,T是整棵树的根结点指针</span></span><br><span class="line"><span class="comment">//传参类型为指针的地址</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RotateLeft</span><span class="params">(BiTree *parent,BiTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LNode *x=(*parent)-&gt;parent;</span><br><span class="line">    LNode *SubR=(*parent)-&gt;rchild;</span><br><span class="line">    LNode *SubRL=SubR-&gt;lchild;</span><br><span class="line">    <span class="comment">//parent的右孩子为SubRL</span></span><br><span class="line">    (*parent)-&gt;rchild=SubRL;</span><br><span class="line">    <span class="keyword">if</span>(SubRL)</span><br><span class="line">    &#123;</span><br><span class="line">        SubRL-&gt;parent=(*parent);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//SubR的左孩子为parent</span></span><br><span class="line">    SubR-&gt;lchild=(*parent);</span><br><span class="line">    (*parent)-&gt;parent=SubR;</span><br><span class="line">    <span class="comment">//x的孩子为SubR</span></span><br><span class="line">    <span class="keyword">if</span>(!x)</span><br><span class="line">    &#123;</span><br><span class="line">        (*T)=SubR;</span><br><span class="line">        SubR-&gt;parent=<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(x-&gt;lchild==(*parent))</span><br><span class="line">        &#123;</span><br><span class="line">            x-&gt;lchild=SubR;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            x-&gt;rchild=SubR;</span><br><span class="line">        &#125;</span><br><span class="line">        SubR-&gt;parent=x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-右单旋转"><a href="#2-右单旋转" class="headerlink" title="(2) 右单旋转"></a>(2) 右单旋转</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//传参parent是最小不平衡子树的根结点,T是整棵树的根结点指针</span></span><br><span class="line"><span class="comment">//传参类型为指针的地址</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RotateRight</span><span class="params">(BiTree *parent,BiTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LNode *x=(*parent)-&gt;parent;<span class="comment">//记录父亲结点</span></span><br><span class="line">    LNode *SubL=(*parent)-&gt;lchild;<span class="comment">//记录根结点的左孩子</span></span><br><span class="line">    LNode *SubLR=SubL-&gt;rchild;<span class="comment">//根结点左孩子的右孩子</span></span><br><span class="line">    <span class="comment">//parent的左孩子为SubLR</span></span><br><span class="line">    (*parent)-&gt;lchild=SubLR;</span><br><span class="line">    <span class="keyword">if</span>(SubLR)</span><br><span class="line">    &#123;</span><br><span class="line">        SubLR-&gt;parent=(*parent);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//SubL的右孩子为parent</span></span><br><span class="line">    SubL-&gt;rchild=(*parent);</span><br><span class="line">    (*parent)-&gt;parent=SubL;</span><br><span class="line">    <span class="comment">/*--更新x的孩子结点--*/</span></span><br><span class="line">    <span class="comment">//若x不存在,则说明parent即是根结点</span></span><br><span class="line">    <span class="keyword">if</span>(!x)</span><br><span class="line">    &#123;</span><br><span class="line">        (*T)=SubL;</span><br><span class="line">        SubL-&gt;parent=<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//存在则判断parent是x的左孩子还是右孩子，SubL替换</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(x-&gt;lchild==(*parent))</span><br><span class="line">        &#123;</span><br><span class="line">            x-&gt;lchild=SubL;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            x-&gt;rchild=SubL;</span><br><span class="line">        &#125;</span><br><span class="line">        SubL-&gt;parent=x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-右左双旋转"><a href="#3-右左双旋转" class="headerlink" title="(3) 右左双旋转"></a>(3) 右左双旋转</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RotateRL</span><span class="params">(BiTree *parent,BiTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    RotateRight(&amp;((*parent)-&gt;rchild),T);</span><br><span class="line">    RotateLeft(parent,T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-左右双旋转"><a href="#4-左右双旋转" class="headerlink" title="(4) 左右双旋转"></a>(4) 左右双旋转</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RotateLR</span><span class="params">(BiTree *parent,BiTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//先对SubL进行左转变化、再对parent进行右转变化</span></span><br><span class="line">    RotateLeft(&amp;((*parent)-&gt;lchild),T);</span><br><span class="line">    RotateRight(parent,T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="C-增删改查"><a href="#C-增删改查" class="headerlink" title="(C) 增删改查"></a>(C) 增删改查</h2><h3 id="a-求平衡因子"><a href="#a-求平衡因子" class="headerlink" title="(a) 求平衡因子"></a>(a) 求平衡因子</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*--------------------求平衡因子----------------*/</span></span><br><span class="line"><span class="comment">//计算树的高度 这里使用递归求树的高度</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Height</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n,m;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    n=Height(T-&gt;rchild);</span><br><span class="line">    m=Height(T-&gt;lchild);</span><br><span class="line">    <span class="keyword">if</span>(m&gt;n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> m+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> n+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    该结点的平衡因子等于右子树的高度减左子树的高度</span></span><br><span class="line"><span class="comment">    递归求解</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Calbalance</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    T-&gt;bal=Height(T-&gt;rchild)-Height(T-&gt;lchild);<span class="comment">//此处是右树高度减左树高度,在重新平衡判定中起作用</span></span><br><span class="line">    <span class="comment">//printf(&quot;%d %d\n&quot;,T-&gt;data,T-&gt;bal);</span></span><br><span class="line">    Calbalance(T-&gt;rchild);</span><br><span class="line">    Calbalance(T-&gt;lchild);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="b-插入"><a href="#b-插入" class="headerlink" title="(b) 插入"></a>(b) 插入</h3><h4 id="1-分析"><a href="#1-分析" class="headerlink" title="(1) 分析"></a>(1) 分析</h4><p>平衡二叉树的插入操作和二叉树类似，只是在插入操作结束之后，有可能会引起失衡，此时需要进行旋转操作使平衡二叉树继续保持平衡。失衡分析，<br>设插入结点为 p，插入结点的父亲结点为 x，现考察 x 结点的父亲结点 parent。有三种情形：</p>
<ul>
<li>情形 1：当 abs(parent-&gt;bal)=1，树保持平衡，但以 parent 为根结点的子树高度增加 1，即需向上回溯检查 parent 的父结点。</li>
<li>情形 2：当 abs(parent-&gt;bal)=0，树保持平衡，且以 parent 为根结点的子树高度不变，即结束运算。</li>
<li>情形 3：当 abs(parent-&gt;bal)&gt;1，树失去平衡，此时考察结点 x 判读破坏平衡的结点发生在哪里，此时有四种情况，<br>– parent-&gt;bal=-2 &amp;&amp; parent-&gt;lchild-&gt;bal=1，此时的操作是左右双旋转。<br>– parent-&gt;bal=-2 &amp;&amp; parent-&gt;lchild-&gt;bal=-1，此时的操作是右单旋转。<br>– parent-&gt;bal=2 &amp;&amp; parent-&gt;rchild-&gt;bal=1，此时的操作是左单旋转。<br>– parent-&gt;bal=2 &amp;&amp; parent-&gt;rchild-&gt;bal=-1，此时的操作是右左双旋转。<br>图示如下<br><img src="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2505.jpg"></li>
</ul>
<p><img src="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2506.jpg"></p>
<h4 id="2-插入运算维护平衡代码"><a href="#2-插入运算维护平衡代码" class="headerlink" title="(2) 插入运算维护平衡代码"></a>(2) 插入运算维护平衡代码</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertBalance</span><span class="params">(BiTree *x,BiTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">    LNode *parent=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">//x结点是插入结点的父亲结点</span></span><br><span class="line">    <span class="comment">//若插入结点不是根结点</span></span><br><span class="line">    <span class="keyword">if</span>(*x)</span><br><span class="line">    &#123;</span><br><span class="line">        parent=(*x)-&gt;parent;<span class="comment">//考察其父亲结点</span></span><br><span class="line">        <span class="keyword">while</span>(parent)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//情形3</span></span><br><span class="line">            <span class="keyword">if</span>(parent-&gt;bal&lt;<span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(parent-&gt;lchild-&gt;bal==<span class="number">-1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    RotateRight(&amp;parent,T);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    RotateLR(&amp;parent,T);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(parent-&gt;bal&gt;<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(parent-&gt;rchild-&gt;bal==<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    RotateLeft(&amp;parent,T);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    RotateRL(&amp;parent,T);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//情形2</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(parent-&gt;bal==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//情形1</span></span><br><span class="line">            parent=parent-&gt;parent;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-插入运算的实现"><a href="#3-插入运算的实现" class="headerlink" title="(3) 插入运算的实现"></a>(3) 插入运算的实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建新结点</span></span><br><span class="line"><span class="function">LNode* <span class="title">NewNode</span><span class="params">(<span class="keyword">int</span> data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LNode *p=(LNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));</span><br><span class="line">    p-&gt;bal=<span class="number">0</span>;</span><br><span class="line">    p-&gt;data=data;</span><br><span class="line">    p-&gt;lchild=<span class="literal">NULL</span>;</span><br><span class="line">    p-&gt;parent=<span class="literal">NULL</span>;</span><br><span class="line">    p-&gt;rchild=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//平衡二叉树的插入运算</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(BiTree *T,<span class="keyword">int</span> data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LNode *parent=<span class="literal">NULL</span>;<span class="comment">//记录插入结点的父亲结点</span></span><br><span class="line">    LNode *p=(*T);</span><br><span class="line">    <span class="keyword">if</span>((*T)==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        (*T)=NewNode(data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//找到插入位置</span></span><br><span class="line">        <span class="keyword">while</span>(p)</span><br><span class="line">        &#123;</span><br><span class="line">            parent=p;<span class="comment">//记录父亲结点</span></span><br><span class="line">            <span class="keyword">if</span>(p-&gt;data==data)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;fault :%d\n&quot;</span>,p-&gt;data);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;data&gt;data)</span><br><span class="line">            &#123;</span><br><span class="line">                p=p-&gt;lchild;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                p=p-&gt;rchild;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//创新结点并插入</span></span><br><span class="line">        p=NewNode(data);</span><br><span class="line">        <span class="keyword">if</span>(parent-&gt;data&gt;data)</span><br><span class="line">        &#123;</span><br><span class="line">            parent-&gt;lchild=p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            parent-&gt;rchild=p;</span><br><span class="line">        &#125;</span><br><span class="line">        p-&gt;parent=parent;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//更新平衡因子并维护平衡</span></span><br><span class="line">    Calbalance((*T));</span><br><span class="line">    InsertBalance(&amp;parent,T);</span><br><span class="line">    Calbalance((*T));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="c-删除"><a href="#c-删除" class="headerlink" title="(c) 删除"></a>(c) 删除</h3><h4 id="1-删除操作维护平衡代码"><a href="#1-删除操作维护平衡代码" class="headerlink" title="(1) 删除操作维护平衡代码"></a>(1) 删除操作维护平衡代码</h4><p>平衡二叉树的删除操作和二叉排序树是一致的，但在删除操作后需要对树进行维护，使其仍然保持平衡二叉树的性质。需要注意的是对于平衡二叉树的删除操作，我们所进行的步骤是找到删除结点和替换结点，然后用替换结点代替删除结点，并将删除结点删去，而不是调换其数值后删除替换结点。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*传入参数p是替换节点的父亲节点的地址,T是树的根节点的地址*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DeleteBalance</span><span class="params">(BiTree *T,BiTree *p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//printf(&quot;p: %d %d\n&quot;,(*p)-&gt;data,(*p)-&gt;bal);</span></span><br><span class="line">    LNode *Review=<span class="literal">NULL</span>;<span class="comment">//记录需要回溯的结点</span></span><br><span class="line">    LNode *Pchild=<span class="literal">NULL</span>;<span class="comment">//记录p节点的孩子结点</span></span><br><span class="line">    LNode* parent=(*p);<span class="comment">//p节点</span></span><br><span class="line">    <span class="comment">/*若到根结点则停止或平衡因子绝对值为1*/</span></span><br><span class="line">    <span class="keyword">if</span>(!parent||<span class="built_in">abs</span>(parent-&gt;bal)==<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//parent-&gt;bal=0的情形</span></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(parent-&gt;bal==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//更新节点p的父结点的平衡因子并考察</span></span><br><span class="line">        parent=(*p)-&gt;parent;</span><br><span class="line">        <span class="comment">//若p是右子树则平衡因子减一否则加一</span></span><br><span class="line">        <span class="keyword">if</span>(parent)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(parent-&gt;rchild==(*p))</span><br><span class="line">            &#123;</span><br><span class="line">                parent-&gt;bal--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                parent-&gt;bal++;</span><br><span class="line">            &#125;</span><br><span class="line">            DeleteBalance(T,&amp;parent);<span class="comment">//回溯</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//回溯</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//当平衡因子绝对值等于2的时候</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">           由于运算过程,在回溯时只更新Review结点的平衡因子</span></span><br><span class="line"><span class="comment">           并根据其位置将parent结点的平衡因子进行加一或减一</span></span><br><span class="line"><span class="comment">           会导致parent-&gt;bal的值超过-2或2</span></span><br><span class="line"><span class="comment">           所以这里是小于等于</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span>(parent-&gt;bal&lt;=<span class="number">-2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Pchild=parent-&gt;lchild;</span><br><span class="line">            <span class="keyword">if</span>(Pchild-&gt;bal==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                RotateRight(&amp;parent,T);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Pchild-&gt;bal==<span class="number">-1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//记录旋转后的根结点</span></span><br><span class="line">                Review=Pchild;</span><br><span class="line">                RotateRight(&amp;parent,T);</span><br><span class="line">                <span class="comment">//更新他的平衡因子为0</span></span><br><span class="line">                Review-&gt;bal=<span class="number">0</span>;</span><br><span class="line">                DeleteBalance(T,&amp;Review);<span class="comment">//回溯</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//记录旋转后的根结点</span></span><br><span class="line">                Review=Pchild-&gt;rchild;</span><br><span class="line">                RotateLR(&amp;parent,T);</span><br><span class="line">                Review-&gt;bal=<span class="number">0</span>;</span><br><span class="line">                DeleteBalance(T,&amp;Review);<span class="comment">//回溯</span></span><br><span class="line"> </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//和上面的情形是对称的</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            Pchild=parent-&gt;rchild;</span><br><span class="line">            <span class="keyword">if</span>(Pchild-&gt;bal==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                RotateLeft(&amp;parent,T);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(Pchild-&gt;bal==<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Review=Pchild;</span><br><span class="line">                RotateLeft(&amp;parent,T);</span><br><span class="line">                Review-&gt;bal=<span class="number">0</span>;</span><br><span class="line">                parent=Review-&gt;parent;</span><br><span class="line">                DeleteBalance(T,&amp;Review);<span class="comment">//回溯</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Review=Pchild-&gt;lchild;</span><br><span class="line">                RotateRL(&amp;parent,T);</span><br><span class="line">                Review-&gt;bal=<span class="number">0</span>;</span><br><span class="line">                DeleteBalance(T,&amp;Review);<span class="comment">//回溯</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-删除操作的实现"><a href="#2-删除操作的实现" class="headerlink" title="(2) 删除操作的实现"></a>(2) 删除操作的实现</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//查找函数</span></span><br><span class="line"><span class="function">LNode* <span class="title">FindNode</span><span class="params">(BiTree T,<span class="keyword">int</span> data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LNode *p=T;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;data==data)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;data&gt;data)</span><br><span class="line">        &#123;</span><br><span class="line">            p=p-&gt;lchild;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            p=p-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    思路：</span></span><br><span class="line"><span class="comment">        找到删除结点、找出替换结点，用替换结点代替删除结点、删掉删除结点     </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DeleteNode</span><span class="params">(BiTree *T,<span class="keyword">int</span> data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LNode *p=FindNode((*T),data);<span class="comment">//被删除结点</span></span><br><span class="line">    LNode *x=<span class="literal">NULL</span>;<span class="comment">//记录被删除点</span></span><br><span class="line">    LNode *parent=<span class="literal">NULL</span>;<span class="comment">//指向被删结点的父亲</span></span><br><span class="line">    BiTree flag=<span class="literal">NULL</span>;<span class="comment">//替换结点的父结点</span></span><br><span class="line">    <span class="comment">//若存在</span></span><br><span class="line">    <span class="keyword">if</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        x=p;<span class="comment">//记录被删结点</span></span><br><span class="line">        <span class="comment">//如果两个结点都存在</span></span><br><span class="line">        <span class="keyword">if</span>(p-&gt;lchild&amp;&amp;p-&gt;rchild)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//找右子树的最小值</span></span><br><span class="line">                p=p-&gt;rchild;</span><br><span class="line">                <span class="keyword">if</span>(!p-&gt;lchild)</span><br><span class="line">                &#123;</span><br><span class="line">                    flag=p;</span><br><span class="line">                    p-&gt;lchild=x-&gt;lchild;</span><br><span class="line">                    x-&gt;lchild-&gt;parent=p; </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//找到最左值</span></span><br><span class="line">                    <span class="keyword">while</span>(p-&gt;lchild)</span><br><span class="line">                    &#123;</span><br><span class="line">                        p=p-&gt;lchild;</span><br><span class="line">                    &#125;</span><br><span class="line">                    flag=p-&gt;parent;</span><br><span class="line">                    <span class="comment">//最左值的父结点</span></span><br><span class="line">                    parent=p-&gt;parent;</span><br><span class="line">                    <span class="comment">//接管x的左孩子</span></span><br><span class="line">                    p-&gt;lchild=x-&gt;lchild;</span><br><span class="line">                    x-&gt;lchild-&gt;parent=p;</span><br><span class="line">                    <span class="comment">//接管p的右孩子</span></span><br><span class="line">                    parent-&gt;lchild=p-&gt;rchild;</span><br><span class="line">                    <span class="keyword">if</span>(p-&gt;rchild)</span><br><span class="line">                    &#123;</span><br><span class="line">                        p-&gt;rchild-&gt;parent=parent;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">//接管x的右孩子</span></span><br><span class="line">                    p-&gt;rchild=x-&gt;rchild;</span><br><span class="line">                    x-&gt;rchild-&gt;parent=p;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//只右子树存在</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!p-&gt;lchild&amp;&amp;p-&gt;rchild)</span><br><span class="line">        &#123;</span><br><span class="line">            p=p-&gt;rchild;</span><br><span class="line">            flag=p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//只左子树存在</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;lchild&amp;&amp;!p-&gt;rchild)</span><br><span class="line">        &#123;</span><br><span class="line">            p=p-&gt;rchild;</span><br><span class="line">            flag=p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//若p是叶子结点则直接置空</span></span><br><span class="line">            flag=p-&gt;parent;</span><br><span class="line">            p=<span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">/*--接管p--*/</span></span><br><span class="line">        parent=x-&gt;parent;</span><br><span class="line">        <span class="comment">//若被删结点是根结点</span></span><br><span class="line">        <span class="keyword">if</span>(!parent)</span><br><span class="line">        &#123;</span><br><span class="line">            (*T)=p;</span><br><span class="line">            p-&gt;parent=<span class="literal">NULL</span>; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(parent-&gt;lchild==x)</span><br><span class="line">            &#123;</span><br><span class="line">                parent-&gt;lchild=p;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                parent-&gt;rchild=p;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//如果p不是叶子结点</span></span><br><span class="line">            <span class="keyword">if</span>(p)</span><br><span class="line">            &#123;</span><br><span class="line">                p-&gt;parent=parent;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//flag是替换结点的父亲结点</span></span><br><span class="line">    Calbalance((*T));</span><br><span class="line">    DeleteBalance(T,&amp;flag);</span><br><span class="line">    Calbalance((*T));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="d-其他操作的代码实现"><a href="#d-其他操作的代码实现" class="headerlink" title="(d) 其他操作的代码实现"></a>(d) 其他操作的代码实现</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*-------测试使用函数-------*/</span></span><br><span class="line"><span class="comment">//队列</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Qd</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    BiTree p[maxsize];</span><br><span class="line">    <span class="keyword">int</span> rear,font;</span><br><span class="line">&#125;Queue;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//访问节点</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,T-&gt;data);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//初始化队列</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitiaQueue</span><span class="params">(Queue *Q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    (*Q).rear=(*Q).font=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断队空</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IsEmpty</span><span class="params">(Queue *Q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((*Q).rear==(*Q).font)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//入队</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">EnQueue</span><span class="params">(Queue *Q,BiTree p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        (*Q).p[(*Q).font]=p;</span><br><span class="line">        (*Q).font++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//出队</span></span><br><span class="line"><span class="function">BiTree <span class="title">DeQueue</span><span class="params">(Queue *Q)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> index = (*Q).rear;</span><br><span class="line">        (*Q).rear++;</span><br><span class="line">        <span class="keyword">return</span> (*Q).p[index];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//层次遍历</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">LevelOrder</span><span class="params">(BiTree tree)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BiTree p;</span><br><span class="line">    Queue Q;</span><br><span class="line">    InitiaQueue(&amp;Q);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(tree!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        EnQueue(&amp;Q,tree);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!IsEmpty(&amp;Q))</span><br><span class="line">    &#123;</span><br><span class="line">        p=DeQueue(&amp;Q);</span><br><span class="line">        visit(p);</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;lchild!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            EnQueue(&amp;Q,p-&gt;lchild);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;rchild!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            EnQueue(&amp;Q,p-&gt;rchild);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//先序遍历</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">preOrder</span><span class="params">(BiTree tree)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tree==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        visit(tree);</span><br><span class="line">        preOrder(tree-&gt;lchild);</span><br><span class="line">        preOrder(tree-&gt;rchild);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">inOrder</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    InOrder(T-&gt;lchild);</span><br><span class="line">    visit(T);</span><br><span class="line">    InOrder(T-&gt;rchild);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//中序遍历</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">InOrder</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    InOrder(T-&gt;lchild);</span><br><span class="line">    visit(T);</span><br><span class="line">    InOrder(T-&gt;rchild);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//判定是不是一棵平衡二叉树</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Juidge</span><span class="params">(BiTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Juidge(T-&gt;lchild);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(T-&gt;bal)&gt;<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d FAULT! %d\n&quot;</span>,T-&gt;data,T-&gt;bal);</span><br><span class="line">    &#125;</span><br><span class="line">    Juidge(T-&gt;rchild);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="D-平衡二叉树代码示例"><a href="#D-平衡二叉树代码示例" class="headerlink" title="(D) 平衡二叉树代码示例"></a>(D) 平衡二叉树代码示例</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*    </span></span><br><span class="line"><span class="comment">*    平衡二叉树(AVL):由于在极端情况下(左斜树和右斜树)</span></span><br><span class="line"><span class="comment">*    二叉搜索树(BST)查找时间效率大大降低到O(n)，故需要</span></span><br><span class="line"><span class="comment">*    对其进行平衡，平衡的方法有很多种，如AVL，红黑树等，</span></span><br><span class="line"><span class="comment">*    此处通过平衡因子的方法使用AVL树来达到平衡的目的。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LH -1        <span class="comment">//LH,EH,RH表示平衡因子值</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> EH 0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RH 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Anode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">    <span class="keyword">int</span> bf;<span class="comment">//即当前结点的左子树高度减去右子树高度的差</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Anode</span> *<span class="title">lchild</span>, *<span class="title">rchild</span>;</span></span><br><span class="line">&#125;Anode, *AVLTree;<span class="comment">/*AVL树结构，在二叉树基础上加了一个bf平衡因子*/</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">InsertAVL</span><span class="params">(AVLTree *T, <span class="keyword">int</span> key, <span class="keyword">int</span> *taller)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LeftBalance</span><span class="params">(AVLTree *T)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">RightBalance</span><span class="params">(AVLTree *T)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LeftRotate</span><span class="params">(AVLTree *T)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RightRotate</span><span class="params">(AVLTree *T)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DeleteAVL</span><span class="params">(AVLTree *T, <span class="keyword">int</span> key, <span class="keyword">int</span> *lower)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Delete</span><span class="params">(AVLTree *p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SearchAVL</span><span class="params">(AVLTree T, <span class="keyword">int</span> key, AVLTree f, AVLTree *p)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InOrderView</span><span class="params">(AVLTree T)</span></span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//AVL树插入关键字操作,*taller用来记录插入结点后树是否有长高</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">InsertAVL</span><span class="params">(AVLTree *T, <span class="keyword">int</span> key, <span class="keyword">int</span> *taller)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!(*T))</span><br><span class="line">    &#123;<span class="comment">//若AVL树是空树，则直接分配结点内存存入关键字，树长高</span></span><br><span class="line">        (*T) = (AVLTree)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Anode));</span><br><span class="line">        (*T)-&gt;data = key;</span><br><span class="line">        (*T)-&gt;lchild = (*T)-&gt;rchild = <span class="literal">NULL</span>;</span><br><span class="line">        (*taller) = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;<span class="comment">//若AVL非空树</span></span><br><span class="line">        <span class="keyword">if</span> (key == (*T)-&gt;data)</span><br><span class="line">        &#123;<span class="comment">//如果找到当前结点的值等于欲插入的关键字，则说明已存在该关键字，不再重复插入，树没长高</span></span><br><span class="line">            (*taller) = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (key &lt; (*T)-&gt;data)</span><br><span class="line">        &#123;<span class="comment">//若欲插入的关键字小于当前结点值，则在当前结点的左子树递归看是否插入该结点</span></span><br><span class="line">            <span class="keyword">if</span> (!InsertAVL(&amp;(*T)-&gt;lchild, key, taller))</span><br><span class="line">            &#123;<span class="comment">//插入失败</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (*taller)</span><br><span class="line">            &#123;<span class="comment">//若插入成功，则*taller必然等于1，此时只要根据当前结点的平衡因子来调整树达到平衡</span></span><br><span class="line">                <span class="keyword">switch</span> ((*T)-&gt;bf)</span><br><span class="line">                &#123;                        <span class="comment">//插入结点在当前节点的左子树的某处</span></span><br><span class="line">                    <span class="keyword">case</span> LH:            <span class="comment">//如果原来左子树高度就比右子树高1</span></span><br><span class="line">                        LeftBalance(T); <span class="comment">//就调用左平衡函数</span></span><br><span class="line">                        (*taller) = <span class="number">0</span>;  <span class="comment">//平衡过后，树相对于原来的树并无长高，故设置(*taller) = 0</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> EH:            <span class="comment">//如果原来左子树跟右子树等高</span></span><br><span class="line">                        (*T)-&gt;bf = LH;    <span class="comment">//则当前结点的平衡因子就改为LH(左边高1)</span></span><br><span class="line">                        (*taller) = <span class="number">1</span>;    <span class="comment">//相比原树，树长高</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> RH:            <span class="comment">//如果原来右子树高度就比左子树高1</span></span><br><span class="line">                        (*T)-&gt;bf = EH; <span class="comment">//在左子树插入关键字结点后，当前结点平衡因子变为EH(左右等高)</span></span><br><span class="line">                        (*taller) = <span class="number">0</span>;    <span class="comment">//相比原树，树并未长高</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;<span class="comment">//若欲插入的关键字大于当前结点值，则在当前结点的右子树递归看是否插入该结点</span></span><br><span class="line">         <span class="comment">//以下代码道理同上，只不过是在右子树上做文章，不再赘述</span></span><br><span class="line">            <span class="keyword">if</span> (!InsertAVL(&amp;(*T)-&gt;rchild, key, taller))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (*taller)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">switch</span> ((*T)-&gt;bf)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">case</span> LH:</span><br><span class="line">                        (*T)-&gt;bf = EH;</span><br><span class="line">                        (*taller) = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> EH:</span><br><span class="line">                        (*T)-&gt;bf = RH;</span><br><span class="line">                        (*taller) = <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> RH:</span><br><span class="line">                        RightBalance(T);</span><br><span class="line">                        (*taller) = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//左平衡函数，调用此函数说明当前结点的子树已然左边不平衡</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LeftBalance</span><span class="params">(AVLTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//此函数包含了左平衡的两种情况：1.根结点单右旋        2.根结点左孩子左旋然后根结点右旋</span></span><br><span class="line">    AVLTree L, Lr;</span><br><span class="line">    L = (*T)-&gt;lchild;        <span class="comment">//当前树根结点的左孩子</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span> (L-&gt;bf)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> LH:            <span class="comment">//若L左子树高，则直接根结点单右旋，并修正根结点与其左孩子的平衡因子值</span></span><br><span class="line">            (*T)-&gt;bf = L-&gt;bf = EH;        <span class="comment">//这两句代码不可调换</span></span><br><span class="line">            RightRotate(T);                <span class="comment">//因为右旋转函数会改变原来的T值(即当前树根结点发生变化)</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> RH:</span><br><span class="line">            Lr = L-&gt;rchild;    <span class="comment">//若L右子树高，则根据L的右孩子Lr的平衡因子值来修正根结点T与L的平衡因子值</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">switch</span>(Lr-&gt;bf)</span><br><span class="line">            &#123;<span class="comment">//分情况修改平衡因子值，请自行画辅助图理解</span></span><br><span class="line">                <span class="keyword">case</span> LH:    </span><br><span class="line">                    (*T)-&gt;bf = RH;</span><br><span class="line">                    L-&gt;bf = EH;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> EH:</span><br><span class="line">                    (*T)-&gt;bf = L-&gt;bf = EH;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RH:</span><br><span class="line">                    (*T)-&gt;bf = EH;</span><br><span class="line">                    L-&gt;bf = LH;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            Lr-&gt;bf = EH;    <span class="comment">//平衡完后L的右孩子平衡因子修正为EH，因左右等高</span></span><br><span class="line">            </span><br><span class="line">            LeftRotate(&amp;(*T)-&gt;lchild);        <span class="comment">//先对根结点T的左孩子进行左旋</span></span><br><span class="line">            RightRotate(T);                    <span class="comment">//再对根结点T进行右旋</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//右平衡函数，道理同上，代码差别如同对称成像，不再赘述，自行阅读</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">RightBalance</span><span class="params">(AVLTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVLTree R, Rl;</span><br><span class="line">    R = (*T)-&gt;rchild;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">switch</span> (R-&gt;bf)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> LH:</span><br><span class="line">            Rl = R-&gt;lchild;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">switch</span>(Rl-&gt;bf)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> LH:</span><br><span class="line">                    (*T)-&gt;bf = EH;</span><br><span class="line">                    R-&gt;bf = RH;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> EH:</span><br><span class="line">                    (*T)-&gt;bf = R-&gt;bf = EH;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> RH:</span><br><span class="line">                    (*T)-&gt;bf = LH;</span><br><span class="line">                    R-&gt;bf = EH;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            Rl-&gt;bf = EH;</span><br><span class="line">            </span><br><span class="line">            RightRotate(&amp;(*T)-&gt;rchild);</span><br><span class="line">            LeftRotate(T);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> RH:</span><br><span class="line">            (*T)-&gt;bf = R-&gt;bf = EH;</span><br><span class="line">            LeftRotate(T);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//左旋函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LeftRotate</span><span class="params">(AVLTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVLTree R;            </span><br><span class="line">    R = (*T)-&gt;rchild;                <span class="comment">//取当前树根结点的右孩子</span></span><br><span class="line">    (*T)-&gt;rchild = R-&gt;lchild;        <span class="comment">//将右孩子R的左孩子作为当前结点*T的右孩子</span></span><br><span class="line">    R-&gt;lchild = (*T);                <span class="comment">//将*T作为R的左孩子</span></span><br><span class="line">    (*T) = R;                        <span class="comment">//将当前结点的右孩子R作为新的树根结点</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//右旋函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RightRotate</span><span class="params">(AVLTree *T)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//与左旋函数操作相反，不再赘述</span></span><br><span class="line">    AVLTree L;</span><br><span class="line">    L = (*T)-&gt;lchild;</span><br><span class="line">    (*T)-&gt;lchild = L-&gt;rchild;</span><br><span class="line">    L-&gt;rchild = (*T);</span><br><span class="line">    (*T) = L;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//AVL树删除关键字操作,*lower用来记录插入结点后树是否有变矮</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">DeleteAVL</span><span class="params">(AVLTree *T, <span class="keyword">int</span> key, <span class="keyword">int</span> *lower)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!(*T))</span><br><span class="line">    &#123;<span class="comment">//若当前树为空树，则删除失败返回0</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (key == (*T)-&gt;data)</span><br><span class="line">        &#123;                        <span class="comment">//若当前结点等于欲删除关键字</span></span><br><span class="line">            Delete(T);            <span class="comment">//则调用删除函数</span></span><br><span class="line">            (*lower) = <span class="number">1</span>;        <span class="comment">//树变矮</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (key &lt; (*T)-&gt;data)</span><br><span class="line">        &#123;<span class="comment">//若欲删除关键字小于当前节点值</span></span><br><span class="line">            <span class="keyword">if</span> (!DeleteAVL(&amp;(*T)-&gt;lchild, key, lower))</span><br><span class="line">            &#123;<span class="comment">//如果左子树也找不到等于此关键字的结点值，删除失败</span></span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (*lower)</span><br><span class="line">            &#123;<span class="comment">//若删除成功，则*lower必然等于1，此时只要根据当前结点的平衡因子来调整树达到平衡</span></span><br><span class="line">                <span class="keyword">switch</span> ((*T)-&gt;bf)</span><br><span class="line">                &#123;                                <span class="comment">//删除的结点在当前结点的左子树的某处</span></span><br><span class="line">                    <span class="keyword">case</span> LH:                    <span class="comment">//如果原来左子树高度就比右子树高1</span></span><br><span class="line">                        (*T)-&gt;bf = EH;            <span class="comment">//则删除后，两边等高，故(*T)-&gt;bf = EH</span></span><br><span class="line">                        (*lower) = <span class="number">1</span>;            <span class="comment">//相比原树，树变矮</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> EH:                    <span class="comment">//如果原来左子树与右子树等高</span></span><br><span class="line">                        (*T)-&gt;bf = RH;            <span class="comment">//则删除后右子树比较高</span></span><br><span class="line">                        (*lower) = <span class="number">0</span>;            <span class="comment">//左边树变矮，右边不变，但总体树高没变矮</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> RH:                <span class="comment">//如果原来右子树高度就比左子树高1</span></span><br><span class="line">                        RightBalance(T);    <span class="comment">//则删除后，右子树比左子树高2，故需要调用右平衡函数</span></span><br><span class="line">                        (*lower) = <span class="number">1</span>;        <span class="comment">//调整过后，相比原树，树变矮</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;<span class="comment">//若欲删除关键字大于当前结点值，道理同上，不再赘述</span></span><br><span class="line">            <span class="keyword">if</span> (!DeleteAVL(&amp;(*T)-&gt;rchild, key, lower))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (*lower)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">switch</span> ((*T)-&gt;bf)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">case</span> LH:</span><br><span class="line">                        LeftBalance(T);</span><br><span class="line">                        (*lower) = <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> EH:</span><br><span class="line">                        (*T)-&gt;bf = LH;</span><br><span class="line">                        (*lower) = <span class="number">0</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> RH:</span><br><span class="line">                        (*T)-&gt;bf = EH;</span><br><span class="line">                        (*lower) = <span class="number">1</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">//AVL树删除结点以及后续结构调整函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Delete</span><span class="params">(AVLTree *p)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//*p为当前要删除的树根结点，为了满足二叉搜索树的性质，分情况讨论</span></span><br><span class="line">    AVLTree q, s;<span class="comment">//定义两个结点指针，q是s的父结点</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ((*p)-&gt;rchild == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;                            <span class="comment">//如果当前欲删除结点没有右子树(孩子)</span></span><br><span class="line">        q = (*p);                <span class="comment">//则直接将当前结点的左孩子作为新的树根结点</span></span><br><span class="line">        (*p) = (*p)-&gt;lchild;    </span><br><span class="line">        <span class="built_in">free</span>(q);                <span class="comment">//释放结点占用内存</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ((*p)-&gt;lchild == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;                            <span class="comment">//道理同上</span></span><br><span class="line">        q = (*p);</span><br><span class="line">        (*p) = (*p)-&gt;rchild;</span><br><span class="line">        <span class="built_in">free</span>(q);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;<span class="comment">//若当前欲删除结点既有左子树又有右子树，则取此树中序遍历最接近欲删除结点的那个前驱(后继)结点作为新的树根结点</span></span><br><span class="line">        q = (*p);                <span class="comment">//将当前欲删除结点赋给q</span></span><br><span class="line">        s = (*p)-&gt;lchild;        <span class="comment">//s是当前欲删除结点的左孩子，</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> (s-&gt;rchild)</span><br><span class="line">        &#123;        <span class="comment">//此处循环为了寻找欲删除结点左孩子的最右孩子，即欲删除结点的中序遍历前驱节点</span></span><br><span class="line">            q = s;                <span class="comment">//如果s有右孩子，则将s赋给q，s则替换为其右孩子，即q是s的父结点</span></span><br><span class="line">            s = s-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        (*p)-&gt;data = s-&gt;data;    <span class="comment">//经过上述操作，s就是欲删除结点的中序遍历前驱结点，我们不是直接删除*p结点，而是</span></span><br><span class="line">                                <span class="comment">//将s的值赋给欲删除结点*p，然后删除s结点就可以达到调整的目的</span></span><br><span class="line">        <span class="keyword">if</span> (q != (*p))</span><br><span class="line">        &#123;    <span class="comment">//若q不等于*p，说明q在while循环中被改变了，即s被替换为了其最右孩子</span></span><br><span class="line">            q-&gt;rchild = s-&gt;lchild;<span class="comment">//删除s结点后，不保证s不含左孩子，故将其s的左孩子赋给父节点q的右孩子</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;        <span class="comment">//若q等于*p，说明while循环体里的代码没有执行，即s不含右孩子，此时</span></span><br><span class="line">            q-&gt;lchild = s-&gt;lchild;<span class="comment">//删除s结点后，应该把s的左孩子赋给q的左孩子，不然就缺胳膊短腿了</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">free</span>(s);        <span class="comment">//由于*p的值已被替换，结构也已调整完成，释放s结点占用内存</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//关键字查找函数，与二叉搜索树的查询函数一致，不再赘述，</span></span><br><span class="line"><span class="comment">//若有疑问请参考二叉搜索树(BST) ---- C语言</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SearchAVL</span><span class="params">(AVLTree T, <span class="keyword">int</span> key, AVLTree f, AVLTree *p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!T)</span><br><span class="line">    &#123;</span><br><span class="line">        (*p) = f;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (key == T-&gt;data)</span><br><span class="line">        &#123;</span><br><span class="line">            (*p) = T;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (key &lt; T-&gt;data)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> SearchAVL(T-&gt;lchild, key, T, p);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> SearchAVL(T-&gt;rchild, key, T, p);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//树的中序遍历函数(递归)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InOrderView</span><span class="params">(AVLTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!T)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    InOrderView(T-&gt;lchild);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d--&quot;</span>, T-&gt;data);</span><br><span class="line">    InOrderView(T-&gt;rchild);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, taller, lower;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">10</span>] = &#123;<span class="number">33</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">58</span>, <span class="number">99</span>,</span><br><span class="line">                <span class="number">40</span>, <span class="number">67</span>, <span class="number">55</span>, <span class="number">1</span>, <span class="number">120</span>&#125;;</span><br><span class="line">    AVLTree p, T = <span class="literal">NULL</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        InsertAVL(&amp;T, a[i], &amp;taller);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    InOrderView(T);</span><br><span class="line">    </span><br><span class="line">    SearchAVL(T, <span class="number">55</span>, <span class="literal">NULL</span>, &amp;p);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nSearch--p: %d&quot;</span>, p-&gt;data);</span><br><span class="line">    </span><br><span class="line">    DeleteAVL(&amp;T, <span class="number">55</span>, &amp;lower);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    InOrderView(T);</span><br><span class="line">    </span><br><span class="line">    SearchAVL(T, <span class="number">55</span>, <span class="literal">NULL</span>, &amp;p);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\nSearch--p: %d&quot;</span>, p-&gt;data);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果是</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>-<span class="number">-4</span>-<span class="number">-12</span>-<span class="number">-33</span>-<span class="number">-40</span>-<span class="number">-55</span>-<span class="number">-58</span>-<span class="number">-67</span>-<span class="number">-99</span>-<span class="number">-120</span>--</span><br><span class="line">Search--p: <span class="number">55</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>-<span class="number">-4</span>-<span class="number">-12</span>-<span class="number">-33</span>-<span class="number">-40</span>-<span class="number">-58</span>-<span class="number">-67</span>-<span class="number">-99</span>-<span class="number">-120</span>--</span><br><span class="line">Search--p: <span class="number">40</span></span><br></pre></td></tr></table></figure>

<h1 id="三-2-3-树"><a href="#三-2-3-树" class="headerlink" title="三. 2-3 树"></a>三. 2-3 树</h1><h2 id="A-简介-2"><a href="#A-简介-2" class="headerlink" title="(A) 简介"></a>(A) 简介</h2><p>2-3 树是最简单的 B 树结构，其每个非叶结点都有两个或三个子女，而且所有叶都在同一层上。2-3 树不是二叉树，其结点可拥有三个孩子。<br>例如，下图是高度为 3 的 2-3 树。包含两个孩子的结点称为 2-结点，包含三个孩子的结点称为 3-结点。<br><img src="https://mwchen.oss-cn-hangzhou.aliyuncs.com/Blog/A2507.jpg"></p>
<h2 id="B-代码思路"><a href="#B-代码思路" class="headerlink" title="(B) 代码思路"></a>(B) 代码思路</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;memory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NUM(p)  ((p==NULL)?0:p-&gt;num)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> num; <span class="comment">//1,2,3</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">left_child</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">mid_child</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">right_child</span>;</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">tmp_child</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">parent</span>;</span></span><br><span class="line">&#125; Btree, *BtreePtr;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exchange</span><span class="params">(<span class="keyword">int</span> *a, <span class="keyword">int</span> *b)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp = *a;</span><br><span class="line">    *a = *b;</span><br><span class="line">    *b = tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BtreePtr _node(<span class="keyword">const</span> <span class="keyword">int</span> key) </span><br><span class="line">&#123;</span><br><span class="line">    BtreePtr p = (BtreePtr)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Btree));</span><br><span class="line">    <span class="keyword">if</span> (p != <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(p, <span class="number">0</span>, <span class="keyword">sizeof</span>(p));</span><br><span class="line">        p-&gt;a[<span class="number">0</span>] = key;</span><br><span class="line">        p-&gt;num = <span class="number">1</span>;</span><br><span class="line">        p-&gt;left_child = <span class="literal">NULL</span>;</span><br><span class="line">        p-&gt;right_child = <span class="literal">NULL</span>;</span><br><span class="line">        p-&gt;mid_child = <span class="literal">NULL</span>;</span><br><span class="line">        p-&gt;tmp_child = <span class="literal">NULL</span>;</span><br><span class="line">        p-&gt;parent = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;内存不足&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> _sort(BtreePtr b) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> length = b-&gt;num;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; length; j++) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> ((b-&gt;a[j]) &lt; (b-&gt;a[i]))</span><br><span class="line">            &#123;</span><br><span class="line">                exchange(&amp;(b-&gt;a[j]), &amp;(b-&gt;a[i]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BtreePtr _checkNum(BtreePtr p) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (NUM(p) == <span class="number">1</span>) </span><br><span class="line">    &#123;  <span class="comment">//2-结点</span></span><br><span class="line">        <span class="keyword">if</span> (NUM(p-&gt;left_child) == <span class="number">3</span>) </span><br><span class="line">        &#123;  <span class="comment">//case 2</span></span><br><span class="line">            p-&gt;a[<span class="number">1</span>] = p-&gt;left_child-&gt;a[<span class="number">1</span>];</span><br><span class="line">            p-&gt;num++;</span><br><span class="line">            _sort(p);</span><br><span class="line"></span><br><span class="line">            BtreePtr l = _node(p-&gt;left_child-&gt;a[<span class="number">0</span>]);</span><br><span class="line">            l-&gt;left_child = p-&gt;left_child-&gt;left_child;</span><br><span class="line">            l-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            BtreePtr r = _node(p-&gt;left_child-&gt;a[<span class="number">2</span>]);</span><br><span class="line">            r-&gt;left_child = p-&gt;left_child-&gt;mid_child;</span><br><span class="line">            r-&gt;right_child = p-&gt;left_child-&gt;right_child;</span><br><span class="line">            r-&gt;parent = p;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            p-&gt;left_child = l;</span><br><span class="line">            p-&gt;mid_child = r;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (NUM(p-&gt;right_child) == <span class="number">3</span>) </span><br><span class="line">        &#123;  <span class="comment">//case 3</span></span><br><span class="line">            p-&gt;a[<span class="number">1</span>] = p-&gt;right_child-&gt;a[<span class="number">1</span>];</span><br><span class="line">            p-&gt;num++;</span><br><span class="line">            _sort(p);</span><br><span class="line"></span><br><span class="line">            BtreePtr l = _node(p-&gt;right_child-&gt;a[<span class="number">0</span>]);</span><br><span class="line">            l-&gt;left_child = p-&gt;right_child-&gt;left_child;</span><br><span class="line">            l-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            BtreePtr r = _node(p-&gt;right_child-&gt;a[<span class="number">2</span>]);</span><br><span class="line">            r-&gt;left_child = p-&gt;right_child-&gt;mid_child;</span><br><span class="line">            r-&gt;right_child = p-&gt;right_child-&gt;right_child;</span><br><span class="line">            r-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            p-&gt;mid_child = l;</span><br><span class="line">            p-&gt;right_child = r;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (NUM(p) == <span class="number">2</span>) </span><br><span class="line">    &#123;  <span class="comment">//3-结点</span></span><br><span class="line">        <span class="keyword">if</span> (NUM(p-&gt;left_child) == <span class="number">3</span>) </span><br><span class="line">        &#123;  <span class="comment">//case 4</span></span><br><span class="line">            p-&gt;a[<span class="number">2</span>] = p-&gt;left_child-&gt;a[<span class="number">1</span>];</span><br><span class="line">            p-&gt;num++;</span><br><span class="line">            _sort(p);</span><br><span class="line"></span><br><span class="line">            p-&gt;tmp_child = p-&gt;mid_child;</span><br><span class="line">            p-&gt;mid_child = _node(p-&gt;left_child-&gt;a[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">            BtreePtr l = _node(p-&gt;left_child-&gt;a[<span class="number">0</span>]);</span><br><span class="line">            l-&gt;left_child = p-&gt;left_child-&gt;left_child;</span><br><span class="line">            l-&gt;right_child = p-&gt;left_child-&gt;mid_child;</span><br><span class="line">            l-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            BtreePtr r = _node(p-&gt;left_child-&gt;a[<span class="number">2</span>]);</span><br><span class="line">            r-&gt;left_child = p-&gt;left_child-&gt;tmp_child;</span><br><span class="line">            r-&gt;right_child = p-&gt;left_child-&gt;right_child;</span><br><span class="line">            r-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            p-&gt;left_child = l;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (NUM(p-&gt;right_child) == <span class="number">3</span>)</span><br><span class="line">        &#123;  <span class="comment">//case 5</span></span><br><span class="line">            p-&gt;a[<span class="number">2</span>] = p-&gt;right_child-&gt;a[<span class="number">1</span>];</span><br><span class="line">            p-&gt;num++;</span><br><span class="line">            _sort(p);</span><br><span class="line"></span><br><span class="line">            p-&gt;tmp_child = _node(p-&gt;right_child-&gt;a[<span class="number">2</span>]); <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">            BtreePtr l = _node(p-&gt;right_child-&gt;a[<span class="number">0</span>]);</span><br><span class="line">            l-&gt;right_child = p-&gt;right_child-&gt;left_child;</span><br><span class="line">            l-&gt;right_child = p-&gt;right_child-&gt;mid_child;</span><br><span class="line">            l-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            BtreePtr r = _node(p-&gt;right_child-&gt;a[<span class="number">2</span>]);</span><br><span class="line">            r-&gt;right_child = p-&gt;right_child-&gt;tmp_child;</span><br><span class="line">            r-&gt;right_child = p-&gt;right_child-&gt;right_child;</span><br><span class="line">            r-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            p-&gt;right_child = l;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (NUM(p-&gt;mid_child) == <span class="number">3</span>) </span><br><span class="line">        &#123;</span><br><span class="line">            p-&gt;a[<span class="number">2</span>] = p-&gt;mid_child-&gt;a[<span class="number">1</span>];</span><br><span class="line">            p-&gt;num++;</span><br><span class="line">            _sort(p);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//p-&gt;tmp_child = p-&gt;mid_child;</span></span><br><span class="line">            <span class="comment">//p-&gt;mid_child = _node(p-&gt;left_child-&gt;a[2]);</span></span><br><span class="line"></span><br><span class="line">            BtreePtr l = _node(p-&gt;mid_child-&gt;a[<span class="number">0</span>]);</span><br><span class="line">            l-&gt;left_child = p-&gt;mid_child-&gt;left_child;</span><br><span class="line">            l-&gt;right_child = p-&gt;mid_child-&gt;mid_child;</span><br><span class="line">            l-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            BtreePtr r = _node(p-&gt;mid_child-&gt;a[<span class="number">2</span>]);</span><br><span class="line">            r-&gt;left_child = p-&gt;mid_child-&gt;tmp_child;</span><br><span class="line">            r-&gt;right_child = p-&gt;mid_child-&gt;right_child;</span><br><span class="line">            r-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            p-&gt;mid_child = l;</span><br><span class="line">            p-&gt;tmp_child = r;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;num == <span class="number">3</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;parent == <span class="literal">NULL</span>) </span><br><span class="line">        &#123;  <span class="comment">// case 1;</span></span><br><span class="line">            BtreePtr t = p-&gt;left_child;</span><br><span class="line">            p-&gt;left_child = _node(p-&gt;a[<span class="number">0</span>]);</span><br><span class="line">            p-&gt;left_child-&gt;left_child = t;</span><br><span class="line">            p-&gt;left_child-&gt;right_child = p-&gt;mid_child;</span><br><span class="line">            p-&gt;left_child-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            t = p-&gt;right_child;</span><br><span class="line">            p-&gt;right_child = _node(p-&gt;a[<span class="number">2</span>]);</span><br><span class="line">            p-&gt;right_child-&gt;left_child = p-&gt;tmp_child;</span><br><span class="line">            p-&gt;right_child-&gt;right_child = t;</span><br><span class="line">            p-&gt;right_child-&gt;parent = p;</span><br><span class="line"></span><br><span class="line">            p-&gt;mid_child = <span class="literal">NULL</span>;</span><br><span class="line">            p-&gt;tmp_child = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">            p-&gt;a[<span class="number">0</span>] = p-&gt;a[<span class="number">1</span>];</span><br><span class="line">            p-&gt;num = p-&gt;num - <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BtreePtr _insertBTree(BtreePtr b, <span class="keyword">const</span> <span class="keyword">int</span> key, <span class="keyword">const</span> <span class="keyword">int</span> pos)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (b-&gt;left_child == <span class="literal">NULL</span> &amp;&amp; b-&gt;right_child == <span class="literal">NULL</span>) </span><br><span class="line">    &#123;  <span class="comment">//底节点</span></span><br><span class="line">        b-&gt;a[b-&gt;num] = key;</span><br><span class="line">        b-&gt;num++;</span><br><span class="line">        _sort(b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b-&gt;num == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (key &lt; b-&gt;a[<span class="number">0</span>]) </span><br><span class="line">            &#123; <span class="comment">//num =1, 2</span></span><br><span class="line">                b-&gt;left_child = _insertBTree(b-&gt;left_child, key, pos);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (key &gt; b-&gt;a[<span class="number">0</span>])</span><br><span class="line">            &#123; <span class="comment">//num = 2</span></span><br><span class="line">                b-&gt;right_child = _insertBTree(b-&gt;right_child, key, pos);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (b-&gt;num == <span class="number">2</span>) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (key &lt; b-&gt;a[<span class="number">0</span>]) </span><br><span class="line">            &#123; <span class="comment">//num =1, 2</span></span><br><span class="line">                b-&gt;left_child = _insertBTree(b-&gt;left_child, key, pos);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (key &gt; b-&gt;a[<span class="number">1</span>]) </span><br><span class="line">            &#123; <span class="comment">//num = 2</span></span><br><span class="line">                b-&gt;right_child = _insertBTree(b-&gt;right_child, key, pos);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                b-&gt;mid_child = _insertBTree(b-&gt;mid_child, key, pos);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    b = _checkNum(b);</span><br><span class="line">    <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">BtreePtr <span class="title">insertBTree</span><span class="params">(BtreePtr root, <span class="keyword">const</span> <span class="keyword">int</span> key, <span class="keyword">const</span> <span class="keyword">int</span> pos)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        root = _node(key);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        root = _insertBTree(root, key, pos);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">freeTree</span><span class="params">(BtreePtr p)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;left_child != <span class="literal">NULL</span>) </span><br><span class="line">    &#123;</span><br><span class="line">        freeTree(p-&gt;left_child);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;right_child != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        freeTree(p-&gt;right_child);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (p-&gt;mid_child != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        freeTree(p-&gt;mid_child);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    p = <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BTreeSearch</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> *a, <span class="keyword">const</span> <span class="keyword">int</span> length, <span class="keyword">const</span> <span class="keyword">int</span> key)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    BtreePtr root = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) </span><br><span class="line">    &#123;</span><br><span class="line">        root = insertBTree(root, a[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    freeTree(root);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> length = <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">int</span> my_array[<span class="number">8</span>] = &#123;<span class="number">7</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">13</span>&#125;;</span><br><span class="line">    BTreeSearch(my_array, length, <span class="number">7</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="四-B-树"><a href="#四-B-树" class="headerlink" title="四. B 树"></a>四. B 树</h1><h2 id="A-定义"><a href="#A-定义" class="headerlink" title="(A) 定义"></a>(A) 定义</h2><p>B 树是一种平衡的多路查找树。一棵 m 阶 B 树，或为空树，或为满足下列特性的 m 叉树。</p>
<ol>
<li>树中每个结点最多含有 m 棵子树；</li>
<li>若根结点不是叶子结点，则至少有两棵子树；</li>
<li>除根之外的所有非终端结点至少有 [m/2]；</li>
<li>每个非终端结点中包含信息：(n，A<sub>0</sub>，K<sub>1</sub>，A<sub>1</sub>，K<sub>2</sub>，A<sub>2</sub>，···，K<sub>n</sub>，A<sub>n</sub>)。其中<br>(1) K<sub>i</sub> (1&lt;=i&lt;=n) 为关键字，且关键字按升序排序；<br>(2) 指针 A<sub>i</sub> (0&lt;=i&lt;=n) 指向子树的根结点；<br>(3) 关键字的个数 n 必须满足：[m/2]&lt;=n&lt;=m-1。</li>
<li>所有的叶子结点都出现在同一层次上，并且不带信息(可以看作是外部结点或查找失败的结点，实际上这些结点不存在，指向这些结点的指针为空)。</li>
</ol>
<h2 id="B-代码"><a href="#B-代码" class="headerlink" title="(B) 代码"></a>(B) 代码</h2><h3 id="a-头文件"><a href="#a-头文件" class="headerlink" title="(a) 头文件"></a>(a) 头文件</h3><p>定义了需要用到的数据类型，结构体类型，以及所有函数接口。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//==========ADT BTree的表示与实现==========</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _BTREE_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _BTREE_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 10                 <span class="comment">//定义B树的最大的阶数</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> m=<span class="number">4</span>;                      <span class="comment">//设定B树的阶数 </span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Max=m<span class="number">-1</span>;                  <span class="comment">//结点的最大关键字数量 </span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Min=(m<span class="number">-1</span>)/<span class="number">2</span>;              <span class="comment">//结点的最小关键字数量 </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> KeyType;                <span class="comment">//KeyType为关键字类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//===============B树存储结构==============</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span>                <span class="comment">//B树和B树结点类型 </span></span><br><span class="line">    <span class="keyword">int</span> keynum;                 <span class="comment">//结点关键字个数</span></span><br><span class="line">    KeyType key[MAXM];              <span class="comment">//关键字数组，key[0]不使用 </span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">parent</span>;</span>            <span class="comment">//双亲结点指针</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">ptr</span>[<span class="title">MAXM</span>];</span>         <span class="comment">//孩子结点指针数组 </span></span><br><span class="line">&#125;BTNode,*BTree;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span>                     <span class="comment">//B树查找结果类型 </span></span><br><span class="line">    BTNode *pt;                 <span class="comment">//指向找到的结点</span></span><br><span class="line">    <span class="keyword">int</span> i;                          <span class="comment">//在结点中的关键字位置; </span></span><br><span class="line">    <span class="keyword">int</span> tag;                        <span class="comment">//查找成功与否标志</span></span><br><span class="line">&#125;Result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span>&#123;</span>               <span class="comment">//链表和链表结点类型 </span></span><br><span class="line">    BTree data;                     <span class="comment">//数据域</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> *<span class="title">next</span>;</span>             <span class="comment">//指针域</span></span><br><span class="line">&#125;LNode, *LinkList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span> status&#123;               <span class="comment">//枚举类型（依次递增） </span></span><br><span class="line">    TRUE,</span><br><span class="line">    FALSE,</span><br><span class="line">    OK,</span><br><span class="line">    ERROR,</span><br><span class="line">    OVERFLOW,</span><br><span class="line">    EMPTY</span><br><span class="line">&#125;Status;</span><br><span class="line"></span><br><span class="line"><span class="comment">//============基本操作的函数原型声明=============</span></span><br><span class="line"><span class="function">Status <span class="title">InitBTree</span><span class="params">(BTree &amp;t)</span></span>;</span><br><span class="line"><span class="comment">//初始化B树 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SearchBTNode</span><span class="params">(BTNode *p,KeyType k)</span></span>;                          </span><br><span class="line"><span class="comment">//在结点p中查找关键字k的插入位置i</span></span><br><span class="line"><span class="function">Result <span class="title">SearchBTree</span><span class="params">(BTree t,KeyType k)</span></span>;                          </span><br><span class="line"><span class="comment">/*在树t上查找关键字k,返回结果(pt,i,tag)。若查找成功,则特征值</span></span><br><span class="line"><span class="comment">tag=1,关键字k是指针pt所指结点中第i个关键字；否则特征值tag=0,</span></span><br><span class="line"><span class="comment">关键字k的插入位置为pt结点的第i个*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertBTNode</span><span class="params">(BTNode *&amp;p,<span class="keyword">int</span> i,KeyType k,BTNode *q)</span></span>;        </span><br><span class="line"><span class="comment">//将关键字k和结点q分别插入到p-&gt;key[i+1]和p-&gt;ptr[i+1]中</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SplitBTNode</span><span class="params">(BTNode *&amp;p,BTNode *&amp;q)</span></span>;                        </span><br><span class="line"><span class="comment">//将结点p分裂成两个结点,前一半保留,后一半移入结点q</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NewRoot</span><span class="params">(BTNode *&amp;t,KeyType k,BTNode *p,BTNode *q)</span></span>;         </span><br><span class="line"><span class="comment">//生成新的根结点t,原结点p和结点q为子树指针</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertBTree</span><span class="params">(BTree &amp;t,<span class="keyword">int</span> i,KeyType k,BTNode *p)</span></span>;           </span><br><span class="line"><span class="comment">/*在树t上结点q的key[i]与key[i+1]之间插入关键字k。若引起</span></span><br><span class="line"><span class="comment">结点过大,则沿双亲链进行必要的结点分裂调整,使t仍是B树*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Remove</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>;                                   </span><br><span class="line"><span class="comment">//从p结点删除key[i]和它的孩子指针ptr[i]</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Substitution</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>;                             </span><br><span class="line"><span class="comment">//查找被删关键字p-&gt;key[i](在非叶子结点中)的替代叶子结点(右子树中值最小的关键字) </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MoveRight</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>;                               </span><br><span class="line"><span class="comment">/*将双亲结点p中的最后一个关键字移入右结点q中</span></span><br><span class="line"><span class="comment">将左结点aq中的最后一个关键字移入双亲结点p中*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MoveLeft</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>;</span><br><span class="line"><span class="comment">/*将双亲结点p中的第一个关键字移入结点aq中，</span></span><br><span class="line"><span class="comment">将结点q中的第一个关键字移入双亲结点p中*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Combine</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>;                                  </span><br><span class="line"><span class="comment">/*将双亲结点p、右结点q合并入左结点aq，</span></span><br><span class="line"><span class="comment">并调整双亲结点p中的剩余关键字的位置*/</span>                                         </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AdjustBTree</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>;                              </span><br><span class="line"><span class="comment">//删除结点p中的第i个关键字后,调整B树                                        </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">FindBTNode</span><span class="params">(BTNode *p,KeyType k,<span class="keyword">int</span> &amp;i)</span></span>;                     </span><br><span class="line"><span class="comment">//反映是否在结点p中是否查找到关键字k </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BTNodeDelete</span><span class="params">(BTNode *p,KeyType k)</span></span>;                          </span><br><span class="line"><span class="comment">//在结点p中查找并删除关键字k</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BTreeDelete</span><span class="params">(BTree &amp;t,KeyType k)</span></span>;                           </span><br><span class="line"><span class="comment">//构建删除框架，执行删除操作 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DestroyBTree</span><span class="params">(BTree &amp;t)</span></span>;                                    </span><br><span class="line"><span class="comment">//递归释放B树</span></span><br><span class="line"><span class="function">Status <span class="title">InitQueue</span><span class="params">(LinkList &amp;L)</span></span>;                                  </span><br><span class="line"><span class="comment">//初始化队列 </span></span><br><span class="line"><span class="function">LNode* <span class="title">CreateNode</span><span class="params">(BTree t)</span></span>;                                     </span><br><span class="line"><span class="comment">//新建一个结点 </span></span><br><span class="line"><span class="function">Status <span class="title">Enqueue</span><span class="params">(LNode *p,BTree t)</span></span>;                               </span><br><span class="line"><span class="comment">//元素q入队列</span></span><br><span class="line"><span class="function">Status <span class="title">Dequeue</span><span class="params">(LNode *p,BTNode *&amp;q)</span></span>;                            </span><br><span class="line"><span class="comment">//出队列，并以q返回值</span></span><br><span class="line"><span class="function">Status <span class="title">IfEmpty</span><span class="params">(LinkList L)</span></span>;                                     </span><br><span class="line"><span class="comment">//队列判空 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DestroyQueue</span><span class="params">(LinkList L)</span></span>;                                  </span><br><span class="line"><span class="comment">//销毁队列 </span></span><br><span class="line"><span class="function">Status <span class="title">Traverse</span><span class="params">(BTree t,LinkList L,<span class="keyword">int</span> newline,<span class="keyword">int</span> sum)</span></span>;        </span><br><span class="line"><span class="comment">//用队列遍历输出B树 </span></span><br><span class="line"><span class="function">Status <span class="title">PrintBTree</span><span class="params">(BTree t)</span></span>;                                     </span><br><span class="line"><span class="comment">//输出B树 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test</span><span class="params">()</span></span>;                                                    </span><br><span class="line"><span class="comment">//测试B树功能函数 </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<h3 id="b-B-树具体接口实现"><a href="#b-B-树具体接口实现" class="headerlink" title="(b) B 树具体接口实现"></a>(b) B 树具体接口实现</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2.4</span><span class="number">.1</span>InitBTree函数</span><br><span class="line">功能:初始化B树</span><br><span class="line">代码实现:</span><br><span class="line"><span class="function">Status <span class="title">InitBTree</span><span class="params">(BTree &amp;t)</span></span>&#123;</span><br><span class="line">    t=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.2</span>SearchBTNode函数</span><br><span class="line">功能：在结点p中查找关键字k的插入位置i</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">SearchBTNode</span><span class="params">(BTNode *p,KeyType k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;p-&gt;keynum&amp;&amp;p-&gt;key[i+<span class="number">1</span>]&lt;=k;i++);</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.3</span>SearchBTree函数</span><br><span class="line">功能：在树t中查找关键字k，返回查找结果类型</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function">Result <span class="title">SearchBTree</span><span class="params">(BTree t,KeyType k)</span></span>&#123;</span><br><span class="line">    BTNode *p=t,*q=<span class="literal">NULL</span>;                 <span class="comment">//初始化结点p和结点q,p指向待查结点,q指向p的双亲</span></span><br><span class="line">    <span class="keyword">int</span> found_tag=<span class="number">0</span>;                     <span class="comment">//设定查找成功与否标志 </span></span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;                 </span><br><span class="line">    Result r;                            <span class="comment">//设定返回的查找结果 </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(p!=<span class="literal">NULL</span>&amp;&amp;found_tag==<span class="number">0</span>)&#123;</span><br><span class="line">        i=SearchBTNode(p,k);            <span class="comment">//在结点p中查找关键字k if(i&gt;0&amp;&amp;p-&gt;key[i]==k)                                                 //找到待查关键字</span></span><br><span class="line">            found_tag=<span class="number">1</span>;                <span class="comment">//查找成功 </span></span><br><span class="line">        <span class="keyword">else</span>&#123;                           <span class="comment">//查找失败 </span></span><br><span class="line">            q=p;                            </span><br><span class="line">            p=p-&gt;ptr[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(found_tag==<span class="number">1</span>)&#123;                   <span class="comment">//查找成功</span></span><br><span class="line">        r.pt=p;</span><br><span class="line">        r.i=i;</span><br><span class="line">        r.tag=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;                               <span class="comment">//查找失败</span></span><br><span class="line">        r.pt=q;</span><br><span class="line">        r.i=i;</span><br><span class="line">        r.tag=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r;                          <span class="comment">//返回关键字k的位置(或插入位置)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.4</span>InsertBTNode函数</span><br><span class="line">功能：关键字k和结点q分别插入到p-&gt;key[i+<span class="number">1</span>]和p-&gt;ptr[i+<span class="number">1</span>]中</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertBTNode</span><span class="params">(BTNode *&amp;p,<span class="keyword">int</span> i,KeyType k,BTNode *q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">for</span>(j=p-&gt;keynum;j&gt;i;j--)&#123;          <span class="comment">//整体后移空出一个位置</span></span><br><span class="line">        p-&gt;key[j+<span class="number">1</span>]=p-&gt;key[j];</span><br><span class="line">        p-&gt;ptr[j+<span class="number">1</span>]=p-&gt;ptr[j];</span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;key[i+<span class="number">1</span>]=k;</span><br><span class="line">    p-&gt;ptr[i+<span class="number">1</span>]=q;</span><br><span class="line">    <span class="keyword">if</span>(q!=<span class="literal">NULL</span>) </span><br><span class="line">        q-&gt;parent=p;</span><br><span class="line">    p-&gt;keynum++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.5</span>SplitBTNode函数</span><br><span class="line">功能：将结点p分裂成两个结点,前一半保留,后一半移入结点q</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SplitBTNode</span><span class="params">(BTNode *&amp;p,BTNode *&amp;q)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> s=(m+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">    q=(BTNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(BTNode));    <span class="comment">//给结点q分配空间</span></span><br><span class="line"></span><br><span class="line">    q-&gt;ptr[<span class="number">0</span>]=p-&gt;ptr[s];                   <span class="comment">//后一半移入结点q</span></span><br><span class="line">    <span class="keyword">for</span>(i=s+<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">        q-&gt;key[i-s]=p-&gt;key[i];</span><br><span class="line">        q-&gt;ptr[i-s]=p-&gt;ptr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    q-&gt;keynum=p-&gt;keynum-s;                </span><br><span class="line">    q-&gt;parent=p-&gt;parent;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=p-&gt;keynum-s;i++)            <span class="comment">//修改双亲指针 </span></span><br><span class="line">        <span class="keyword">if</span>(q-&gt;ptr[i]!=<span class="literal">NULL</span>) </span><br><span class="line">            q-&gt;ptr[i]-&gt;parent=q;</span><br><span class="line">    p-&gt;keynum=s<span class="number">-1</span>;                         <span class="comment">//结点p的前一半保留,修改结点p的keynum</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.6</span>NewRoot函数</span><br><span class="line">功能：生成新的根结点t,原p和q为子树指针</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NewRoot</span><span class="params">(BTNode *&amp;t,KeyType k,BTNode *p,BTNode *q)</span></span>&#123;</span><br><span class="line">    t=(BTNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(BTNode));     <span class="comment">//分配空间 </span></span><br><span class="line">    t-&gt;keynum=<span class="number">1</span>;</span><br><span class="line">    t-&gt;ptr[<span class="number">0</span>]=p;</span><br><span class="line">    t-&gt;ptr[<span class="number">1</span>]=q;</span><br><span class="line">    t-&gt;key[<span class="number">1</span>]=k;</span><br><span class="line">    <span class="keyword">if</span>(p!=<span class="literal">NULL</span>)                              <span class="comment">//调整结点p和q的双亲指针 </span></span><br><span class="line">        p-&gt;parent=t;</span><br><span class="line">    <span class="keyword">if</span>(q!=<span class="literal">NULL</span>) </span><br><span class="line">        q-&gt;parent=t;</span><br><span class="line">    t-&gt;parent=<span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.7</span>InsertBTree函数</span><br><span class="line">功能：在树t中插入关键字k，返回插入结果</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertBTree</span><span class="params">(BTree &amp;t,<span class="keyword">int</span> i,KeyType k,BTNode *p)</span></span>&#123;</span><br><span class="line">    BTNode *q;</span><br><span class="line">    <span class="keyword">int</span> finish_tag,newroot_tag,s;              <span class="comment">//设定需要新结点标志和插入完成标志 </span></span><br><span class="line">    KeyType x;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="literal">NULL</span>)                                <span class="comment">//t是空树</span></span><br><span class="line">        NewRoot(t,k,<span class="literal">NULL</span>,<span class="literal">NULL</span>);                <span class="comment">//生成仅含关键字k的根结点t</span></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        x=k;</span><br><span class="line">        q=<span class="literal">NULL</span>;</span><br><span class="line">        finish_tag=<span class="number">0</span>;       </span><br><span class="line">        newroot_tag=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(finish_tag==<span class="number">0</span>&amp;&amp;newroot_tag==<span class="number">0</span>)&#123;</span><br><span class="line">            InsertBTNode(p,i,x,q);   <span class="comment">//将关键字x和结点q分别插入到p-&gt;key[i+1]和p-&gt;ptr[i+1]</span></span><br><span class="line">            <span class="keyword">if</span> (p-&gt;keynum&lt;=Max) </span><br><span class="line">                finish_tag=<span class="number">1</span>;                   <span class="comment">//插入完成</span></span><br><span class="line">            <span class="keyword">else</span>&#123;         </span><br><span class="line">                s=(m+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">                SplitBTNode(p,q);               <span class="comment">//分裂结点 </span></span><br><span class="line">                x=p-&gt;key[s];</span><br><span class="line">                <span class="keyword">if</span>(p-&gt;parent)&#123;                  <span class="comment">//查找x的插入位置</span></span><br><span class="line">                    p=p-&gt;parent;</span><br><span class="line">                    i=SearchBTNode(p, x);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>                            <span class="comment">//没找到x，需要新结点 </span></span><br><span class="line">                    newroot_tag=<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(newroot_tag==<span class="number">1</span>)                      <span class="comment">//根结点已分裂为结点p和q </span></span><br><span class="line">            NewRoot(t,x,p,q);                   <span class="comment">//生成新根结点t,p和q为子树指针</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.8</span>Remove函数</span><br><span class="line">功能：从p结点删除key[i]和它的孩子指针ptr[i]</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Remove</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;=p-&gt;keynum;j++)&#123;                <span class="comment">//前移删除key[i]和ptr[i]</span></span><br><span class="line">        p-&gt;key[j<span class="number">-1</span>]=p-&gt;key[j];</span><br><span class="line">        p-&gt;ptr[j<span class="number">-1</span>]=p-&gt;ptr[j];</span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;keynum--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.9</span>Substitution函数</span><br><span class="line">功能：寻找替代值（右子树中最小的关键字）</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Substitution</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    BTNode *q;</span><br><span class="line">    <span class="keyword">for</span>(q=p-&gt;ptr[i];q-&gt;ptr[<span class="number">0</span>]!=<span class="literal">NULL</span>;q=q-&gt;ptr[<span class="number">0</span>]);</span><br><span class="line">    p-&gt;key[i]=q-&gt;key[<span class="number">1</span>];                        <span class="comment">//复制关键字值</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.10</span>MoveRight函数</span><br><span class="line">功能：双亲结点p中的最后一个关键字移入右结点q中</span><br><span class="line">将左结点aq中的最后一个关键字移入双亲结点p中</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MoveRight</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>&#123;    </span><br><span class="line"><span class="keyword">int</span> j;</span><br><span class="line">    BTNode *q=p-&gt;ptr[i];</span><br><span class="line">    BTNode *aq=p-&gt;ptr[i<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(j=q-&gt;keynum;j&gt;<span class="number">0</span>;j--)&#123;                  <span class="comment">//将右兄弟q中所有关键字向后移动一位</span></span><br><span class="line">        q-&gt;key[j+<span class="number">1</span>]=q-&gt;key[j];</span><br><span class="line">        q-&gt;ptr[j+<span class="number">1</span>]=q-&gt;ptr[j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    q-&gt;ptr[<span class="number">1</span>]=q-&gt;ptr[<span class="number">0</span>];                       <span class="comment">//从双亲结点p移动关键字到右兄弟q中</span></span><br><span class="line">    q-&gt;key[<span class="number">1</span>]=p-&gt;key[i];</span><br><span class="line">    q-&gt;keynum++;</span><br><span class="line"></span><br><span class="line">    p-&gt;key[i]=aq-&gt;key[aq-&gt;keynum];             <span class="comment">//将左兄弟aq中最后一个关键字移动到双亲结点p中</span></span><br><span class="line">    p-&gt;ptr[i]-&gt;ptr[<span class="number">0</span>]=aq-&gt;ptr[aq-&gt;keynum];</span><br><span class="line">    aq-&gt;keynum--;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.11</span>MoveLeft函数</span><br><span class="line">功能：将双亲结点p中的第一个关键字移入左结点aq中，</span><br><span class="line">将右结点q中的第一个关键字移入双亲结点p中</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MoveLeft</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>&#123; </span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    BTNode *aq=p-&gt;ptr[i<span class="number">-1</span>];</span><br><span class="line">    BTNode *q=p-&gt;ptr[i];</span><br><span class="line"></span><br><span class="line">    aq-&gt;keynum++;                               <span class="comment">//把双亲结点p中的关键字移动到左兄弟aq中</span></span><br><span class="line">    aq-&gt;key[aq-&gt;keynum]=p-&gt;key[i]; </span><br><span class="line">    aq-&gt;ptr[aq-&gt;keynum]=p-&gt;ptr[i]-&gt;ptr[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    p-&gt;key[i]=q-&gt;key[<span class="number">1</span>];                        <span class="comment">//把右兄弟q中的关键字移动到双亲节点p中</span></span><br><span class="line">    q-&gt;ptr[<span class="number">0</span>]=q-&gt;ptr[<span class="number">1</span>];</span><br><span class="line">    q-&gt;keynum--;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=aq-&gt;keynum;j++)&#123;                 <span class="comment">//将右兄弟q中所有关键字向前移动一位</span></span><br><span class="line">        aq-&gt;key[j]=aq-&gt;key[j+<span class="number">1</span>];</span><br><span class="line">        aq-&gt;ptr[j]=aq-&gt;ptr[j+<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.12</span>Combine函数</span><br><span class="line">功能：双亲结点p、右结点q合并入左结点aq，</span><br><span class="line">并调整双亲结点p中的剩余关键字的位置</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Combine</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    BTNode *q=p-&gt;ptr[i];                            </span><br><span class="line">    BTNode *aq=p-&gt;ptr[i<span class="number">-1</span>];</span><br><span class="line"></span><br><span class="line">    aq-&gt;keynum++;                          <span class="comment">//将双亲结点的关键字p-&gt;key[i]插入到左结点aq     </span></span><br><span class="line">    aq-&gt;key[aq-&gt;keynum]=p-&gt;key[i];</span><br><span class="line">    aq-&gt;ptr[aq-&gt;keynum]=q-&gt;ptr[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=q-&gt;keynum;j++)&#123;             <span class="comment">//将右结点q中的所有关键字插入到左结点aq </span></span><br><span class="line">        aq-&gt;keynum++;</span><br><span class="line">        aq-&gt;key[aq-&gt;keynum]=q-&gt;key[j];</span><br><span class="line">        aq-&gt;ptr[aq-&gt;keynum]=q-&gt;ptr[j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(j=i;j&lt;p-&gt;keynum;j++)&#123;              <span class="comment">//将双亲结点p中的p-&gt;key[i]后的所有关键字向前移动一位 </span></span><br><span class="line">        p-&gt;key[j]=p-&gt;key[j+<span class="number">1</span>];</span><br><span class="line">        p-&gt;ptr[j]=p-&gt;ptr[j+<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;keynum--;                           <span class="comment">//修改双亲结点p的keynum值 </span></span><br><span class="line">    <span class="built_in">free</span>(q);                               <span class="comment">//释放空右结点q的空间</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.13</span>AdjustBTree函数</span><br><span class="line">功能：删除结点p中的第i个关键字后,调整B树</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AdjustBTree</span><span class="params">(BTNode *p,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i==<span class="number">0</span>)                                <span class="comment">//删除的是最左边关键字</span></span><br><span class="line">        <span class="keyword">if</span>(p-&gt;ptr[<span class="number">1</span>]-&gt;keynum&gt;Min)           <span class="comment">//右结点可以借</span></span><br><span class="line">            MoveLeft(p,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span>                                <span class="comment">//右兄弟不够借 </span></span><br><span class="line">            Combine(p,<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(i==p-&gt;keynum)                   <span class="comment">//删除的是最右边关键字</span></span><br><span class="line">        <span class="keyword">if</span>(p-&gt;ptr[i<span class="number">-1</span>]-&gt;keynum&gt;Min)         <span class="comment">//左结点可以借 </span></span><br><span class="line">            MoveRight(p,i);</span><br><span class="line">        <span class="keyword">else</span>                                <span class="comment">//左结点不够借 </span></span><br><span class="line">            Combine(p,i);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;ptr[i<span class="number">-1</span>]-&gt;keynum&gt;Min)        <span class="comment">//删除关键字在中部且左结点够借 </span></span><br><span class="line">        MoveRight(p,i);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;ptr[i+<span class="number">1</span>]-&gt;keynum&gt;Min)        <span class="comment">//删除关键字在中部且右结点够借 </span></span><br><span class="line">        MoveLeft(p,i+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span>                                    <span class="comment">//删除关键字在中部且左右结点都不够借</span></span><br><span class="line">        Combine(p,i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.14B</span>TNodeDelete函数</span><br><span class="line">功能：在结点p中查找并删除关键字k</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BTNodeDelete</span><span class="params">(BTNode *p,KeyType k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> found_tag;                                  <span class="comment">//查找标志 </span></span><br><span class="line">    <span class="keyword">if</span>(p==<span class="literal">NULL</span>)                                     </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        found_tag=FindBTNode(p,k,i);                <span class="comment">//返回查找结果 </span></span><br><span class="line">        <span class="keyword">if</span>(found_tag==<span class="number">1</span>)&#123;                           <span class="comment">//查找成功 </span></span><br><span class="line">            <span class="keyword">if</span>(p-&gt;ptr[i<span class="number">-1</span>]!=<span class="literal">NULL</span>)&#123;                  <span class="comment">//删除的是非叶子结点</span></span><br><span class="line">                Substitution(p,i);                  <span class="comment">//寻找相邻关键字(右子树中最小的关键字) </span></span><br><span class="line">                BTNodeDelete(p-&gt;ptr[i],p-&gt;key[i]);  <span class="comment">//执行删除操作 </span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                Remove(p,i);                        <span class="comment">//从结点p中位置i处删除关键字</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            found_tag=BTNodeDelete(p-&gt;ptr[i],k);    <span class="comment">//沿孩子结点递归查找并删除关键字k</span></span><br><span class="line">        <span class="keyword">if</span>(p-&gt;ptr[i]!=<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;ptr[i]-&gt;keynum&lt;Min)               <span class="comment">//删除后关键字个数小于MIN</span></span><br><span class="line">                AdjustBTree(p,i);                   <span class="comment">//调整B树 </span></span><br><span class="line">        <span class="keyword">return</span> found_tag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.15B</span>TreeDelete函数</span><br><span class="line">功能：构建删除框架，执行删除操作</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BTreeDelete</span><span class="params">(BTree &amp;t,KeyType k)</span></span>&#123;  </span><br><span class="line">    BTNode *p;</span><br><span class="line">    <span class="keyword">int</span> a=BTNodeDelete(t,k);                        <span class="comment">//删除关键字k </span></span><br><span class="line">    <span class="keyword">if</span>(a==<span class="number">0</span>)                                        <span class="comment">//查找失败 </span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   关键字%d不在B树中\n&quot;</span>,k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(t-&gt;keynum==<span class="number">0</span>)&#123;                          <span class="comment">//调整 </span></span><br><span class="line">        p=t;</span><br><span class="line">        t=t-&gt;ptr[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">free</span>(p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.16</span>DestroyBTree函数</span><br><span class="line">功能：递归释放B树</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DestroyBTree</span><span class="params">(BTree &amp;t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;  </span><br><span class="line">    BTNode* p=t;  </span><br><span class="line">    <span class="keyword">if</span>(p!=<span class="literal">NULL</span>)&#123;                                    <span class="comment">//B树不为空  </span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=p-&gt;keynum;i++)&#123;                  <span class="comment">//递归释放每一个结点 </span></span><br><span class="line">            DestroyBTree(*&amp;p-&gt;ptr[i]);  </span><br><span class="line">        &#125;  </span><br><span class="line">        <span class="built_in">free</span>(p);  </span><br><span class="line">    &#125;  </span><br><span class="line">    t=<span class="literal">NULL</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="number">2.4</span><span class="number">.17</span>InitQueue函数</span><br><span class="line">功能：初始化队列</span><br><span class="line">代码实现： </span><br><span class="line"><span class="function">Status <span class="title">InitQueue</span><span class="params">(LinkList &amp;L)</span></span>&#123;</span><br><span class="line">    L=(LNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));                <span class="comment">//分配结点空间 </span></span><br><span class="line">    <span class="keyword">if</span>(L==<span class="literal">NULL</span>)                                     <span class="comment">//分配失败              </span></span><br><span class="line">        <span class="keyword">return</span> OVERFLOW;</span><br><span class="line">     L-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">     <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.18</span>CreateNode函数</span><br><span class="line">功能：新建一个结点</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function">LNode* <span class="title">CreateNode</span><span class="params">(BTNode *p)</span></span>&#123;</span><br><span class="line">    LNode *q;</span><br><span class="line">    q=(LNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));                <span class="comment">//分配结点空间</span></span><br><span class="line">    <span class="keyword">if</span>(q!=<span class="literal">NULL</span>)&#123;                                    <span class="comment">//分配成功 </span></span><br><span class="line">        q-&gt;data=p;</span><br><span class="line">        q-&gt;next=<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.19</span>Enqueue函数</span><br><span class="line">功能：元素q入队列</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function">Status <span class="title">Enqueue</span><span class="params">(LNode *p,BTNode *q)</span></span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(p==<span class="literal">NULL</span>)                                     </span><br><span class="line">        <span class="keyword">return</span> ERROR;                               </span><br><span class="line">    <span class="keyword">while</span>(p-&gt;next!=<span class="literal">NULL</span>)                            <span class="comment">//调至队列最后 </span></span><br><span class="line">        p=p-&gt;next;</span><br><span class="line">    p-&gt;next=CreateNode(q);                          <span class="comment">//生成结点让q进入队列 </span></span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.20</span>Dequeue函数</span><br><span class="line">功能：出队列，并以q返回值</span><br><span class="line">代码实现： </span><br><span class="line"><span class="function">Status <span class="title">Dequeue</span><span class="params">(LNode *p,BTNode *&amp;q)</span></span>&#123;</span><br><span class="line">    LNode *aq;</span><br><span class="line">    <span class="keyword">if</span>(p==<span class="literal">NULL</span>||p-&gt;next==<span class="literal">NULL</span>)                      <span class="comment">//删除位置不合理 </span></span><br><span class="line">        <span class="keyword">return</span> ERROR; </span><br><span class="line">    aq=p-&gt;next;                                     <span class="comment">//修改被删结点aq的指针域</span></span><br><span class="line">    p-&gt;next=aq-&gt;next;                               </span><br><span class="line">    q=aq-&gt;data;</span><br><span class="line">    <span class="built_in">free</span>(aq);                                       <span class="comment">//释放结点aq</span></span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.21</span>IfEmpty函数</span><br><span class="line">功能：队列判空 </span><br><span class="line">代码实现：</span><br><span class="line"><span class="function">Status <span class="title">IfEmpty</span><span class="params">(LinkList L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L==<span class="literal">NULL</span>)                                     <span class="comment">//队列不存在 </span></span><br><span class="line">        <span class="keyword">return</span> ERROR;</span><br><span class="line">    <span class="keyword">if</span>(L-&gt;next==<span class="literal">NULL</span>)                               <span class="comment">//队列为空 </span></span><br><span class="line">        <span class="keyword">return</span> TRUE;</span><br><span class="line">    <span class="keyword">return</span> FALSE;                                   <span class="comment">//队列非空 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.22</span>DestroyQueue函数</span><br><span class="line">功能：销毁队列</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DestroyQueue</span><span class="params">(LinkList L)</span></span>&#123;</span><br><span class="line">   LinkList p;</span><br><span class="line">    <span class="keyword">if</span>(L!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">        p=L;</span><br><span class="line">        L=L-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(p);                                    <span class="comment">//逐一释放 </span></span><br><span class="line">        DestroyQueue(L);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.23</span>Traverse函数</span><br><span class="line">功能：用队列遍历输出B树</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function">Status <span class="title">Traverse</span><span class="params">(BTree t,LinkList L,<span class="keyword">int</span> newline,<span class="keyword">int</span> sum)</span></span>&#123; </span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    BTree p;</span><br><span class="line">    <span class="keyword">if</span>(t!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  [ &quot;</span>);</span><br><span class="line">        Enqueue(L,t-&gt;ptr[<span class="number">0</span>]);                       <span class="comment">//入队         </span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=t-&gt;keynum;i++)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot; %d &quot;</span>,t-&gt;key[i]);</span><br><span class="line">            Enqueue(L,t-&gt;ptr[i]);                   <span class="comment">//子结点入队 </span></span><br><span class="line">        &#125;</span><br><span class="line">        sum+=t-&gt;keynum+<span class="number">1</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(newline==<span class="number">0</span>)&#123;                             <span class="comment">//需要另起一行 </span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            newline=sum<span class="number">-1</span>;</span><br><span class="line">            sum=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            newline--;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span>(IfEmpty(L)==FALSE)&#123;                         <span class="comment">//l不为空 </span></span><br><span class="line">         Dequeue(L,p);                              <span class="comment">//出队，以p返回 </span></span><br><span class="line">         Traverse(p,L,newline,sum);                 <span class="comment">//遍历出队结点 </span></span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> OK;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.24</span>PrintBTree函数</span><br><span class="line">功能：输出B树</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function">Status <span class="title">PrintBTree</span><span class="params">(BTree t)</span></span>&#123;</span><br><span class="line">   LinkList L;</span><br><span class="line">    <span class="keyword">if</span>(t==<span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;  B树为空树&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> OK;</span><br><span class="line">    &#125;</span><br><span class="line">    InitQueue(L);                                   <span class="comment">//初始化队列 </span></span><br><span class="line">    Traverse(t,L,<span class="number">0</span>,<span class="number">0</span>);                              <span class="comment">//利用队列输出 </span></span><br><span class="line">    DestroyQueue(L);                                <span class="comment">//销毁队列 </span></span><br><span class="line">    <span class="keyword">return</span> OK;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.4</span><span class="number">.25</span>Test1函数</span><br><span class="line">功能：测试B树功能</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test1</span><span class="params">()</span></span>&#123; </span><br><span class="line">    system(<span class="string">&quot;color 70&quot;</span>);  </span><br><span class="line">    BTNode *t=<span class="literal">NULL</span>;</span><br><span class="line">    Result s;                                       <span class="comment">//设定查找结果 </span></span><br><span class="line">    <span class="keyword">int</span> j,n=<span class="number">15</span>;</span><br><span class="line">    KeyType k;</span><br><span class="line">    KeyType a[]=&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>&#125;;                           </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;创建一棵%d阶B树:\n&quot;</span>,m);</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;n;j++)&#123;                               <span class="comment">//逐一插入元素 </span></span><br><span class="line">        s=SearchBTree(t,a[j]);</span><br><span class="line">        <span class="keyword">if</span>(s.tag==<span class="number">0</span>)</span><br><span class="line">            InsertBTree(t,s.i,a[j],s.pt);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;   第%d步,插入元素%d:\n &quot;</span>,j+<span class="number">1</span>,a[j]);</span><br><span class="line">        PrintBTree(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;删除操作:\n&quot;</span>);                          <span class="comment">//删除操作 </span></span><br><span class="line">    k=<span class="number">9</span>;                                                        </span><br><span class="line">    BTreeDelete(t,k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  删除%d:\n &quot;</span>,k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  删除后的B树: \n&quot;</span>);</span><br><span class="line">    PrintBTree(t);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    k=<span class="number">1</span>;</span><br><span class="line">    BTreeDelete(t,k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  删除%d:\n &quot;</span>,k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  删除后的B树: \n&quot;</span>);</span><br><span class="line">    PrintBTree(t);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;  递归释放B树\n&quot;</span>);                       <span class="comment">//递归释放B树</span></span><br><span class="line">    DestroyBTree(t);                                 </span><br><span class="line">    PrintBTree(t);</span><br><span class="line">&#125; </span><br><span class="line"><span class="number">2.4</span><span class="number">.26</span>Test2函数</span><br><span class="line">功能：测试B树功能</span><br><span class="line">代码实现：</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,k; </span><br><span class="line">    system(<span class="string">&quot;color 70&quot;</span>);</span><br><span class="line">    BTree t=<span class="literal">NULL</span>;  </span><br><span class="line">    Result s;                                       <span class="comment">//设定查找结果 </span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;此时的B树：\n&quot;</span>);</span><br><span class="line">    PrintBTree(t); </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=============Operation Table=============\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;   1.Init     2.Insert    3.Delete    \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;   4.Destroy  5.Exit      \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;=========================================\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Enter number to choose operation:_____\b\b\b&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;i);</span><br><span class="line">    <span class="keyword">switch</span>(i)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">            InitBTree(t);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;InitBTree successfully.\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Enter number to InsertBTree:_____\b\b\b&quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;k);</span><br><span class="line">            s=SearchBTree(t,k);</span><br><span class="line">            InsertBTree(t,s.i,k,s.pt);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;InsertBTree successfully.\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Enter number to DeleteBTree:_____\b\b\b&quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;k);</span><br><span class="line">            BTreeDelete(t,k);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;DeleteBTree successfully.\n&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">            DestroyBTree(t);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;DestroyBTree successfully.\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">-1</span>);               </span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag"># 数据结构</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/12/04/data-structure-09/" rel="prev" title="数据结构和算法(零九)：查找算法">
      <i class="fa fa-chevron-left"></i> 数据结构和算法(零九)：查找算法
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/12/16/data-structure-11/" rel="next" title="数据结构和算法(壹一)：排序算法">
      数据结构和算法(壹一)：排序算法 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Minwei Chen</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>


  















  

  

  

</body>
</html>
