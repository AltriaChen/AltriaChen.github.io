<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  
  <link rel="stylesheet" href="/lib/animate-css/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Pisces","version":"8.0.0-rc.5","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false};
  </script>

  <meta name="description" content="本篇介绍了 Linux 的基础语法，详细讲解了 Shell 编程。">
<meta property="og:type" content="article">
<meta property="og:title" content="Shell编程指南">
<meta property="og:url" content="http://yoursite.com/2023/11/20/shell-study/index.html">
<meta property="og:site_name" content="Cross Code">
<meta property="og:description" content="本篇介绍了 Linux 的基础语法，详细讲解了 Shell 编程。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-11-20T12:12:08.000Z">
<meta property="article:modified_time" content="2024-02-19T13:51:42.365Z">
<meta property="article:author" content="Minwei Chen">
<meta property="article:tag" content="Shell">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/2023/11/20/shell-study/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Shell编程指南 | Cross Code</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

  <script type="text/javascript" src="/js/my_js/clicklove.js"></script>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Cross Code</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">There is only one heroism in the world: to see the world as it is and to love it</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
          <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%B8%8E%E6%A6%82%E8%BF%B0"><span class="nav-text">一. 基础知识与概述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-Linux-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="nav-text">(A) Linux 基础知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95"><span class="nav-text">(a) 文件目录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">(b) 常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4"><span class="nav-text">(1) 基础命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">(2) 常用命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E9%87%8D%E8%A6%81%E7%AC%A6%E5%8F%B7"><span class="nav-text">(3) 重要符号</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-Shell-%E6%A6%82%E8%BF%B0"><span class="nav-text">(B) Shell 概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-Shell-%E4%B8%8E-Shell-%E8%84%9A%E6%9C%AC"><span class="nav-text">(a) Shell 与 Shell 脚本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-Shebang"><span class="nav-text">(b) Shebang</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-%E6%89%A7%E8%A1%8C-shell-%E8%84%9A%E6%9C%AC%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-text">(c) 执行 shell 脚本的方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#d-%E6%8B%BE%E9%81%97"><span class="nav-text">(d) 拾遗</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#C-Bash-%E6%A6%82%E8%BF%B0"><span class="nav-text">(C) Bash 概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E7%AE%80%E4%BB%8B"><span class="nav-text">(a) 简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-Bash-%E7%89%B9%E6%80%A7"><span class="nav-text">(b) Bash 特性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E8%A1%A5%E5%85%A8%E7%89%B9%E6%80%A7"><span class="nav-text">(1) 补全特性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="nav-text">(2) 快捷键</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%91%BD%E4%BB%A4%E5%8E%86%E5%8F%B2"><span class="nav-text">(3) 命令历史</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E5%88%AB%E5%90%8D"><span class="nav-text">(4) 别名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-text">(5) 通配符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">(6) 重定向</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7"><span class="nav-text">(7) 特殊符号</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C-Shell-%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80"><span class="nav-text">二. Shell 编程基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-%E5%8F%98%E9%87%8F"><span class="nav-text">(A) 变量</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E5%8F%98%E9%87%8F%E5%90%8D%E8%A7%84%E5%88%99"><span class="nav-text">(a) 变量名规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E8%B5%8B%E5%80%BC%E4%B8%8E%E5%BC%95%E7%94%A8"><span class="nav-text">(b) 赋值与引用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-text">(c) 作用域</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#d-%E5%8D%95%E5%8F%8C%E5%BC%95%E5%8F%B7"><span class="nav-text">(d) 单双引号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#e-%E7%88%B6%E5%AD%90-shell"><span class="nav-text">(e) 父子 shell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#f-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E8%AE%BE%E7%BD%AE"><span class="nav-text">(f) 环境变量设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#g-%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F"><span class="nav-text">(g) 特殊变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#h-%E7%89%B9%E6%AE%8A%E7%8A%B6%E6%80%81%E5%8F%98%E9%87%8F"><span class="nav-text">(h) 特殊状态变量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E5%9F%BA%E7%A1%80%E5%86%85%E7%BD%AE-Shell-%E5%91%BD%E4%BB%A4"><span class="nav-text">(B) 基础内置 Shell 命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#C-Shell-%E5%AD%90%E4%B8%B2"><span class="nav-text">(C) Shell 子串</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E5%8F%98%E9%87%8F%E5%AD%90%E4%B8%B2"><span class="nav-text">(a) 变量子串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86"><span class="nav-text">(b) 字符串处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#D-%E6%89%A9%E5%B1%95%E5%8F%98%E9%87%8F"><span class="nav-text">(D) 扩展变量</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E7%AE%80%E4%BB%8B-1"><span class="nav-text">(a) 简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E5%AE%9E%E4%BE%8B"><span class="nav-text">(b) 实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#E-%E7%88%B6%E5%AD%90-shell"><span class="nav-text">(E) 父子 shell</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E6%A6%82%E8%BF%B0"><span class="nav-text">(a) 概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E5%88%9B%E5%BB%BA%E8%BF%9B%E7%A8%8B%E5%88%97%E8%A1%A8"><span class="nav-text">(b) 创建进程列表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#F-%E5%87%BD%E6%95%B0"><span class="nav-text">(F) 函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89"><span class="nav-text">(a) 函数定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C"><span class="nav-text">(b) 函数执行</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89-Shell-%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97"><span class="nav-text">三. Shell 数学运算</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-%E6%A6%82%E8%BF%B0"><span class="nav-text">(A) 概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E8%AF%A6%E8%A7%A3"><span class="nav-text">(B) 详解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E5%8F%8C%E5%B0%8F%E6%8B%AC%E5%8F%B7"><span class="nav-text">(a) 双小括号</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-text">(1) 使用方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%AE%9E%E4%BE%8B"><span class="nav-text">(2) 实例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-let"><span class="nav-text">(b) let</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-expr"><span class="nav-text">(c) expr</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#d-bc"><span class="nav-text">(d) bc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#e-awk-%E8%AE%A1%E7%AE%97"><span class="nav-text">(e) awk 计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#f-%E4%B8%AD%E6%8B%AC%E5%8F%B7%E8%AE%A1%E7%AE%97"><span class="nav-text">(f) 中括号计算</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B-Shell-%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="nav-text">四. Shell 条件测试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-test-%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="nav-text">(A) test 条件测试</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-test-%E8%AF%AD%E6%B3%95%E5%8F%82%E6%95%B0%E5%A4%A7%E5%85%A8"><span class="nav-text">(a) test 语法参数大全</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-test-%E5%91%BD%E4%BB%A4%E5%AE%9E%E8%B7%B5"><span class="nav-text">(b) test 命令实践</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E5%8D%95%E4%B8%AD%E6%8B%AC%E5%8F%B7"><span class="nav-text">(B) 单中括号</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E8%AF%AD%E6%B3%95%E8%AE%B2%E8%A7%A3"><span class="nav-text">(a) 语法讲解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E8%84%9A%E6%9C%AC%E5%AE%9E%E4%BE%8B"><span class="nav-text">(b) 脚本实例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94-%E9%80%89%E6%8B%A9%E4%B8%8E%E5%BE%AA%E7%8E%AF"><span class="nav-text">五. 选择与循环</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-%E9%80%89%E6%8B%A9%E8%AF%AD%E5%8F%A5"><span class="nav-text">(A) 选择语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-%E5%8D%95%E5%88%86%E6%94%AF-if"><span class="nav-text">(a) 单分支 if</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-if%C2%B7%C2%B7%C2%B7else"><span class="nav-text">(b) if···else</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#c-%E5%A4%9A%E5%88%86%E6%94%AF%E5%A4%84%E7%90%86"><span class="nav-text">(c) 多分支处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#d-case-%E8%AF%AD%E5%8F%A5"><span class="nav-text">(d) case 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="nav-text">(B) 循环语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#a-for-%E8%AF%AD%E5%8F%A5"><span class="nav-text">(a) for 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-while-%E8%AF%AD%E5%8F%A5"><span class="nav-text">(b) while 语句</span></a></li></ol></li></ol></li></ol></div>
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Minwei Chen"
      src="/images/tuoqi.jpg">
  <p class="site-author-name" itemprop="name">Minwei Chen</p>
  <div class="site-description" itemprop="description">Cross the surface, get to the reality. Welcome to Cross Code!</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">45</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/AltriaChen" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;AltriaChen" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:mwchennju@foxmail.com" title="E-Mail → mailto:mwchennju@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </section>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


      <div class="main-inner">
        

        <div class="content post posts-expand">
          

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2023/11/20/shell-study/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/tuoqi.jpg">
      <meta itemprop="name" content="Minwei Chen">
      <meta itemprop="description" content="Cross the surface, get to the reality. Welcome to Cross Code!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Cross Code">
    </span>

    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Shell编程指南
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-11-20 20:12:08" itemprop="dateCreated datePublished" datetime="2023-11-20T20:12:08+08:00">2023-11-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-02-19 21:51:42" itemprop="dateModified" datetime="2024-02-19T21:51:42+08:00">2024-02-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>本篇介绍了 Linux 的基础语法，详细讲解了 Shell 编程。</p>
<a id="more"></a>

<h1 id="一-基础知识与概述"><a href="#一-基础知识与概述" class="headerlink" title="一. 基础知识与概述"></a>一. 基础知识与概述</h1><h2 id="A-Linux-基础知识"><a href="#A-Linux-基础知识" class="headerlink" title="(A) Linux 基础知识"></a>(A) Linux 基础知识</h2><h3 id="a-文件目录"><a href="#a-文件目录" class="headerlink" title="(a) 文件目录"></a>(a) 文件目录</h3><p><strong>主要文件目录</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/bin： 主要命令</span><br><span class="line">/tmp： 临时文件</span><br><span class="line">/mnt： 挂载分区</span><br><span class="line">/sys： 硬件设备，虚拟文件系统</span><br><span class="line">/etc： 各种配置文件</span><br><span class="line">/boot：启动相关重要文件</span><br><span class="line">/var： log文件</span><br></pre></td></tr></table></figure>

<p><strong>内核目录</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">/kernel： linux的核心代码，内核标准</span><br><span class="line">/include：内核头文件，主要提供给外部模块使用</span><br><span class="line">/mm：     内存管理系统</span><br><span class="line">/fs：     VFS子系统</span><br><span class="line">/net：    网络相关history</span><br><span class="line">/ipc：    进程间通信子系统</span><br><span class="line">/arch：   体系结构相关代码</span><br><span class="line">/init：   启动初始化代码</span><br><span class="line">/drivers：驱动相关</span><br></pre></td></tr></table></figure>

<h3 id="b-常用命令"><a href="#b-常用命令" class="headerlink" title="(b) 常用命令"></a>(b) 常用命令</h3><h4 id="1-基础命令"><a href="#1-基础命令" class="headerlink" title="(1) 基础命令"></a>(1) 基础命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ls:    列出目录及文件名</span><br><span class="line">cd:    切换目录          cd ~/ :退出到根目录</span><br><span class="line">pwd:   显示当前的目录</span><br><span class="line">mkdir: 创建一个新的目录</span><br><span class="line">rmdir: 删除一个空的目录</span><br><span class="line">cp:    复制文件或目录</span><br><span class="line">rm:    移除文件或目录     rm -rf dir_name: 强制删除目录及以下所有文件</span><br><span class="line">mv:    移动文件或修改名称  mv file dir.d/ ; mv old_name new_name</span><br><span class="line">touch: 新建文件          touch a.txt</span><br><span class="line">chmod: 修改权限          chmod +x a.sh;  r-可读 w-可写 x-可执行</span><br><span class="line">cat:   由第一行开始显示文件内容</span><br><span class="line">tac:   从最后一行开始显示文件内容</span><br><span class="line">nl:    显示文件内容时,顺道输出行号</span><br></pre></td></tr></table></figure>

<h4 id="2-常用命令"><a href="#2-常用命令" class="headerlink" title="(2) 常用命令"></a>(2) 常用命令</h4><p><strong>(1) ps</strong></p>
<p>ps 是 Linux 中最基础的浏览系统中的进程的命令。能列出系统中运行的进程，包括进程号、命令、CPU使用量、内存使用量等。下述选项可以得到更多有用的消息。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ps -a :            列出所有运行中/激活进程</span><br><span class="line">ps -aux:           显示进程信息，包括无终端的（x）和针对用户（u）的进程</span><br><span class="line">ps -ef |gerp ssh:    查找指定的进程ssh</span><br><span class="line">ps -ef |grep ssh -c: 查找指定的进行ssh的个数</span><br></pre></td></tr></table></figure>

<p><strong>(2) history</strong></p>
<p>history 命令用于显示历史命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">history:    显示所有历史命令</span><br><span class="line">history 10: 显示最近的10条历史命令</span><br></pre></td></tr></table></figure>

<p><strong>(3) top</strong></p>
<p>Linux 系统中，top 命令主要用于实时运行系统的监控，包括 Linux 内核管理的进程或者线程的资源占用情况。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">top：     启动top命令</span><br><span class="line">top -c：  显示完整的命令行</span><br><span class="line">top -b：  以批处理模式显示程序信息</span><br><span class="line">top -S：  以累积模式显示程序信息</span><br><span class="line">top -n 2：   表示更新两次后终止更新显示</span><br><span class="line">top -d 3：   设置信息更新周期为3秒</span><br><span class="line">top -p 139： 显示进程号为139的进程信息，CPU、内存占用率等</span><br></pre></td></tr></table></figure>

<p><strong>(4) grep</strong></p>
<p> grep 命令是一个强大的文本搜索工具，它可以在文件中查找指定的文本模式，并输出符合条件的行。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">命令参数</span><br><span class="line">-i：  忽略大小写。</span><br><span class="line">-v：  反转匹配，即输出不包含模式的行。</span><br><span class="line">-c：  仅输出匹配行的数量，而不是匹配的行内容。</span><br><span class="line">-n：  显示匹配行的行号。</span><br><span class="line">-r：  递归搜索子目录中的文件。</span><br><span class="line">-w：  仅匹配整个单词，而不是单词的部分。</span><br><span class="line">-E：  使用扩展正则表达式进行匹配。</span><br><span class="line">-F：  将模式视为固定字符串，而不是正则表达式。</span><br><span class="line">-A NUM：  输出匹配行及其后面 NUM 行的内容。</span><br><span class="line">-B NUM：  输出匹配行及其前面 NUM 行的内容。</span><br><span class="line">-C NUM：  输出匹配行及其前面和后面各 NUM 行的内容。</span><br></pre></td></tr></table></figure>

<p>使用参考</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;search_string&quot; file.txt:      在文件中查找包含指定字符串的行</span><br><span class="line">grep -i &quot;search_string&quot; file.txt:   忽略大小写, 在文件中查找包含指定字符串的行</span><br><span class="line">grep -v &quot;search_string&quot; file.txt:   在文件中查找不包含指定字符串的行</span><br><span class="line">grep -r &quot;search_string&quot; /path/to/dir:  在目录及其子目录中查找包含指定字符串的文件</span><br><span class="line">grep -C 5 &quot;search_string&quot; file.txt:    输出匹配行及其前后各5行的内容</span><br></pre></td></tr></table></figure>

<p><strong>(5) wc</strong></p>
<p>在 Linux 中，wc (word count) 命令常用于计算文件的行数、字数和字节数。</p>
<p>参数说明</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-l , --lines : 显示行数</span><br><span class="line">-w , --words : 显示字数</span><br><span class="line">-m , --chars : 显示字符数</span><br><span class="line">-c , --bytes : 显示字节数</span><br><span class="line">-L , --max-line-length : 显示最长行的长度</span><br></pre></td></tr></table></figure>

<p><strong>(6) read</strong></p>
<p>read 命令读取用户键盘输入的字符。</p>
<p>参数说明</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-a:  后跟一个变量，该变量会被认为是个数组，然后给其赋值，默认是以空格为分割符。</span><br><span class="line">-p： “提示信息”。在等待read输入时，输出提示信息</span><br><span class="line">-t： 秒数。read命令会一直等待用户输入，使用此选项可以指定等待时间</span><br><span class="line">-n： 数字。read命令只接受指定的字符数，就会执行</span><br><span class="line">-s： 隐藏输入的数据，适用于机密信息的输入</span><br><span class="line">-d： 后面跟一个标志符，其实只有其后的第一个字符有用，作为结束的标志。</span><br><span class="line">-e： 在输入的时候可以使用命令补全功能。</span><br></pre></td></tr></table></figure>

<p>使用参考</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">read -t 30 -p &quot;Please input your name: &quot; name</span><br><span class="line"><span class="meta">#</span><span class="bash">提示“请输入姓名”并等待30 秒，把用户的输入保存入变量name 中</span></span><br><span class="line">echo &quot;Name is $name&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash">看看变量“<span class="variable">$name</span>”中是否保存了你的输入</span></span><br><span class="line"></span><br><span class="line">read -s -t 30 -p &quot;Please enter your age: &quot; age</span><br><span class="line"><span class="meta">#</span><span class="bash">提示“请输入年龄”并等待30秒，把用户的输入保存入变量age中</span></span><br><span class="line"><span class="meta">#</span><span class="bash">年龄是隐私，所以我们用“-s”选项隐藏输入</span></span><br><span class="line">echo -e &quot;\n&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash">调整输出格式，如果不输出换行，一会的年龄输出不会换行</span></span><br><span class="line">echo &quot;Age is $age&quot;</span><br><span class="line"></span><br><span class="line">read -n 1 -t 30 -p &quot;Please select your gender[M/F]:&quot; gender</span><br><span class="line"><span class="meta">#</span><span class="bash">提示“请选择性别”并等待30秒，把用户的输入保存入变量gender</span></span><br><span class="line"><span class="meta">#</span><span class="bash">使用“-n1”选项只接收一个输入字符就会执行（都不用输入回车）</span></span><br><span class="line">echo -e &quot;\n&quot;</span><br><span class="line">echo &quot;Sex is $gender&quot;</span><br></pre></td></tr></table></figure>

<p><strong>(7) sed</strong></p>
<p>sed 是操作、过滤和转换文本内容的强大工具，sed 可以从文件和管道中读取输入。</p>
<p>sed 命令语法：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sed [option]&#123;sed -commands&#125;&#123;input-file&#125;</span><br><span class="line"></span><br><span class="line">-e:  执行多个sed命令</span><br><span class="line">-n:  只显示操作行</span><br><span class="line">-i:  修改目标文件内容</span><br></pre></td></tr></table></figure>

<p>sed 每次都从目标文件读取一行记录，并在该记录上执行 sed -commands 命令，直到最后一行结束。</p>
<ul>
<li><strong>p 打印命令</strong></li>
</ul>
<p>命令 p 可以控制只输出你指定的内容，通常使用 p 时，还需要使用 -n 选项来屏蔽 sed 的默认输出，否则当执行命令 p 时，每行记录会输出两次。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">n~m 表示从第 n 行开始，每次跳过 m 行：</span><br><span class="line">1~2 匹配 1,3,5,7,······</span><br><span class="line">2~2 匹配 2,4,6,8,······</span><br><span class="line">1~3 匹配 1,4,7,10,······</span><br><span class="line">2~3 匹配 2,5,8,11,······</span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sed -n ‘p’ filename:             #打印所有行</span><br><span class="line">sed -n ‘2p’ filename:            #打印第二行</span><br><span class="line">sed -n ‘1,4p’ filename:          #打印1-4行 </span><br><span class="line">sed -n ‘2~3 p’ filename:         #打印2,5,8,11 等行</span><br><span class="line">sed -n ‘/exam/p’ filename:       #打印匹配到exam的所有行</span><br><span class="line">sed -n ‘/exam/,4 p’ filename:    #打印第一次匹配exam的行至第四行的内容</span><br><span class="line">sed -n ‘/exam/,$ p’ filename:    #打印第一次匹配到exam的行到最后所有行</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>d 删除命令</strong></li>
</ul>
<p><strong>注意：不加 i 参数，源文件内容不变</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sed ‘2d’ filename:            #删除第二行</span><br><span class="line">sed ‘1,4d’ filename:          #删除1到4行</span><br><span class="line">sed ‘2,$d’ filename:          #删除第二行到最后一行</span><br><span class="line">sed ‘1~2 d’ filename:         #删除奇数行</span><br><span class="line">sed ‘/exam/d’ filename:       #删除匹配exam的行</span><br><span class="line">sed ‘/exam/,4 d’ filename:      #删除匹配exam的行至第四行</span><br><span class="line">sed ‘/exam/,$ d’ filename:    #删除第一次匹配到exam的行到最后一行</span><br><span class="line">sed ‘/exam/,+2 d’ filename:   #删除第一次匹配到exam的行和紧跟它后面的两行</span><br><span class="line">sed ‘/^$/d’ filename:         #删除空行</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>w 写入命令</strong></li>
</ul>
<p>命令 w 可以把一个文件内容保存到另一个文件中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sed ‘w 1.txt’ 2.txt:  #把2.txt的内容保存到1.txt,同时显示在屏幕上。会覆盖1.txt文件中有内容</span><br><span class="line">sed -n ‘w 1.txt’ 2.txt:        #同上功能,只是不在屏幕上显示</span><br><span class="line">sed -n ‘2w 1.txt’ 2.txt:       #只保存第二行</span><br><span class="line">sed -n ‘1,4w 1.txt’ 2.txt:     #只保存1到4行</span><br><span class="line">sed -n ‘2,$w 1.txt’ 2.txt:     #保存第二行至最后一行</span><br><span class="line">sed -n ‘1~2 w 1.txt’ 2.txt:    #保存奇数行</span><br><span class="line">sed -n ‘/exam/w 1.txt’ 2.txt:        #保存匹配到exam的行</span><br><span class="line">sed -n ‘/exam/,4 w 1.txt’ 2.txt:     #保存第一次匹配exam的行至第四行</span><br><span class="line">sed -n ‘/sxd/,/exa/ w 1.txt’ 2.txt:  #保存匹配sxd至匹配exa的行</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>s 替换命令</strong></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sed ‘s/a/b/’ filename:     #用b替换文件中每行当中第一个a</span><br><span class="line">sed ‘/a/s/b/c/’ filename:  #用c替换包含a中行中第一个b</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">g全局标记</span></span><br><span class="line">sed ‘s/a/b/g’ filename:   #用b替换含有a的所有行中所有的a</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">1 2 3 数字标记</span></span><br><span class="line">sed ‘s/a/b/2’ filename:   #替换第2个a</span><br></pre></td></tr></table></figure>

<ul>
<li>正则表达式</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;/^103/ p&#x27; log.txt:    #匹配103开头的行并打印</span><br><span class="line">sed -n &#x27;/r$/ p&#x27; log.txt:      #匹配r结尾的行并打印</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">匹配0到任意多次(*)</span></span><br><span class="line">sed -n &#x27;/log: *./p&#x27; log.txt:    #匹配包含log并且log后面有信息的行</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">匹配1到多次(\+)</span></span><br><span class="line">sed -n &#x27;/log: \+/ p&#x27; log.txt:   #匹配log后面有一个或者多个空格的行</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">匹配0次或者1次 前面的字符</span></span><br><span class="line">sed -n &#x27;/log: \?/ p&#x27; log.txt:    #匹配log后面没有空格或者有一个空格的行</span><br><span class="line">  </span><br><span class="line"><span class="meta">#</span><span class="bash">转义字符(\)</span></span><br><span class="line">sed -n &#x27;/127\.0\.0\.1/ p&#x27; /etc/host:   #匹配含有127.0.0.1的行并打印</span><br><span class="line"> </span><br><span class="line"><span class="meta">#</span><span class="bash">字符集([0-9])</span></span><br><span class="line">sed -n ‘/[123]/ p&#x27; log.txt:     #匹配含有1或2或3的行,并打印</span><br></pre></td></tr></table></figure>

<p><strong>(8) awk</strong></p>
<ul>
<li>基础语法</li>
</ul>
<p>awk 是一种处理文本文件的编程语言，文件的每行数据都被称为“记录”。默认以空格或制表符为分隔符，每条记录被分成若干字段 (列)，awk 每次从文件中读取一条记录。</p>
<p>语法格式：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk [选项] &#x27;条件&#123;动作&#125;&#x27; 文件名</span><br></pre></td></tr></table></figure>

<p>awk 语法由一系列条件和动作组成，在花括号内可以有多个动作，多个动作之间用分号分隔，在多个条件和动作之间可以有若干空格，也可以没有。</p>
<p>如果没有指定条件则匹配所有数据，如果没有指定动作则默认为 print 打印。</p>
<ul>
<li>常用的内置变量</li>
</ul>
<table>
<thead>
<tr>
<th>变量</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-F</td>
<td>指定分隔符</td>
</tr>
<tr>
<td>-v</td>
<td>指定变量和默认值</td>
</tr>
<tr>
<td>$NF</td>
<td>代表最后一个字段</td>
</tr>
<tr>
<td>NR</td>
<td>代表第几行</td>
</tr>
<tr>
<td>&amp;&amp;</td>
<td>逻辑与</td>
</tr>
<tr>
<td>||</td>
<td>逻辑或</td>
</tr>
<tr>
<td>FS</td>
<td>输入字段分隔符，与 -F 分隔符一样</td>
</tr>
<tr>
<td>OFS</td>
<td>输出字段分隔符</td>
</tr>
<tr>
<td>RS</td>
<td>输入记录分隔符</td>
</tr>
<tr>
<td>$0</td>
<td>整行，也就是当前记录</td>
</tr>
<tr>
<td>1…N</td>
<td>第一个字段到第 N 个字段，字段间由 FS 分隔</td>
</tr>
</tbody></table>
<ul>
<li><p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ free</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:        1974564      946340      269692        1848      758532      871660</span><br><span class="line">Swap:        945416        1036      944380</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">逐行打印第二列</span></span><br><span class="line">tplink@ubuntu:~$ free | awk &#x27;&#123;print $2&#125;&#x27;</span><br><span class="line">used</span><br><span class="line">1974564</span><br><span class="line">945416</span><br><span class="line"></span><br><span class="line">free | awk &#x27;&#123;print NR&#125;&#x27;         #输出行号</span><br><span class="line">free | awk &#x27;&#123;print NF&#125;&#x27;         #输出每行数据的列数</span><br><span class="line">awk &#x27;&#123;print $0&#125;&#x27; filename       #打印每行全部内容</span><br><span class="line">awk &#x27;&#123;print $NF&#125;&#x27; filename      #打印每行数据的最后一列</span><br><span class="line">awk &#x27;&#123;print $(NF-1)&#125;&#x27; filename  #打印每行倒数第二列</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="3-重要符号"><a href="#3-重要符号" class="headerlink" title="(3) 重要符号"></a>(3) 重要符号</h4><p><strong>(1) 重定向</strong></p>
<p>Linux 中，可以使用输出重定向来将命令或程序的输出结果保存到文件中。常见的输出重定向符号有 “&gt;” (覆盖写入)、”&gt;&gt;” (追加写入) 和 “2&gt;&amp;1” (标准错误输出合并为标准输出) 等。</p>
<p>使用参考</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">command &gt; file.txt</span><br><span class="line"><span class="meta">#</span><span class="bash">这会将<span class="built_in">command</span>命令的输出内容覆盖写入名为file.txt的文件中。如果该文件不存在则创建新文件；如果已经存在同名<span class="comment">#文件，则原文件内容被覆盖。</span></span></span><br><span class="line"></span><br><span class="line">command &gt;&gt; file.txt</span><br><span class="line"><span class="meta">#</span><span class="bash">这会将<span class="built_in">command</span>命令的输出内容追加写入名为file.txt的文件中。如果该文件不存在则创建新文件；如果已经存在同名<span class="comment">#文件，则新内容添加到文件末尾。</span></span></span><br><span class="line"></span><br><span class="line">command &gt; /dev/null</span><br><span class="line"><span class="meta">#</span><span class="bash">如果希望执行某个命令，但又不希望在屏幕上显示输出结果，那么可以将输出重定向到 /dev/null中</span></span><br></pre></td></tr></table></figure>

<p><strong>(2) 管道符</strong></p>
<p>管道符  <code>|</code> 是在 Unix-like 操作系统中常用的重要工具，它用于将一个命令的输出传递给另一个命令的输入，从而实现两个或多个命令之间的数据流通。</p>
<p>使用示例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat a.sh | grep &#x27;search_str&#x27;:  查找a.sh中的指定字符串</span><br><span class="line">ps -ef | gerp ssh:    查找指定的进程ssh</span><br></pre></td></tr></table></figure>

<p><strong>(3) 反引号</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">反引号用法: `linux命令`</span><br><span class="line">在linux中, 反引号中的命令执行结果会被保留下来</span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ name=`ls`</span><br><span class="line">tplink@ubuntu:~$ echo $name</span><br><span class="line">Desktop Documents Downloads Music Pictures Public Templates Videos</span><br></pre></td></tr></table></figure>

<h2 id="B-Shell-概述"><a href="#B-Shell-概述" class="headerlink" title="(B) Shell 概述"></a>(B) Shell 概述</h2><h3 id="a-Shell-与-Shell-脚本"><a href="#a-Shell-与-Shell-脚本" class="headerlink" title="(a) Shell 与 Shell 脚本"></a>(a) Shell 与 Shell 脚本</h3><p><strong>(1) 什么是 Shell</strong></p>
<p>在计算机科学中，Shell 俗称壳 (用来区别于核)，是指“为使用者提供操作界面”的软件 (command interpreter，命令解析器)。它类似于 DOS 下的 COMMAND.COM 和后来的 cmd.exe。它接收用户命令，然后调用相应的应用程。本文所说的 Shell 可视为用户和 Linux 内核之间的接口程序。</p>
<p><strong>(2) 什么是 Shell 脚本</strong></p>
<p>当命令或者程序语句写在文件中，我们执行文件，读取其中的代码，这个程序文件就称之为 Shell 脚本。</p>
<p>在 Shell 脚本里定义多条 Linux 命令以及循环控制语句，然后将这些 Linux 命令一次性执行完毕。这种执行脚本的方式称之为，非交互式方式。</p>
<p>Windows 中存在 <code>*bat</code> 脚本，Linux 中常用 <code>*sh</code> 脚本文件。在 Linux 系统中，shell 脚本或者称之为 “bash shell 程序” 通常都是 vim 编辑，由 Linux 命令、bash shell 指令、逻辑控制语句和注释信息组成。</p>
<h3 id="b-Shebang"><a href="#b-Shebang" class="headerlink" title="(b) Shebang"></a>(b) Shebang</h3><p>计算机程序中，shebang 指的是出现在文本文件的第一行前两个字符 <code>#!</code>。</p>
<p>在 Unix 系统中，程序会分析 shebang 后面的内容，作为解释器的指令，例如：</p>
<p>(1) 以 <code>#!/bin/sh</code> 开头的文件，程序在执行的时候回调用 <code>/bin/sh</code>，也就是 bash 解释器</p>
<p>(2) 以 <code>#!/usr/bin/python</code> 开头的文件，代表指定 python 解释器去执行</p>
<p>(3) 以 <code>#!/usr/bin/evn 解释器名称</code> 开头，是一种在不同平台上都能正确找到解释器的办法</p>
<p><strong>注意事项：</strong></p>
<p>(1) 如果脚本未指定 shebang，脚本执行的时候，默认用当前 shell 去解释脚本，即 <code>$SHELL</code></p>
<p>(2) 如果 shebang 指定了可执行的解释器，如 <code>/user/bin/python</code>，脚本在执行时，文件名会作为参数传递给解释器</p>
<p>(3) 如果 #! 指定的解释程序没有可执行权限，则会报错 “bad interpreter: Permission denied” </p>
<p>(4) 如果 #! 指定的解释程序不是一个可执行文件，那么指定的解释程序会被忽略，转而交给当前的 SHELL 去执行这个脚本。</p>
<p>(5) 如果 #! 指定的解释器不存在，那么会报错 “bad interpreter: No such file or directory”。</p>
<p>(6) #! 之后的解释程序，需要写其绝对路径 (如：#!/bin/bash)，它是不会自动到 $PATH 中寻找解释器的。</p>
<p>(7) 如果你使用 “bash test.sh” 这样的命令来执行脚本，那么 #! 这一行将会被忽略掉，解释器当然是用命令行中显式指定的 bash。</p>
<h3 id="c-执行-shell-脚本的方式"><a href="#c-执行-shell-脚本的方式" class="headerlink" title="(c) 执行 shell 脚本的方式"></a>(c) 执行 shell 脚本的方式</h3><p>(1) <code>bash script.sh</code> 或 <code>sh script.sh</code>：文件本身无可执行权限则使用的方法，或者脚本未指定 shebang，重点推荐的方法。</p>
<p>(2) 使用 <code>绝对/相对路径</code> 执行脚本：需要文件具备可执行权限。</p>
<p>(3) <code>source script.sh</code> 或者 <code>. script.sh</code>：<code>source</code> 等于 <code>.</code>，代表执行。</p>
<p>(4) 少见的用法：<code>sh &lt; script.sh</code>。</p>
<h3 id="d-拾遗"><a href="#d-拾遗" class="headerlink" title="(d) 拾遗"></a>(d) 拾遗</h3><p>(1) Shell 脚本语言属于一种弱类型语言，<strong>无需声明变量类型，直接定义使用</strong>。而强类型语言，必须先定义变量类型，确定是数字、字符串等，之后再赋予同类型的值。</p>
<p>(2) 可使用 <code>cat /etc/shells</code> 命令查看系统支持的 shell 情况。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ cat /etc/shells</span><br><span class="line"><span class="meta">#</span><span class="bash"> /etc/shells: valid login shells</span></span><br><span class="line">/bin/sh</span><br><span class="line">/bin/bash</span><br><span class="line">/usr/bin/bash</span><br><span class="line">/bin/rbash</span><br><span class="line">/usr/bin/rbash</span><br><span class="line">/bin/dash</span><br><span class="line">/usr/bin/dash</span><br></pre></td></tr></table></figure>

<p>查看默认 Shell 可使用如下命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ echo $SHELL</span><br><span class="line">/bin/bash</span><br></pre></td></tr></table></figure>

<p>(3) Shell 语言定义的变量，数据类型默认是字符串类型。</p>
<p>(4) Shell 的优势：虽然有诸多脚本编程语言，但是对于 Linux 操作系统内部应用而言，shell 是最好的工具。Linux底层命令都支持 shell 语句，以及结合三剑客 (grep、sed、awk) 进行高级用法。适合系统管理脚本开发，如软件启停脚本、监控报警脚本、日志分析脚本。</p>
<h2 id="C-Bash-概述"><a href="#C-Bash-概述" class="headerlink" title="(C) Bash 概述"></a>(C) Bash 概述</h2><h3 id="a-简介"><a href="#a-简介" class="headerlink" title="(a) 简介"></a>(a) 简介</h3><p>sh 即 Bourne shell，POSIX (Portable Operating System Interface) 标准的 shell 解释器，它的二进制文件路径通常是 /bin/sh，由 Bell Labs 开发。</p>
<p>Bash 是 Bourne shell 的替代品，属 GNU Project，二进制文件路径通常是 /bin/bash。业界通常混用 bash、sh、和 shell，比如你会经常在招聘运维工程师的文案中见到：熟悉 Linux Bash 编程，精通 Shell 编程。</p>
<p>Bash 是一个命令处理器，通常运行于文本窗口中，并能执行用户直接输入的命令。Bash 还能从文件中读取命令，这样的文件称为脚本。和其他 Unix shell 一样，它支持文件名替换 (通配符匹配)、管道、here 文档、命令替换、变量，以及条件判断和循环遍历的结构控制语句。包括关键字、语法在内的基本特性全部是从 sh 借鉴过来的。其他特性，例如历史命令，是从 csh 和ksh 借鉴而来。总的来说，Bash 虽然是一个满足 POSIX 规范的 shell，但有很多扩展。</p>
<h3 id="b-Bash-特性"><a href="#b-Bash-特性" class="headerlink" title="(b) Bash 特性"></a>(b) Bash 特性</h3><h4 id="1-补全特性"><a href="#1-补全特性" class="headerlink" title="(1) 补全特性"></a>(1) 补全特性</h4><p><strong>命令补全</strong>：输入一定的字符串，然后敲击 tab 键。如果能够唯一标识一个命令程序文件，直接补全。反之，再次敲击 tab 键就会给出命令列表。<br><strong>路径补全</strong>：在给定起始的路径下，对打头的字符串进行逐一匹配起始路径下的每一个文件，如果能够为唯一标识，敲击 tab 直接补全。反之，再次敲击 tab 键给出文件列表。</p>
<h4 id="2-快捷键"><a href="#2-快捷键" class="headerlink" title="(2) 快捷键"></a>(2) 快捷键</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Ctrl+l:  清屏</span><br><span class="line">Ctrl+c:  终止前台运行的程序</span><br><span class="line">Ctrl+a:  光标移动到命令行的最前端    </span><br><span class="line">Ctrl+e:  光标移动到命令行的最后端</span><br><span class="line">Ctrl+D:  退出</span><br><span class="line">Ctrl+r:  搜索历史命令，利用关键词</span><br><span class="line">Ctrl+u:  删除光标前的字符</span><br><span class="line">Ctrl+k:  删除光标后的字符</span><br></pre></td></tr></table></figure>

<h4 id="3-命令历史"><a href="#3-命令历史" class="headerlink" title="(3) 命令历史"></a>(3) 命令历史</h4><p>shell 进程会在其会话中保存此前用户提交执行过的命令。<br>命令：history<br>定制 history 的功能，可以通过命令历史的相关环境变量来实现。<br><strong>HISTSIZE</strong>：当前 shell 进程可以保存命令历史的条数<br><strong>HISTFILE</strong>：保存命令历史的文件<br><strong>HISTFILESIZE</strong>：命令历史文件的大小</p>
<p><strong>history 命令的用法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-r: 从命令历史文件中读取命令历史到命令历史列表</span><br><span class="line">-d + #: 指定删除命令历史</span><br><span class="line">-w: 从列表到文件</span><br><span class="line">-c: 清空命令历史列表</span><br><span class="line"></span><br><span class="line">!#: 执行命令历史列表中的第#命令</span><br><span class="line">!!: 再一次执行上一条命令</span><br><span class="line">!$: 调用上一个命令的最后一个参数</span><br><span class="line">！string: 再一次执行命令历史列表中最近一个以 string 打头的命令</span><br></pre></td></tr></table></figure>

<p><strong>控制命令历史的记录方式</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">环境变量：HISTCONTROL</span><br><span class="line">          ignoredups   忽略重复命令</span><br><span class="line">          ignorespace  忽略以空白开头的命令</span><br><span class="line">          ignoreboth   以上两者都生效</span><br><span class="line">          修改变量方法： 只在当前shell环境有效</span><br><span class="line">          NAM=&#x27;VALUE&#x27;</span><br><span class="line">          HISTCONTROL=&#x27;ignorespace&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="4-别名"><a href="#4-别名" class="headerlink" title="(4) 别名"></a>(4) 别名</h4><p>显示当前 shell 进程所有可用的命令别名：<strong>alias</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">定义别名NAME，其相当于执行命令VALUE：</span><br><span class="line">alias NAME=&#x27;VALUE&#x27;   </span><br><span class="line">.alias net=&#x27;vi /etc/sysconfig/network-scripts/ifcfg-eth0&#x27;</span><br></pre></td></tr></table></figure>

<p>在命令行中定义的别名，仅对当前 shell 进程有效；如果想永久有效，要定义在配置文件中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/bashrc  添加一行</span><br><span class="line">alias NAME=&#x27;VALUE&#x27;</span><br><span class="line">重载   source /etc/bashrc</span><br><span class="line">撤销别名   unalias NAME</span><br></pre></td></tr></table></figure>

<h4 id="5-通配符"><a href="#5-通配符" class="headerlink" title="(5) 通配符"></a>(5) 通配符</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">*     匹配任意长度的任意字符</span><br><span class="line">？      匹配任意单个字符</span><br><span class="line">[]     匹配指定范围内的任意单个字符</span><br><span class="line">[^]    匹配指定范围外的任意单个字符</span><br><span class="line">[0-9]  所有数字</span><br><span class="line">[a-z]  aAbB......z   </span><br><span class="line">[A-Z]  AbB......zZ</span><br><span class="line">[[:lower:]]   小写字母</span><br><span class="line">[[:upper:]]   大写字母</span><br><span class="line">[[:digit:]]   数字</span><br><span class="line">[[:alpha:]]   所有字母</span><br><span class="line">[[:punct:]]   标点符号</span><br><span class="line">[[:alnum:]]   数字+字母</span><br><span class="line">[[:space:]]   空白字符</span><br><span class="line">[^[:lower:]]  除小写字母</span><br></pre></td></tr></table></figure>

<h4 id="6-重定向"><a href="#6-重定向" class="headerlink" title="(6) 重定向"></a>(6) 重定向</h4><p>Linux 提供三种 IO 设备：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">STDIN        标准输入     0     默认来自于键盘</span><br><span class="line">STDOUT      标准输出     1   默认到终端窗口</span><br><span class="line">STDERR        标准错误     2   默认到终端窗口</span><br></pre></td></tr></table></figure>

<p>正确输出重定向：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">1&gt;</span><span class="bash">     把STDOUT重定向到文件</span></span><br><span class="line"><span class="meta">1&gt;</span><span class="bash">&gt;    在原有的内容上追加内容</span></span><br></pre></td></tr></table></figure>

<p>错误输出重定向：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">2&gt;</span><span class="bash">     把STDERR重定向到文件</span></span><br><span class="line"><span class="meta">2&gt;</span><span class="bash">&gt;    原有的基础上追加内容</span></span><br></pre></td></tr></table></figure>

<p>混合输出：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;&gt;     把所有的输出到文件</span><br><span class="line"><span class="meta">2&gt;</span><span class="bash">&amp;1   将标准错误输出重定向到标准输出</span></span><br><span class="line"><span class="meta">1&gt;</span><span class="bash">&amp;2   将标准输出输出重定向到标准错误</span></span><br></pre></td></tr></table></figure>

<p>特殊日志文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/dev/null   数据黑洞。不想要的数据都可以重定向给他</span><br><span class="line">/dev/zero   吐零机。可以提供无穷无尽的0</span><br></pre></td></tr></table></figure>

<h4 id="7-特殊符号"><a href="#7-特殊符号" class="headerlink" title="(7) 特殊符号"></a>(7) 特殊符号</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">|    管道符（把上一个命令的执行结果当作下一个命令的输入）</span><br><span class="line">.    在linux中代表当前目录</span><br><span class="line">..   在linux系统中代表上一级目录</span><br><span class="line">;    在linux中执行多条命令时可以用分号隔开，每个命令之间无不干扰，所有命令都会执行</span><br><span class="line">&#x27;&#x27;   单引号       强引用，所见即多的</span><br><span class="line">&quot;&quot;   双引号      若引用，可以实现命令替换</span><br><span class="line">&#123;&#125;   做扩展使用</span><br><span class="line">*    通配作用</span><br></pre></td></tr></table></figure>

<h1 id="二-Shell-编程基础"><a href="#二-Shell-编程基础" class="headerlink" title="二. Shell 编程基础"></a>二. Shell 编程基础</h1><h2 id="A-变量"><a href="#A-变量" class="headerlink" title="(A) 变量"></a>(A) 变量</h2><h3 id="a-变量名规则"><a href="#a-变量名规则" class="headerlink" title="(a) 变量名规则"></a>(a) 变量名规则</h3><p>(1) 名称定义要做到见名之意，且按照规则来，且不得引用保留关键字 (help命令查看保留关键字)</p>
<p>(2) 只能包含数据、字母、下划线</p>
<p>(3) 不能以数字开头</p>
<p>(4) 不能用标点符号</p>
<p>(5) 变量名严格区分大小写</p>
<h3 id="b-赋值与引用"><a href="#b-赋值与引用" class="headerlink" title="(b) 赋值与引用"></a>(b) 赋值与引用</h3><p>变量定义与赋值，注意变量与值之间不得有空格。bash 变量是弱类型，无需事先声明类型，是将声明和赋值同时进行。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ name=&#x27;Awei&#x27;</span><br><span class="line">tplink@ubuntu:~$ echo $&#123;name&#125;</span><br><span class="line">Awei</span><br><span class="line">tplink@ubuntu:~$ echo $name</span><br><span class="line">Awei</span><br></pre></td></tr></table></figure>

<h3 id="c-作用域"><a href="#c-作用域" class="headerlink" title="(c) 作用域"></a>(c) 作用域</h3><p>(1) 本地变量，只存在于当前的 shell 进程。局部变量，指在 <strong>shell 函数</strong> 或是 <strong>shell 脚本</strong> 中定义的变量。环境变量，也称全局变量，针对当前 shell 以及其任意子进程。</p>
<p>(2) 位置参数变量：用于 shell 脚本中传递的参数</p>
<p>(3) 特殊变量：shell 内置的特殊功效变量。</p>
<p>例如 <code>$?</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">? 的值含义</span></span><br><span class="line">0:     成功</span><br><span class="line">1-255: 错误码</span><br></pre></td></tr></table></figure>

<h3 id="d-单双引号"><a href="#d-单双引号" class="headerlink" title="(d) 单双引号"></a>(d) 单双引号</h3><p><strong>单引号变量，不识别特殊语法；双引号变量，能识别特殊语法。</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ name=&#x27;Awei&#x27;</span><br><span class="line">tplink@ubuntu:~$ name2=&#x27;$name&#x27;;name3=&quot;$name&quot;</span><br><span class="line">tplink@ubuntu:~$ echo $name2</span><br><span class="line"><span class="meta">$</span><span class="bash">name</span></span><br><span class="line">tplink@ubuntu:~$ echo $name3</span><br><span class="line">Awei</span><br></pre></td></tr></table></figure>

<h3 id="e-父子-shell"><a href="#e-父子-shell" class="headerlink" title="(e) 父子 shell"></a>(e) 父子 shell</h3><p>(1) 每次调用 bash/sh 解释器执行脚本，都会开启一个子 shell，因此不保留当前的 shell 变量。可以通过 pstree 命令检查进程树。</p>
<p>(2) 调用 source 或者点符号，是在当前 shell 环境加载脚本，因此会保留变量。</p>
<h3 id="f-环境变量设置"><a href="#f-环境变量设置" class="headerlink" title="(f) 环境变量设置"></a>(f) 环境变量设置</h3><p>环境变量一般指的是用 export 内置命令导出的变量，用于定义 shell 的运行环境、保证 shell 命令的正确执行。</p>
<p>shell 通过环境变量确定登录的用户名、PATH路径、文件系统等各种应用。</p>
<p>环境变量可以在命令行中临时创建，但是如果用户退出 shell 终端，变量即丢失。如果要永久生效，需要修改环境变量配置文件。</p>
<ul>
<li>用户个人配置文件 <code>~/.bash_profile</code>、远程登录用户特有文件 <code>~/.bashrc</code> </li>
<li>全局配置文件 <code>/etc/profile</code>、<code>/etc/bashrc</code>，且系统建议最好创建在 <code>/etc/profile.d/</code>，而非直接修改主文件。 </li>
</ul>
<p><strong>检查系统环境变量的命令</strong></p>
<ul>
<li>set，输出所有变量，包括全局变量、局部变量</li>
<li>env，只显示全局变量</li>
<li>declare，输出所有的变量，如同 set</li>
<li>export，显示和设置环境变量值</li>
</ul>
<p><strong>撤销环境变量</strong></p>
<ul>
<li>unset 变量名，删除变量或函数</li>
</ul>
<p><strong>设置只读变量</strong></p>
<ul>
<li>readonly，只有 shell 结束了，只读变量才会失效。</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ readonly name=&#x27;Awei&#x27;</span><br><span class="line">tplink@ubuntu:~$ name=&#x27;Alex&#x27;</span><br><span class="line">bash: name: readonly variable</span><br></pre></td></tr></table></figure>

<h3 id="g-特殊变量"><a href="#g-特殊变量" class="headerlink" title="(g) 特殊变量"></a>(g) 特殊变量</h3><p>shell 的特殊变量，通常用于脚本中或者函数传递参数使用。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">0:    获取shell脚本文件名,以及脚本路径</span></span><br><span class="line"><span class="meta">$</span><span class="bash">n:    获取shell脚本的第n个参数,n在1-9之间;大于9则需要写,<span class="variable">$&#123;10&#125;</span>,参数空格隔开</span></span><br><span class="line"><span class="meta">$</span><span class="bash"><span class="comment">#:    获取执行的shell脚本后面的参数总个数</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">*:    获取shell脚本所有参数,不加引号等用于<span class="variable">$@</span>作用</span></span><br><span class="line">&quot;$*&quot;:  加引号作用是,接收所有参数为单个字符串,即&quot;$1 $2 $3···&quot;</span><br><span class="line"><span class="meta">$</span><span class="bash">@:    不加引号,效果同$*</span></span><br><span class="line">&quot;$@&quot;:  加引号,是接收所有参数为独立字符串,即&quot;$1&quot; &quot;$2&quot; &quot;$3&quot; ···,空格保留</span><br></pre></td></tr></table></figure>

<h3 id="h-特殊状态变量"><a href="#h-特殊状态变量" class="headerlink" title="(h) 特殊状态变量"></a>(h) 特殊状态变量</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">?:    上一次命令执行状态返回值,0正确,非0失败</span></span><br><span class="line"><span class="meta">$</span><span class="bash">$:    当前shell脚本的进程号</span></span><br><span class="line"><span class="meta">$</span><span class="bash">!:    上一次后台进程的PID</span></span><br><span class="line"><span class="meta">$</span><span class="bash">_:    取得上一个命令的最后一个参数</span></span><br></pre></td></tr></table></figure>

<p>实例：设定脚本返回值</p>
<p>shell 脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="variable">$#</span> 获取参数个数,-ne 不等于,&amp;&amp; 并且</span></span><br><span class="line"></span><br><span class="line">[ $# -ne 2 ] &amp;&amp; &#123;</span><br><span class="line">    echo &quot;must be two args&quot;</span><br><span class="line">    exit 10 #终止程序运行,且返回状态码10提供给当前shell的$?变量</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;没毛病,就是2个参数&quot;</span><br></pre></td></tr></table></figure>

<p>脚本执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ bash test.sh Alex Awei Allen</span><br><span class="line">must be two args</span><br><span class="line">tplink@ubuntu:~$ echo $?</span><br><span class="line">10</span><br><span class="line">tplink@ubuntu:~$ bash test.sh Chen Sun</span><br><span class="line">没毛病,就是2个参数</span><br><span class="line">tplink@ubuntu:~$ echo $?</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<p>若要让命令在后台执行且日志写入到黑洞文件中，可使用nohup命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ nohup bash test.sh &amp; &gt; /dev/null</span><br><span class="line">[1] 237703</span><br><span class="line">tplink@ubuntu:~$ nohup: ignoring input and appending output to &#x27;nohup.out&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="B-基础内置-Shell-命令"><a href="#B-基础内置-Shell-命令" class="headerlink" title="(B) 基础内置 Shell 命令"></a>(B) 基础内置 Shell 命令</h2><p>bash 的一些基础内置命令：echo，eval，exec，export，read，shift</p>
<p><strong>(1) echo</strong></p>
<p>命令参数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-n:    不换行输出</span><br><span class="line">-e:    解析字符串中的特殊符号</span><br><span class="line"></span><br><span class="line">\n:    换行</span><br><span class="line">\r:    回车</span><br><span class="line">\t:    制表符,四个空格</span><br><span class="line">\b:    退格键</span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ echo -n Awei; echo -n Alex</span><br><span class="line">AweiAlextplink@ubuntu:~$ </span><br><span class="line"></span><br><span class="line">tplink@ubuntu:~$ echo -e &#x27;God bless you\nmy dear friend&#x27;</span><br><span class="line">God bless you</span><br><span class="line">my dear friend</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">打印命令 <span class="built_in">printf</span></span></span><br><span class="line">tplink@ubuntu:~$ printf &#x27;Hello\tI am\tAwei&#x27;</span><br><span class="line">Hello    I am    Awei</span><br></pre></td></tr></table></figure>

<p><strong>(2) eval</strong></p>
<p>eval：告知 shell 取出 eval 的参数，重新运算求出参数的内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ a=&#x27;123&#x27;</span><br><span class="line">tplink@ubuntu:~$ echo &#x27;$a&#x27;</span><br><span class="line"><span class="meta">$</span><span class="bash">a</span></span><br><span class="line">tplink@ubuntu:~$ eval echo &#x27;$a&#x27;</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><strong>(3) exec</strong></p>
<p>exec：不创建子进程，执行后续命令，且执行完毕后，自动 exit</p>
<p><strong>(4) export</strong></p>
<p>export：设置或显示环境变量</p>
<ul>
<li>语法格式</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export [-fnp] [name[=value] ···]</span><br></pre></td></tr></table></figure>

<ul>
<li>参数说明</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-f:    导出函数。使用该选项可以将一个函数导出为环境变量,使其在子进程中可用</span><br><span class="line">-n:    导出变量但不设置其值。使用该选项可以将一个变量导出为环境变量，但不改变其值</span><br><span class="line">-p:    显示所有导出的变量和函数。使用该选项可以显示当前shell中所有已导出的环境变量和函数</span><br><span class="line">name[=value]:  要导出的变量名和可选的赋值。可以同时导出多个变量。</span><br></pre></td></tr></table></figure>

<p><strong>(5) read</strong></p>
<p>read 可以读取键盘输入的字符。<br>read 命令从标准输入中读取一行，并把输入行的每个字段的值指定给 shell 变量，用 IFS (内部字段分隔符)变量中的字符作为分隔符。VariableName (变量名)参数指定给每一个字段的值，由 VariableName (变量名)参数指定的以此类推，直到最后一个字段。</p>
<ul>
<li>语法格式</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read [-rs] [-a ARRAY] [-d delim] [-n nchars] [-N nchars] [-p prompt] [-t timeout] [-u fd] [var_name1 var_name2 ···]</span><br></pre></td></tr></table></figure>

<p>如果没有指定任何 var_name，则分割后的所有字段都存储在特定变量 REPLY 中。</p>
<ul>
<li>参数说明</li>
</ul>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a array</td>
<td>把读取的数据赋值给数组 array，从下标 0 开始</td>
</tr>
<tr>
<td>-d delimiter</td>
<td>用字符串 delimiter 指定读取结束的位置，而不是一个换行符</td>
</tr>
<tr>
<td>-e</td>
<td>在获取用户输入的时候，对功能键进行编码转换，不会直接显示功能键对应的字符</td>
</tr>
<tr>
<td>-n num</td>
<td>读取 num 个字符，而不是整行字符</td>
</tr>
<tr>
<td>-p prompt</td>
<td>显示提示信息，提示内容为 prompt</td>
</tr>
<tr>
<td>-r</td>
<td>原样读取 (Raw mode)，不把反斜杠字符解释为转义字符</td>
</tr>
<tr>
<td>-s</td>
<td>静默模式 (Silent mode)，不会在屏幕上显示输入的字符</td>
</tr>
<tr>
<td>-t seconds</td>
<td>设置超时时间，单位为秒。</td>
</tr>
<tr>
<td>-u fd</td>
<td>使用文件描述符 fd 作为输入源，而不是标准输入，类似于重定向</td>
</tr>
</tbody></table>
<ul>
<li>用法实例</li>
</ul>
<p>(1) 从标准输入读取一行。把用户键入的第一个词存到变量 first 中，第二个词存到变量 last 中</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ read first last</span><br><span class="line">Awei Alex</span><br><span class="line">tplink@ubuntu:~$ echo $first</span><br><span class="line">Awei</span><br><span class="line">tplink@ubuntu:~$ echo $last</span><br><span class="line">Alex</span><br></pre></td></tr></table></figure>

<p>(2) 在指定时间内输入密码</p>
<p>shell 脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if</span><br><span class="line">    read -t 20 -sp &quot;Enter password in 20 seconds(once) &gt; &quot; pass1 &amp;&amp; printf &quot;\n&quot; &amp;&amp;  #第一次输入密码</span><br><span class="line">    read -t 20 -sp &quot;Enter password in 20 seconds(again)&gt; &quot; pass2 &amp;&amp; printf &quot;\n&quot; &amp;&amp;  #第二次输入密码</span><br><span class="line">    [ $pass1 == $pass2 ]  #判断两次输入的密码是否相等</span><br><span class="line">then</span><br><span class="line">    echo &quot;Valid password&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;Invalid password&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>脚本执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ . test.sh </span><br><span class="line">Enter password in 20 seconds(once) &gt; </span><br><span class="line">Enter password in 20 seconds(again)&gt; </span><br><span class="line">Valid password</span><br></pre></td></tr></table></figure>

<p><strong>(6) shift</strong></p>
<p>shift 命令用于对参数的移动 (左移)，通常用于在不知道传入参数个数的情况下依次遍历每个参数然后进行相应处理。</p>
<p>实例：依次读取输入的参数并打印参数个数</p>
<p>shell 脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">while [ $# != 0 ]; do</span><br><span class="line">      echo &quot;First arg is $1; arg amount is $#&quot;</span><br><span class="line">      shift</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>脚本执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ . test.sh a b c d</span><br><span class="line">First arg is a; arg amount is 4</span><br><span class="line">First arg is b; arg amount is 3</span><br><span class="line">First arg is c; arg amount is 2</span><br><span class="line">First arg is d; arg amount is 1</span><br></pre></td></tr></table></figure>

<p>由上可知，shift (shift 1) 命令每执行一次，变量的个数减一，而变量值提前一位 ( <code>$1</code> 变量被销毁，<code>$2</code> 就变成了 <code>$1</code>)。shift 会销毁参数。</p>
<h2 id="C-Shell-子串"><a href="#C-Shell-子串" class="headerlink" title="(C) Shell 子串"></a>(C) Shell 子串</h2><h3 id="a-变量子串"><a href="#a-变量子串" class="headerlink" title="(a) 变量子串"></a>(a) 变量子串</h3><p>变量子串语法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">&#123;变量&#125;:    返回变量值</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;<span class="comment">#变量&#125;:   返回变量长度,字符长度</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;变量:start&#125;:    返回变量offset数值之后的字符</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;变量:start:length&#125;:    提取offset之后的length限制的字符</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;变量<span class="comment">#word&#125;:     从变量开头删除最短匹配的word</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;变量<span class="comment">##word&#125;:    从变量开头删除最长匹配的word</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;变量%word&#125;:     从变量结尾删除最短匹配的word</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;变量%%word&#125;:    从变量结尾删除最长匹配的word</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;变量/pattern/string&#125;:    用string代替第一个匹配的pattern</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;变量//pattern/string&#125;:   用string代替所有的pattern</span></span><br></pre></td></tr></table></figure>

<p>用法实例</p>
<p>(1) 变量子串</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ name=&#x27;AlexAwei&#x27;</span><br><span class="line">tplink@ubuntu:~$ echo $&#123;name:4&#125;</span><br><span class="line">Awei</span><br><span class="line">tplink@ubuntu:~$ echo $&#123;name:4:2&#125;</span><br><span class="line">Aw</span><br></pre></td></tr></table></figure>

<p>(2) 统计命令执行的时长</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ for n in &#123;1..3&#125;;do str1=`seq -s &quot;:&quot; 10`;echo $str1;done</span><br><span class="line">1:2:3:4:5:6:7:8:9:10</span><br><span class="line">1:2:3:4:5:6:7:8:9:10</span><br><span class="line">1:2:3:4:5:6:7:8:9:10</span><br><span class="line"></span><br><span class="line">tplink@ubuntu:~$ time for n in &#123;1..3&#125;;do str1=`seq -s &quot;:&quot; 10`;echo $str1 &amp;&gt;/dev/null;done</span><br><span class="line"></span><br><span class="line">real    0m0.004s</span><br><span class="line">user    0m0.003s</span><br><span class="line">sys    0m0.000s</span><br></pre></td></tr></table></figure>

<p>注：</p>
<ol>
<li><code>seq -s &quot;:&quot; 10</code>：生成1-10的数字序列，并用 “:” 隔开数字</li>
<li><code>time</code> 用于打印一条命令或一个程序的执行时间</li>
<li><code>&amp;</code> 指后台执行，<code>&gt;</code> 指重定向 (以覆盖写入方式)</li>
</ol>
<h3 id="b-字符串处理"><a href="#b-字符串处理" class="headerlink" title="(b) 字符串处理"></a>(b) 字符串处理</h3><p> 字符串处理相关语法同上面提到的变量子串语法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ name=&#x27;abcABC123abcA&#x27;</span><br><span class="line">tplink@ubuntu:~$ echo $&#123;name#a*c&#125;</span><br><span class="line">ABC123abcA</span><br><span class="line">tplink@ubuntu:~$ echo $&#123;name##a*c&#125;</span><br><span class="line">A</span><br></pre></td></tr></table></figure>

<h2 id="D-扩展变量"><a href="#D-扩展变量" class="headerlink" title="(D) 扩展变量"></a>(D) 扩展变量</h2><h3 id="a-简介-1"><a href="#a-简介-1" class="headerlink" title="(a) 简介"></a>(a) 简介</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">如果parameter变量为空,返回word字符串</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;parameter:-word&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">2</span></span><br><span class="line"><span class="meta">#</span><span class="bash">如果parameter变量为空,则word赋值给接收者以及变量本身</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;parameter:=word&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">3</span></span><br><span class="line"><span class="meta">#</span><span class="bash">如果parameter变量为空,word当作stderr输出,否则输出变量值</span></span><br><span class="line"><span class="meta">#</span><span class="bash">用于设置变量为空导致错误时,返回的错误信息</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;parameter:?word&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">4</span></span><br><span class="line"><span class="meta">#</span><span class="bash">如果parameter变量为空,什么都不做,否则返回word</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;parameter:+word&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="b-实例"><a href="#b-实例" class="headerlink" title="(b) 实例"></a>(b) 实例</h3><p>(1) <code>:-</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ unset name</span><br><span class="line">tplink@ubuntu:~$ result=$&#123;name:-Hello&#125;</span><br><span class="line">tplink@ubuntu:~$ echo $name</span><br><span class="line"></span><br><span class="line">tplink@ubuntu:~$ echo $result</span><br><span class="line">Hello</span><br></pre></td></tr></table></figure>

<p>(2) <code>:=</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ unset name</span><br><span class="line">tplink@ubuntu:~$ result=$&#123;name:=Hello&#125;</span><br><span class="line">tplink@ubuntu:~$ echo $name</span><br><span class="line">Hello</span><br><span class="line">tplink@ubuntu:~$ echo $result</span><br><span class="line">Hello</span><br></pre></td></tr></table></figure>

<p>(3) <code>:?</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ unset name</span><br><span class="line">tplink@ubuntu:~$ result=$&#123;name:?This para is null&#125;</span><br><span class="line">bash: name: This para is null</span><br></pre></td></tr></table></figure>

<p>(4) <code>:+</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ unset name</span><br><span class="line">tplink@ubuntu:~$ result=$&#123;name:+Hello&#125;</span><br><span class="line">plink@ubuntu:~$ echo $result</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="E-父子-shell"><a href="#E-父子-shell" class="headerlink" title="(E) 父子 shell"></a>(E) 父子 shell</h2><h3 id="a-概述"><a href="#a-概述" class="headerlink" title="(a) 概述"></a>(a) 概述</h3><p>执行脚本的方式会导致是否产生子 shell</p>
<p>(1) source 和点，执行脚本，只在当前的 shell 环境中执行生效。不产生子 shell</p>
<p>(2) 指定 bash sh 解释器运行脚本，会开启 subshell</p>
<p>(3) <code>./script</code> 指定路径运行脚本，会指定 shebang，通过解释器运行，会开启 subshell</p>
<p>可以通过 <code>ps -ef --forest</code> 命令，查看父子 shell 的关系。输入 exit 即可退出 subshell 环境。</p>
<h3 id="b-创建进程列表"><a href="#b-创建进程列表" class="headerlink" title="(b) 创建进程列表"></a>(b) 创建进程列表</h3><p><strong>(1) 进程列表</strong></p>
<p>shell 的进程列表理念，需要使用 <code>()</code> 小括号。如下执行方式，就称之为进程列表</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(cd ~;pwd;ls;cd /tmp/;pwd;ls)</span><br></pre></td></tr></table></figure>

<p><strong>(2) 检测是否在子 shell 环境中</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BASH_SUBSHELL</span><br><span class="line"><span class="meta">#</span><span class="bash">这是Linux默认的有关shell的变量。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">如果该变量值为0就是在当前shell环境中执行的,否则就是开启子shell运行的。</span></span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ (cd ~;pwd;ls;cd /tmp/;pwd;ls;echo $BASH_SUBSHELL)</span><br><span class="line">/home/tplink</span><br><span class="line">Desktop    Downloads  Pictures  Templates  Videos</span><br><span class="line">Documents  Music      Public    test.sh</span><br><span class="line">/tmp</span><br><span class="line">config-err-FU2wc8</span><br><span class="line">snap-private-tmp</span><br><span class="line">ssh-W1fiK6VCeYvI</span><br><span class="line">systemd-private-50a203bfe2ee450e8a4bbce9b1fbe51f-colord.service-47LZdf</span><br><span class="line">systemd-private-50a203bfe2ee450e8a4bbce9b1fbe51f-ModemManager.service-gLKWIf</span><br><span class="line">systemd-private-50a203bfe2ee450e8a4bbce9b1fbe51f-switcheroo-control.service-qDHgfg</span><br><span class="line">systemd-private-50a203bfe2ee450e8a4bbce9b1fbe51f-systemd-logind.service-FDGISe</span><br><span class="line">systemd-private-50a203bfe2ee450e8a4bbce9b1fbe51f-systemd-resolved.service-hs0Q4f</span><br><span class="line">systemd-private-50a203bfe2ee450e8a4bbce9b1fbe51f-systemd-timesyncd.service-ze0x4h</span><br><span class="line">systemd-private-50a203bfe2ee450e8a4bbce9b1fbe51f-upower.service-hved7e</span><br><span class="line">tracker-extract-files.1000</span><br><span class="line">tracker-extract-files.125</span><br><span class="line">VMwareDnD</span><br><span class="line">vmware-root_572-2999067484</span><br><span class="line">1  #值非0,说明开启是开启子shell运行的</span><br></pre></td></tr></table></figure>

<p><strong>(3) 子 shell 嵌套运行</strong></p>
<p>之前是一个小括号，开启一个子 shell 运行命令，还可以嵌套多个。例如</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(pwd;(echo $BASH_SUBSHELL))</span><br></pre></td></tr></table></figure>

<p>在 shell 脚本开发中，经常会用子 shell 进行多进程的处理，提高程序并发执行效率。</p>
<p><strong>(4) 内置与外置命令</strong></p>
<p>内置命令：Linux 内置命令，在系统启动时就加载入内存，常驻内存，执行效率更高，但是占用资源。</p>
<p>外置命令：用户需要从硬盘中读取程序文件，再读入内存加载。<br>通常外置命令是用户单独下载的文件系统命令，是处于 bash shell 之外的程序。</p>
<p>内置命令是 shell 的一部分，不会产生子 shell 去执行；外置命令一定会开启子 shell 运行。</p>
<p>可以通过 Linux 的 <code>type</code> 命令，验证是否是内置、外置命令。可以通过 <code>compgen -b</code> 查看 Linux 内置的 shell 命令。</p>
<h2 id="F-函数"><a href="#F-函数" class="headerlink" title="(F) 函数"></a>(F) 函数</h2><p>Shell 中的函数需要先定义再使用，例如</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sayHello()&#123;</span><br><span class="line">    echo &quot;Hello World&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sayHello</span><br></pre></td></tr></table></figure>

<h3 id="a-函数定义"><a href="#a-函数定义" class="headerlink" title="(a) 函数定义"></a>(a) 函数定义</h3><p><strong>规范版本</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function 函数名()&#123;</span><br><span class="line">    函数体</span><br><span class="line">    return 返回值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>简化版本1</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">使用<span class="keyword">function</span>关键字时,可以省略括号</span></span><br><span class="line">function 函数名&#123;</span><br><span class="line">    函数体</span><br><span class="line">    return 返回值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>简化版本2</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">省略<span class="keyword">function</span>关键字时,必须有括号</span></span><br><span class="line">函数名()&#123;</span><br><span class="line">    函数体</span><br><span class="line">    return 返回值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="b-函数执行"><a href="#b-函数执行" class="headerlink" title="(b) 函数执行"></a>(b) 函数执行</h3><p>有关函数执行的基础概念：</p>
<ol>
<li>执行 shell 函数，直接写函数名即可，无需添加其他内容</li>
<li>函数必须先定义，再执行，shell 脚本自上而下加载</li>
<li>函数体内定义的变量，称为局部变量。函数内可以使用 local 关键字定义局部变量</li>
<li>函数如果单独写入一个文件里而没写执行语句，则可以用 source 读取</li>
<li>函数体内需要添加 return 语句，作用是退出函数，且将返回值赋给调用该函数的程序</li>
<li>return 语句是结束函数的执行，返回一个值；exit 是结束 shell 环境，返回一个值给当前的 shell</li>
</ol>
<h1 id="三-Shell-数学运算"><a href="#三-Shell-数学运算" class="headerlink" title="三. Shell 数学运算"></a>三. Shell 数学运算</h1><h2 id="A-概述"><a href="#A-概述" class="headerlink" title="(A) 概述"></a>(A) 概述</h2><p><strong>(1) Shell 中常见的算术运算符号</strong></p>
<table>
<thead>
<tr>
<th>算术运算符</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>+、-</td>
<td>加法 (或正号)、减法 (或负号)</td>
</tr>
<tr>
<td>*、/、%</td>
<td>乘法、除法、取余 (取模)</td>
</tr>
<tr>
<td>**</td>
<td>幂运算</td>
</tr>
<tr>
<td>++、–</td>
<td>增加及减少，可前置也可放在变量结尾</td>
</tr>
<tr>
<td>!、&amp;&amp;、||</td>
<td>逻辑非 (取反)、逻辑与 (and)、逻辑或 (or)</td>
</tr>
<tr>
<td>&lt;、&lt;=、&gt;、&gt;=</td>
<td>比较符号 (小于、小于等于、大于、大于等于)</td>
</tr>
<tr>
<td>==、!=、=</td>
<td>比较符号 (相等、不相等、对于字符串“=”也可以表示相当于)</td>
</tr>
<tr>
<td>&lt;&lt;、&gt;&gt;</td>
<td>向左移位、向右移位</td>
</tr>
<tr>
<td>~、|、&amp;、^</td>
<td>按位取反、按位异或、按位与、按位或</td>
</tr>
<tr>
<td>=、+=、-=、*=、/=、%=</td>
<td>赋值运算符，例如a+=1相当于a=a+1</td>
</tr>
</tbody></table>
<p><strong>(2) Shell 中常见的算术运算命令</strong></p>
<table>
<thead>
<tr>
<th>运算操作符与运算命令</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>(())</td>
<td>用于整数运算的常用运算符，效率奇高</td>
</tr>
<tr>
<td>let</td>
<td>用于整数运算，类似于“(())”</td>
</tr>
<tr>
<td>expr</td>
<td>可用于整数运算，但还有很多其他的额外功能</td>
</tr>
<tr>
<td>bc</td>
<td>Linux 下的一个计算器程序 (适合整数和小数运算)</td>
</tr>
<tr>
<td>$[]</td>
<td>用于整数运算</td>
</tr>
<tr>
<td>awk</td>
<td>awk 既可以用于整数运算，也可以用于小数运算</td>
</tr>
<tr>
<td>declare</td>
<td>定义变量值和属性，-i 参数可以用于定义整形变量，做运算</td>
</tr>
</tbody></table>
<h2 id="B-详解"><a href="#B-详解" class="headerlink" title="(B) 详解"></a>(B) 详解</h2><h3 id="a-双小括号"><a href="#a-双小括号" class="headerlink" title="(a) 双小括号"></a>(a) 双小括号</h3><h4 id="1-使用方法"><a href="#1-使用方法" class="headerlink" title="(1) 使用方法"></a>(1) 使用方法</h4><p><strong>双小括号的使用方法</strong></p>
<table>
<thead>
<tr>
<th>运算操作符与运算命令</th>
<th>意义</th>
</tr>
</thead>
<tbody><tr>
<td>((i=i+1))</td>
<td>此种书写方法为运算后赋值法，即将 i+1 的运算结果赋值给变量 i。注意，不能用 “echo ((i=i+1))” 的形式输出表达式的值，但可以用 echo $((i=i+1)) 输出其值</td>
</tr>
<tr>
<td>i=$((i+1))</td>
<td>可以在 “(())” 前加 $ 符，表示将表达式运算后赋值给 i</td>
</tr>
<tr>
<td>((8&gt;7&amp;&amp;5==5))</td>
<td>可以进行比较操作，还可以加入逻辑与和逻辑或，用于条件判断</td>
</tr>
<tr>
<td>echo $((2+1))</td>
<td>需要直接输出运算表达式的运算结果时，可以在 “(())” 前加 $ 符</td>
</tr>
</tbody></table>
<h4 id="2-实例"><a href="#2-实例" class="headerlink" title="(2) 实例"></a>(2) 实例</h4><p><strong>(1) 简单使用</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">有关逻辑运算,真为1,假为0</span></span><br><span class="line">tplink@ubuntu:~$ echo $((8&gt;7))</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">tplink@ubuntu:~$ echo $((3+4))</span><br><span class="line">7</span><br><span class="line">tplink@ubuntu:~$ echo $((10/3))</span><br><span class="line">3</span><br></pre></td></tr></table></figure>

<p><strong>(2) 数值计算脚本</strong></p>
<p>shell 脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">print_usage()&#123;</span><br><span class="line">    printf &quot;Please enter an interger!\n&quot;</span><br><span class="line">    exit 1  #若脚本正确执行,则赋予退出状态码为1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">read -p &quot;Please input your number: &quot; firstnum  #-p 参数后接给用户看的信息</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">-n,对字符串判断,若字符串为空,则条件不成立</span></span><br><span class="line"><span class="meta">#</span><span class="bash">这里的sed语句把用户输入的字符串中的数字都替换为空,那么剩下的就是非数字的内容,/g表示全局替换</span></span><br><span class="line">if [ -n &quot;`echo $firstnum|sed &#x27;s/[0-9]//g&#x27;`&quot; ]</span><br><span class="line">    then</span><br><span class="line">        print_usage</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">read -p &quot;Please input your operator: &quot; operator</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">限制运算符为加减乘除</span></span><br><span class="line">if [ &quot;$&#123;operator&#125;&quot; != &quot;+&quot; ] &amp;&amp; [ &quot;$&#123;operator&#125;&quot; != &quot;-&quot; ] &amp;&amp; [ &quot;$&#123;operator&#125;&quot; != &quot;*&quot; ] &amp;&amp; [ &quot;$&#123;operator&#125;&quot; != &quot;/&quot; ]</span><br><span class="line">    then</span><br><span class="line">        echo &quot;only allow input + - * /&quot;</span><br><span class="line">        exit 2</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">read -p &quot;Please input second number: &quot; secondnum</span><br><span class="line"></span><br><span class="line">if [ -n &quot;`echo $secondnum|sed &#x27;s/[0-9]//g&#x27;`&quot; ]</span><br><span class="line">    then</span><br><span class="line">        print_usage</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">利用双小括号进行数值计算</span></span><br><span class="line">echo &quot;$&#123;firstnum&#125;$&#123;operator&#125;$&#123;secondnum&#125; result is $(($&#123;firstnum&#125;$&#123;operator&#125;$&#123;secondnum&#125;))&quot;</span><br></pre></td></tr></table></figure>

<p>脚本执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ bash test.sh </span><br><span class="line">Please input your number: 2 </span><br><span class="line">Please input your operator: *</span><br><span class="line">Please input second number: 4</span><br><span class="line">2*4 result is 8</span><br></pre></td></tr></table></figure>

<h3 id="b-let"><a href="#b-let" class="headerlink" title="(b) let"></a>(b) let</h3><p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">不加<span class="built_in">let</span>的情形</span></span><br><span class="line">tplink@ubuntu:~$ num=4</span><br><span class="line">tplink@ubuntu:~$ num=num+4</span><br><span class="line">tplink@ubuntu:~$ echo $num</span><br><span class="line">num+4</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">使用<span class="built_in">let</span></span></span><br><span class="line">tplink@ubuntu:~$ num=4</span><br><span class="line">tplink@ubuntu:~$ let num=num+4</span><br><span class="line">tplink@ubuntu:~$ echo $num</span><br><span class="line">8</span><br></pre></td></tr></table></figure>

<h3 id="c-expr"><a href="#c-expr" class="headerlink" title="(c) expr"></a>(c) expr</h3><p><strong>(1) 数值计算</strong></p>
<p>expr 命令用于数值计算时，基于空格传入参数，对于运算符还要加上转义字符。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ expr 5 \* 3</span><br><span class="line">15</span><br><span class="line"></span><br><span class="line">tplink@ubuntu:~$ expr 5 \+ 3</span><br><span class="line">8</span><br><span class="line"></span><br><span class="line">tplink@ubuntu:~$ expr length abcd</span><br><span class="line">4</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">逻辑判断,真为1,假为0</span></span><br><span class="line">tplink@ubuntu:~$ expr 8 \&gt; 9</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<p><strong>(2) 模式匹配</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">expr命令也支持模式匹配功能</span><br><span class="line"></span><br><span class="line">两个特殊符号</span><br><span class="line">:   冒号,计算字符串的字符数量</span><br><span class="line">.*  任意的字符串重复0次或多次</span><br><span class="line"></span><br><span class="line">语法</span><br><span class="line">expr 字符串 &quot;:&quot; &quot;.*&quot;</span><br></pre></td></tr></table></figure>

<p>例如判断字符串的字符个数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ expr test.png &quot;:&quot; &quot;.*&quot;</span><br><span class="line">8</span><br></pre></td></tr></table></figure>

<p><strong>判断文件名后缀脚本</strong></p>
<p>执行脚本，传入一个文件名，然后判断该文件是否是jpg文件</p>
<p>shell 脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">if expr &quot;$1&quot; &quot;:&quot; &quot;.*\.jpg&quot; &amp;&gt; /dev/null</span><br><span class="line">    then</span><br><span class="line">        echo &quot;This is indeed a file that ends in jpg&quot;</span><br><span class="line">else</span><br><span class="line">    echo &quot;This file does not end in jpg&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p>脚本执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ bash test.sh cxk.png</span><br><span class="line">This file does not end in jpg</span><br></pre></td></tr></table></figure>

<h3 id="d-bc"><a href="#d-bc" class="headerlink" title="(d) bc"></a>(d) bc</h3><p>可以使用 bc 命令结合管道符进行数值计算。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ echo &quot;4.2*4&quot; | bc</span><br><span class="line">16.8</span><br></pre></td></tr></table></figure>

<p><strong>实例</strong></p>
<p>计算“1+2+3+······+99+100”的值</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ echo `seq -s &quot;+&quot; 100 | bc`</span><br><span class="line">5050</span><br></pre></td></tr></table></figure>

<h3 id="e-awk-计算"><a href="#e-awk-计算" class="headerlink" title="(e) awk 计算"></a>(e) awk 计算</h3><p>awk 也支持小数计算</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ echo &quot;3.2 2.2&quot; | awk &#x27;&#123;print $1+$2&#125;&#x27;</span><br><span class="line">5.4</span><br></pre></td></tr></table></figure>

<h3 id="f-中括号计算"><a href="#f-中括号计算" class="headerlink" title="(f) 中括号计算"></a>(f) 中括号计算</h3><p>语法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">[表达式]</span></span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ num=5</span><br><span class="line">tplink@ubuntu:~$ res=$[num+4]</span><br><span class="line">tplink@ubuntu:~$ echo $res</span><br><span class="line">9</span><br></pre></td></tr></table></figure>

<h1 id="四-Shell-条件测试"><a href="#四-Shell-条件测试" class="headerlink" title="四. Shell 条件测试"></a>四. Shell 条件测试</h1><p>Shell 测试语法，最常用的是 test 命令和单中括号 [ ]</p>
<p><strong>条件测试常用语法</strong></p>
<table>
<thead>
<tr>
<th>条件测试语法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>test &lt;测试表达式&gt;</td>
<td>这是利用 test 命令进行条件测试表达式的方法。<br />test 命令和 “&lt;测试表达式&gt;” 之间至少有一个空格。</td>
</tr>
<tr>
<td>[ &lt;测试表达式&gt; ]</td>
<td>这是通过 [] 单中括号进行条件测试表达式的方法，和 test 命令的用法相同。<br />注意，[] 的边界和内容之间至少有一个空格。</td>
</tr>
<tr>
<td>[[ &lt;测试表达式&gt; ]]</td>
<td>这是通过双中括号进行条件测试表达式的方法，是一种比 test [] 更新的语法。<br />[[]] 的边界和内容之间至少有一个空格。</td>
</tr>
<tr>
<td>((&lt;测试表达式&gt;))</td>
<td>这是通过双小括号进行条件测试表达式的方法，一般用于 if 语句中。<br />双小括号两端不需要空格。</td>
</tr>
</tbody></table>
<p><strong>条件测试符号用法参考</strong></p>
<table>
<thead>
<tr>
<th>测试表达式符号</th>
<th>[]</th>
<th>test</th>
<th>[[]]</th>
<th>(())</th>
</tr>
</thead>
<tbody><tr>
<td>边界是否需要空格</td>
<td>需要</td>
<td>需要</td>
<td>需要</td>
<td>不需要</td>
</tr>
<tr>
<td>逻辑操作符</td>
<td>!，-a，-o</td>
<td>!，-a，-o</td>
<td>!，&amp;&amp;，||</td>
<td>!，&amp;&amp;，||</td>
</tr>
<tr>
<td>整数比较操作符</td>
<td>-eq，-gt，-lt，-ge，-le</td>
<td>-eq，-gt，-lt，-ge，-le</td>
<td>-eq，-gt，-lt，-ge，-le 或 =，&gt;，&lt;，&gt;=，&lt;=</td>
<td>=，&gt;，&lt;，&gt;=，&lt;=</td>
</tr>
<tr>
<td>字符串比较操作符</td>
<td>=，==，!=</td>
<td>=，==，!=</td>
<td>=，==，!=</td>
<td>=，==，!=</td>
</tr>
<tr>
<td>是否支持通配符匹配</td>
<td>不支持</td>
<td>不支持</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody></table>
<h2 id="A-test-条件测试"><a href="#A-test-条件测试" class="headerlink" title="(A) test 条件测试"></a>(A) test 条件测试</h2><p> test 命令评估一个表达式的结果真假，若为真，则命令执行状态码结果为 0，否则不为 0。通过 <code>$?</code> 取值。</p>
<p>简单演示：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ test -e test.sh     #判断文件test.sh是否存在</span><br><span class="line">tplink@ubuntu:~$ echo $?</span><br><span class="line">0     #状态码为0,说明文件存在</span><br></pre></td></tr></table></figure>

<h3 id="a-test-语法参数大全"><a href="#a-test-语法参数大全" class="headerlink" title="(a) test 语法参数大全"></a>(a) test 语法参数大全</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">1.关于某个文件名的“类型”侦测存在与否,如 test -e filename</span><br><span class="line"></span><br><span class="line">-e:  该文件名是否存在</span><br><span class="line">-f:  该文件名是否为文件(file)</span><br><span class="line">-d:  该文件名是否为目录(directory)</span><br><span class="line">-b:  该文件名是否为一个block device装置</span><br><span class="line">-c:  该文件名是否为一个character device装置</span><br><span class="line">-S:  该文件名是否为一个Socket文件</span><br><span class="line">-p:  该文件名是否为一个FIFO(pipe)文件</span><br><span class="line">-L:  该文件名是否为一个连结档</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2.关于文件的权限侦测,如 test -r filename</span><br><span class="line"></span><br><span class="line">-r:  侦测该文件名是否具有“可读”的属性</span><br><span class="line">-w:  侦测该文件名是否具有“可写”的属性</span><br><span class="line">-x:  侦测该文件名是否具有“可执行”的属性</span><br><span class="line">-u:  侦测该文件名是否具有“SUID”的属性</span><br><span class="line">-g:  侦测该文件名是否具有“SGID”的属性</span><br><span class="line">-k:  侦测该文件名是否具有“Sticky bit”的属性</span><br><span class="line">-s:  侦测该文件名是否为“非空白文件”</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3.两个文件之间的比较,如 test file1 -nt file2</span><br><span class="line"></span><br><span class="line">-nt:  newer than,判断file1是否比file2新</span><br><span class="line">-ot:  older than,判断file1是否比file2旧</span><br><span class="line">-ef:  判断file1和file2是否为同一文件,可用在判断hard link的判定上。</span><br><span class="line">      主要意义在于判定两个文件是否均指向同一个inode</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">4.关于两个整数之间的判定,例如 test n1 -eq n2</span><br><span class="line"></span><br><span class="line">-eq:  两数值相等,equal</span><br><span class="line">-ne:  两数值不等,not equal</span><br><span class="line">-gt:  n1大于n2,greater than</span><br><span class="line">-lt:  n1小于n2,less than</span><br><span class="line">-ge:  n1大于等于n2,greater than or equal</span><br><span class="line">-le:  n1小于等于n2,less than or equal</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">5.判定字符串的数据</span><br><span class="line"></span><br><span class="line">test -z string:  判定字符串是否为空。若string为空字符串,则为true</span><br><span class="line">test -n string:  判断字符串是否为非空。若string为空字符串,则为false</span><br><span class="line">注: -n亦可省略</span><br><span class="line">test str1 = str2:  判定str1是否等于str2,若相等,则回传true</span><br><span class="line">test str1 != str2:  判定str1是否不等于str2,若相等,则回传false</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">6.多重条件判定,例如 test -r file -a -x file</span><br><span class="line"></span><br><span class="line">-a:  and,两状况同时成立。例如 test -r file -a -x file,则file同时具有r与x权限时,才回传true</span><br><span class="line">-o:  or,两状况任何一个成立。例如 test -r file -o -x file,则file具有r或x权限时,就可回传true</span><br><span class="line">!:   反相状态。如 test ! -x file,当file不具有x时,回传true</span><br></pre></td></tr></table></figure>

<h3 id="b-test-命令实践"><a href="#b-test-命令实践" class="headerlink" title="(b) test 命令实践"></a>(b) test 命令实践</h3><p>配合 <code>&amp;&amp;</code> 与 <code>||</code> </p>
<p>语法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A条件 &amp;&amp; B条件:    当A条件成立,执行B条件</span><br><span class="line">A条件 || B条件:    当A条件不成立时,才执行B条件</span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ test -e test.sh &amp;&amp; echo &quot;This file exits&quot;</span><br><span class="line">This file exits</span><br><span class="line">tplink@ubuntu:~$ test ! -e test.sh &amp;&amp; echo &quot;This file not exist&quot;</span><br><span class="line">tplink@ubuntu:~$ </span><br><span class="line">tplink@ubuntu:~$ test ! -e test.sh || echo &quot;This file exists&quot;</span><br><span class="line">This file exists</span><br></pre></td></tr></table></figure>

<h2 id="B-单中括号"><a href="#B-单中括号" class="headerlink" title="(B) 单中括号"></a>(B) 单中括号</h2><h3 id="a-语法讲解"><a href="#a-语法讲解" class="headerlink" title="(a) 语法讲解"></a>(a) 语法讲解</h3><p>脚本中进行条件测试，用的最多的，是单中括号 <code>[]</code>，test 和 <code>[]</code> 的作用是一样的。<strong>需要注意的是，中括号中，前后的空格必须有。注意，条件测试中若使用变量，必须加双引号</strong>，例如</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[-n &quot;$var_name&quot;]</span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ file=&#x27;test.sh&#x27;    #这里文件夹下存在test.sh</span><br><span class="line">tplink@ubuntu:~$ [ -f &quot;$&#123;file&#125;&quot; ] &amp;&amp; echo ok || echo no</span><br><span class="line">ok</span><br></pre></td></tr></table></figure>

<p><strong>注意，在中括号中使用数学比较符，请添加转义符号</strong>。例如</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">不加转义符</span></span><br><span class="line">tplink@ubuntu:~$ [ 1 &gt; 2 ] &amp;&amp; echo yes || echo no</span><br><span class="line">yes</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">加转义符</span></span><br><span class="line">tplink@ubuntu:~$ [ 1 \&gt; 2 ] &amp;&amp; echo yes || echo no</span><br><span class="line">no</span><br></pre></td></tr></table></figure>

<h3 id="b-脚本实例"><a href="#b-脚本实例" class="headerlink" title="(b) 脚本实例"></a>(b) 脚本实例</h3><p>要求：接收用户输入，判断它是否等于数字 1 或 2。</p>
<p>shell 脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">read -p &quot;Pls input a char: &quot; var</span><br><span class="line"></span><br><span class="line">[ &quot;$var&quot; -eq &quot;1&quot; -o &quot;$var&quot; -eq &quot;2&quot; ]  &amp;&amp; &#123;</span><br><span class="line">    echo $var</span><br><span class="line">    exit 0</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[ &quot;$var&quot; != &quot;1&quot; -a &quot;$var&quot; != &quot;2&quot; ] &amp;&amp; &#123;</span><br><span class="line">    echo &quot;must input 1 or 2&quot;</span><br><span class="line">    exit 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>脚本执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ bash test.sh</span><br><span class="line">Pls input a char: 3</span><br><span class="line">must input 1 or 2</span><br></pre></td></tr></table></figure>

<h1 id="五-选择与循环"><a href="#五-选择与循环" class="headerlink" title="五. 选择与循环"></a>五. 选择与循环</h1><h2 id="A-选择语句"><a href="#A-选择语句" class="headerlink" title="(A) 选择语句"></a>(A) 选择语句</h2><h3 id="a-单分支-if"><a href="#a-单分支-if" class="headerlink" title="(a) 单分支 if"></a>(a) 单分支 if</h3><p><strong>语法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">规范版本</span></span><br><span class="line">if  &lt;条件表达式&gt;</span><br><span class="line">    then</span><br><span class="line">        条件为真执行语句</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">简化版本</span></span><br><span class="line">if  &lt;条件表达式&gt;;then</span><br><span class="line">    条件为真执行语句</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<p><strong>实例</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tplink@ubuntu:~$ if [ -e test.sh ];then echo &quot;this file exists&quot;;fi</span><br><span class="line">this file exists</span><br></pre></td></tr></table></figure>

<h3 id="b-if···else"><a href="#b-if···else" class="headerlink" title="(b) if···else"></a>(b) if···else</h3><p><strong>语法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if  &lt;条件表达式&gt;</span><br><span class="line">    then</span><br><span class="line">        条件为真执行语句</span><br><span class="line">else</span><br><span class="line">    条件为假执行语句</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h3 id="c-多分支处理"><a href="#c-多分支处理" class="headerlink" title="(c) 多分支处理"></a>(c) 多分支处理</h3><p><strong>语法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">if  &lt;条件表达式1&gt;</span><br><span class="line">    then</span><br><span class="line">        条件1为真执行语句</span><br><span class="line">elif  &lt;条件表达式2&gt;</span><br><span class="line">    then</span><br><span class="line">        条件2为真执行语句</span><br><span class="line">elif  &lt;条件表达式3&gt;</span><br><span class="line">    then</span><br><span class="line">        条件3为真执行语句</span><br><span class="line">else</span><br><span class="line">    以上条件都不成立执行语句</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

<h3 id="d-case-语句"><a href="#d-case-语句" class="headerlink" title="(d) case 语句"></a>(d) case 语句</h3><p> <strong>语法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">case $变量名 in</span><br><span class="line">    &quot;值1&quot;)</span><br><span class="line">        如果变量的值为1,则执行的语句</span><br><span class="line">        ;;</span><br><span class="line">    &quot;值2&quot;)</span><br><span class="line">        如果变量的值为2,则执行的语句</span><br><span class="line">        ;;</span><br><span class="line">    ···省略其他分支</span><br><span class="line">    *)</span><br><span class="line">        如果变量的值都不是以上的值,则执行的语句</span><br><span class="line">        ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<p><strong>实例</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">echo &quot;if want apple, input 1&quot;</span><br><span class="line">echo &quot;if want pear, input 2&quot;</span><br><span class="line">echo &quot;if want orange, input 3&quot;</span><br><span class="line"></span><br><span class="line">read -p &quot;Please input your choice: &quot; choose</span><br><span class="line"></span><br><span class="line">case &quot;$choose&quot; in</span><br><span class="line">    &quot;1&quot;)</span><br><span class="line">        echo &quot;apple&quot;</span><br><span class="line">        ;;</span><br><span class="line">    &quot;2&quot;)</span><br><span class="line">        echo &quot;pear&quot;</span><br><span class="line">        ;;</span><br><span class="line">    &quot;3&quot;)</span><br><span class="line">        echo &quot;orange&quot;</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        echo &quot;Please input 1 or 2 or 3&quot;</span><br><span class="line">        ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>

<h2 id="B-循环语句"><a href="#B-循环语句" class="headerlink" title="(B) 循环语句"></a>(B) 循环语句</h2><h3 id="a-for-语句"><a href="#a-for-语句" class="headerlink" title="(a) for 语句"></a>(a) for 语句</h3><p><strong>(1) 语法一：for 变量名 in {list}</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for 变量名 in &#123;list&#125;</span><br><span class="line">do</span><br><span class="line">    command</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p>实例</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for i in &#123;1..5&#125;</span><br><span class="line">do</span><br><span class="line">    echo $i</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><strong>技巧</strong></p>
<p>花括号 <code>&#123;&#125;</code> 和 <code>seq</code> 在 for 循环中的应用</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for i in &#123;1..50..2&#125;:      1-50的奇数</span><br><span class="line">for i in &#123;2..50..2&#125;:      1-50的偶数</span><br><span class="line">for i in &#123;10..1&#125;:         1-10倒序排列</span><br><span class="line">for i in $(seq 10):       1-10正序排列</span><br><span class="line">for i in $(seq 10 -1 1):  1-10倒序排列</span><br><span class="line">for i in $(seq 1 2 10):   1-10的奇数,中间为步长</span><br><span class="line">for i in $(seq 0 2 10):   1-10的偶数,中间为步长</span><br></pre></td></tr></table></figure>

<p><strong>(2) 语法二：for ((expr1;expr2;expr3))</strong></p>
<p><strong>语法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">for ((expr1;expr2;expr3))</span><br><span class="line">do</span><br><span class="line">    command</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">expr1:  定义变量并赋初值</span><br><span class="line">expr2:  决定循环的终值</span><br><span class="line">expr3:  决定循环变量如何变化,决定什么时候退出循环</span><br></pre></td></tr></table></figure>

<p><strong>实例</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!bin/bash</span></span><br><span class="line"></span><br><span class="line">sum=0</span><br><span class="line">for ((i=1;i&lt;=100;i+=2))</span><br><span class="line">do</span><br><span class="line">    let sum=$sum+$i</span><br><span class="line">done</span><br><span class="line">echo &quot;1-100的奇数和为: $sum&quot;</span><br></pre></td></tr></table></figure>

<h3 id="b-while-语句"><a href="#b-while-语句" class="headerlink" title="(b) while 语句"></a>(b) while 语句</h3><p>while 循环一般用于有条件判断的循环，若判断条件为真，则进入循环；当条件为假就跳出循环</p>
<p><strong>语法</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while 表达式</span><br><span class="line">do</span><br><span class="line">    command</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

<p><strong>实例</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">i=1</span><br><span class="line">while [ $i -le 5 ]</span><br><span class="line">do</span><br><span class="line">    echo $i</span><br><span class="line">    let i++</span><br><span class="line">done</span><br></pre></td></tr></table></figure>






    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Shell/" rel="tag"># Shell</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/08/20/pytest/" rel="prev" title="Pytest使用指南">
      <i class="fa fa-chevron-left"></i> Pytest使用指南
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Minwei Chen</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>


  















  

  

  

</body>
</html>
